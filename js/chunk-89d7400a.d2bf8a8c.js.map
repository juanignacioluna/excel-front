{"version":3,"sources":["webpack:///./node_modules/jexcel/dist/jexcel.js","webpack:///./node_modules/core-js/internals/regexp-exec-abstract.js","webpack:///./src/views/Hoja.vue?0b1d","webpack:///src/views/Hoja.vue","webpack:///./src/views/Hoja.vue?7e2c","webpack:///./src/views/Hoja.vue","webpack:///./node_modules/core-js/modules/es.string.replace.js","webpack:///./src/views/Hoja.vue?2e78","webpack:///./src/components/Navbar.vue?050c","webpack:///./node_modules/core-js/internals/string-multibyte.js","webpack:///./node_modules/jsuites/dist/jsuites.js","webpack:///./node_modules/core-js/internals/advance-string-index.js","webpack:///./node_modules/core-js/internals/regexp-exec.js","webpack:///./node_modules/core-js/internals/regexp-sticky-helpers.js","webpack:///./node_modules/core-js/modules/es.regexp.exec.js","webpack:///./node_modules/core-js/internals/regexp-flags.js","webpack:///./src/components/Navbar.vue?5dfb","webpack:///src/components/Navbar.vue","webpack:///./src/components/Navbar.vue?1807","webpack:///./src/components/Navbar.vue","webpack:///./node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js"],"names":["jSuites","global","factory","module","exports","this","jexcel","el","options","obj","Element","HTMLDocument","console","error","tagName","createFromTable","div","document","createElement","parentNode","insertBefore","remove","defaults","url","data","copyCompatibility","root","rows","columns","colHeaders","colWidths","colAlignments","nestedHeaders","defaultColWidth","defaultColAlign","minSpareRows","minSpareCols","minDimensions","allowExport","includeHeadersOnDownload","includeHeadersOnCopy","columnSorting","columnDrag","columnResize","rowResize","rowDrag","editable","allowInsertRow","allowManualInsertRow","allowInsertColumn","allowManualInsertColumn","allowDeleteRow","allowDeletingAllRows","allowDeleteColumn","allowRenameColumn","allowComments","wordWrap","imageOptions","csv","csvFileName","csvHeaders","csvDelimiter","parseTableFirstRowAsHeader","parseTableAutoCellType","selectionCopy","mergeCells","toolbar","search","pagination","paginationOptions","fullscreen","lazyLoading","loadingSpin","tableOverflow","tableHeight","tableWidth","meta","style","parseFormulas","autoIncrement","autoCasting","secureFormulas","stripHTML","filters","footers","onundo","onredo","onload","onchange","onbeforechange","onafterchanges","onbeforeinsertrow","oninsertrow","onbeforeinsertcolumn","oninsertcolumn","onbeforedeleterow","ondeleterow","onbeforedeletecolumn","ondeletecolumn","onmoverow","onmovecolumn","onresizerow","onresizecolumn","onsort","onselection","oncopy","onpaste","onbeforepaste","onmerge","onfocus","onblur","onchangeheader","oneditionstart","oneditionend","onchangestyle","onchangemeta","onchangepage","onbeforesave","onsave","onevent","persistance","updateTable","detachForUpdates","freezeColumns","text","noRecordsFound","showingPage","show","entries","columnName","insertANewColumnBefore","insertANewColumnAfter","deleteSelectedColumns","renameThisColumn","orderAscending","orderDescending","insertANewRowBefore","insertANewRowAfter","deleteSelectedRows","editComments","addComments","comments","clearComments","copy","paste","saveAs","about","areYouSureToDeleteTheSelectedRows","areYouSureToDeleteTheSelectedColumns","thisActionWillDestroyAnyExistingMergedCellsAreYouSure","thisActionWillClearYourSearchResultsAreYouSure","thereIsAConflictWithAnotherMergedCell","invalidMergeProperties","cellAlreadyMerged","noCellsSelected","property","hasOwnProperty","textKey","corner","contextMenu","textarea","ads","content","table","thead","tbody","results","searchInput","pageNumber","headerContainer","colgroupContainer","headers","records","history","formula","colgroup","selection","highlighted","selectedCell","selectedContainer","filter","cursor","historyIndex","ignoreEvents","ignoreHistory","edition","hashString","resizing","dragging","activate","classList","add","dispatch","event","ret","apply","arguments","Array","prototype","slice","call","prepareJson","save","prepareTable","size","length","keys","Object","multiple","i","type","name","source","editor","allowEmpty","title","width","align","push","ajax","index","method","dataType","success","complete","createTable","format","onscroll","e","scrollControls","onwheel","wheelControls","searchContainer","searchText","createTextNode","appendChild","resetSelection","paginationUpdateContainer","paginationDropdown","parseInt","value","page","temp","innerHTML","tempCol","setAttribute","j","createNestedHeader","createCellHeader","td","className","display","id","tabIndex","contextmenu","onclick","close","sessionStorage","getItem","setItem","img","src","span","container","paginationInfo","paginationPages","createToolbar","maxHeight","setData","setStyle","refresh","loading","result","hide","JSON","parse","isArray","row","size_i","size_j","min_i","min_j","max_i","max_j","undefined","startNumber","finalNumber","tr","createRow","updatePagination","num","setMerge","getData","dataOnly","dataset","px","py","x","y","contains","getJson","k","newValue","log","stringify","getRowData","rowNumber","setRowData","getColumnNameFromId","setValue","getColumnData","columnNumber","setColumnData","colNumber","height","createCell","parseValue","substr","executeFormula","mask","decimal","run","val","secureFormula","innerText","element","checked","readOnly","formatted","calendar","extractDateFromString","getDateString","getDropDownValue","render","color","backgroundColor","stripScript","colAlign","textAlign","whiteSpace","overflow","colWidth","getColumnName","updateNestedHeader","children","nestedInformation","headerIndex","colspan","numberOfColumns","column","join","toolbarItem","v","tooltip","getAttribute","toolbarDropdownOption","open","o","cellName","rowspan","ignoreHistoryAndEvents","test","alert","x1","y1","x2","y2","cell","getIdFromColumnName","updateCell","updateSelection","setHistory","action","getMerge","removeMerge","keepOptions","removeAttribute","info","destroyMerged","isColMerged","cols","isRowMerged","openFilter","columnId","optionsFiltered","paddingLeft","paddingRight","dropdown","autocomplete","opened","position","onclose","resetFilters","getValue","getText","closeFilter","query","updateResult","openEditor","empty","createEditor","getBoundingClientRect","minHeight","split","closeEditor","focus","rect","rectContent","window","innerHeight","bottom","top","image","getCell","getCellFromCoords","getLabel","getLabelFromCoords","processedValue","getValueFromCoords","force","updateFormulaChain","setValueFromCoords","setCheckRadioValue","a","b","Option","c","getElementsByTagName","removeChild","record","col","oldValue","copyData","d","h","breakControl","posx","posy","tokens","match","affectedTokens","token","updateFormula","Number","date","Date","setDate","getDate","getFullYear","doubleDigitFormat","getMonth","refreshSelection","updateSelectionFromCoords","conditionalSelectionUpdate","blur","previousStatus","ux","uy","left","el1","el2","origin","previousState","borderLeft","borderRight","borderTop","borderBottom","removeCopyingSelection","updateCornerPosition","removeCopySelection","updateCopySelection","x3","y3","last","contentRect","lastRect","w2","h2","scrollLeft","scrollTop","getFreezeWidth","updateScroll","direction","w1","h1","reference","referenceRect","freezed","getWidth","$","setWidth","oldWidth","w","setHeight","oldHeight","getHeight","setFooter","tfoot","getHeader","setHeader","prompt","getHeaders","asArray","getMeta","key","setMeta","prop","updateMeta","affectedCells","newMeta","getStyle","resetStyle","applyStyle","cellId","currentValue","oneApplication","trim","getComments","withAuthor","setComments","author","getConfig","orderBy","order","confirm","p","sort","valueA","valueB","toLowerCase","updateOrderArrow","updateOrder","updateTableReferences","loadPage","moveRow","ignoreDom","resetSearch","indexOf","nextSibling","splice","insertRow","mixed","numOfRows","lastRow","rowIndex","currentRecords","currentData","currentRows","rowRecords","rowData","rowNode","deleteRow","number","getSelectedRows","mergeExists","moveColumn","insertColumn","properties","numOfColumns","lastColumn","columnIndex","injectArray","currentHeaders","currentColgroup","historyHeaders","historyColgroup","historyRecords","historyData","historyFooters","currentRecord","deleteColumn","getSelectedColumns","asIds","getHighlighted","mergeCellUpdates","updatePosition","columnIdFrom","columnIdTo","totalX","totalY","updateFormulas","numBlankRows","numBlankCols","setTimeout","showRow","hideRow","showColumn","hideColumn","showIndex","hideIndex","chainLoopProtection","referencesToUpdate","newFormula","letter","testLetter","testNumber","exec","inside","toUpperCase","expression","formulaResults","formulaLoopProtection","execute","parentId","tokensUpdate","f","e1","e2","replace","evalstring","eval","parseNumber","res","up","shiftKey","ctrlKey","visible","loadValidation","item","firstChild","loadUp","whichPage","group","get","down","lastChild","loadDown","right","first","selectAll","quantityPerPage","Math","ceil","startRow","finalRow","currentPage","selectedPage","totalPages","addToResult","total","oldPage","quantyOfPages","paginationItem","args","download","includeHeaders","blob","Blob","navigator","msSaveOrOpenBlob","pom","URL","createObjectURL","href","body","click","changes","delimiter","returnData","colLabel","rowLabel","tmp","strLabel","str","RegExp","label","select","execCommand","hash","parseCSV","newStyle","oldStyle","styleIndex","colIndex","copying","querySelectorAll","historyProcessRow","historyRecord","historyProcessColumn","undo","redo","combo","charCodeAt","arr","quote","cc","nc","chr","destroy","init","current","build","addEventListener","newData","shift","items","comment","shortcut","clipboard","readText","then","updateFreezePosition","target","timeControlLoading","clientHeight","scrollHeight","shifted","timeControl","destroyEventHandlers","removeEventListener","mouseUpControls","mouseDownControls","mouseMoveControls","mouseOverControls","doubleClickControls","pasteControls","contextMenuControls","touchStartControls","touchEndControls","keyDownControls","which","preventDefault","altKey","editorTextarea","editorValue","editorIndexOf","selectionStart","selectionEnd","selectedRow","selectedHeader","metaKey","rowId","keyCode","String","fromCharCode","validLetter","cutControls","copyControls","clearTimeout","isMouseAction","buttons","mouseButton","button","jexcelTable","getElement","selectedCorner","offsetX","mousePosition","pageX","offsetY","destination","c1","c2","pageY","clientWidth","getCellCoords","newWidth","currentWidth","newHeight","previousSibling","tempWidth","tempHeight","clientX","clientY","enabled","clipboardData","tmpElement","tabs","spreadsheet","link","worksheet","sheetName","createTabs","fromSpreadsheet","file","__callback","oReq","convert","workbook","spreadsheets","SheetNames","forEach","Sheets","wpx","hpx","s","r","max_x","max_y","fgColor","rgb","numColumns","XMLHttpRequest","Uint8Array","responseType","arraybuffer","response","wb","XLSX","read","cellFormula","cellStyles","setRequestHeader","onreadystatechange","readyState","status","ff","convertResponseBodyToText","responseBody","send","regex","idx","concat","t","code","pow","jexcelSection","jexcelElement","path","parseHeader","header","mergedColspan","mergedRowspan","pattern","testCalendar","fn","spreadsheetContainer","jQuery","nil","Error","div0","ref","na","utils","array","reduce","aIsArray","bIsArray","argsToArray","isFlat","flattenShallow","arrayEach","possibleNumbers","flatten","power","round","bool","isNaN","string","parseFloat","len","parsed","matrix","pnarr","parseNumberArray","d1900","UTC","parseDate","getTime","parseDateArray","anyIsError","n","arrayValuesToNumbers","rest","initial","iteratee","transpose","map","methods","datetime","WEEK_TYPES","serial","addOn","DATE","year","month","day","DATEVALUE","date_text","DAY","serial_number","DAYS","end_date","start_date","DAYS360","EDATE","months","setMonth","EOMONTH","HOUR","getHours","INTERVAL","second","floor","hour","min","sec","ISOWEEKNUM","setHours","getDay","yearStart","MINUTE","getMinutes","MONTH","NETWORKDAYS","holidays","INTL","weekend","NOW","SECOND","getSeconds","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","WORKDAY","days","YEAR","YEARFRAC","basis","database","compact","findResultIndex","criterias","matches","maxCriteriaLength","l","currentCriteriaResult","hasMatchingCriteria","criteria","criteriaField","FINDFIELD","DAVERAGE","field","resultIndexes","targetFields","sum","DCOUNT","DCOUNTA","DGET","DMAX","maxValue","DMIN","minValue","DPRODUCT","targetValues","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","MATCH","lookupValue","lookupArray","matchType","indexValue","engineering","isValidBinaryNumber","BESSELI","BESSELJ","BESSELK","BESSELY","BIN2DEC","stringified","toString","substring","BIN2HEX","places","REPT","BIN2OCT","BITAND","number1","number2","BITLSHIFT","abs","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki","unit_prefixes","Y","Z","E","P","T","G","M","m","u","z","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","ERF","lower_bound","upper_bound","PRECISE","ERFC","GESTEP","step","HEX2BIN","negative","HEX2DEC","HEX2OCT","IMABS","inumber","IMREAL","IMAGINARY","sqrt","plus","minus","unit","IMARGUMENT","PI","atan","IMCONJUGATE","IMCOS","cos","exp","sin","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","den","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","financial","validDate","ensureDate","ACCRINT","issue","settlement","rate","par","frequency","ACCRINTM","AMORDEGRC","AMORLINC","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","CUMIPMT","periods","start","end","payment","PMT","interest","FV","CUMPRINC","principal","DB","cost","salvage","life","period","toFixed","ceiling","DDB","factor","DISC","DOLLARDE","dollar","fraction","LN10","LN2","DOLLARFR","DURATION","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","IPMT","present","IRR","values","guess","irrResult","dates","irrResultDeriv","frac","positive","newRate","epsRate","resultValue","resultRate","epsMax","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","PRICEDISC","PRICEMAT","PV","RATE","iterMax","iter","t1","t2","f1","f2","f3","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","maturity","discount","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","information","ERROR","TYPE","error_val","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISODD","ISREF","ISTEXT","N","NA","SHEET","SHEETS","logical","then_value","otherwise_value","valueIfError","value_if_na","targetValue","argc","switchCount","switchSatisfied","defaultClause","math","acos","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","asin","number_x","number_y","atan2","radix","min_length","max","significance","mode","CEILING","MATH","COMBIN","number_chosen","FACT","COMBINA","COS","COSH","COT","tan","COTH","CSC","CSCH","DECIMAL","DEGREES","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","GCD","INT","LCM","pop","LN","LOG","base","LOG10","MDETERM","MINVERSE","MMULT","MOD","dividend","divisor","modulus","MROUND","MULTINOMIAL","MUNIT","ODD","POWER","PRODUCT","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","ROMAN","ROUND","digits","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","SUM","argsKeys","elt","SUMIF","range","SUMIFS","n_range_elements","n_criterias","condition","SUMPRODUCT","SUMSQ","numbers","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","misc","hasElement","FLATTEN","ARGS2ARRAY","REFERENCE","context","opening","JOIN","separator","NUMBERS","NUMERAL","re","trueFound","falseFound","text1","text2","find_text","within_text","line","begin","txt","charAt","regular_expression","full","replacement","new_text","foundAt","old_text","occurrence","UNICHAR","CHAR","UNICODE","CODE","UPPER","VALUE","stats","SQRT2PI","AVEDEV","AVERAGE","count","AVERAGEA","AVERAGEIF","average_range","average_count","AVERAGEIFS","COUNT","COUNTA","COUNTBLANK","COUNTIN","blanks","COUNTIF","COUNTIFS","COUNTUNIQUE","UNIQUE","FISHER","FISHERINV","e2y","FREQUENCY","bins","LARGE","MAX","MAXA","MIN","MINA","MODE","MULT","currentItem","maxItems","SNGL","PERCENTILE","EXC","fl","cleanFloat","INC","PERCENTRANK","uniques","PERMUT","PERMUTATIONA","PHI","PROB","probability","lower","upper","sorted","QUARTILE","quart","RANK","AVG","RSQ","data_x","data_y","PEARSON","SMALL","STANDARDIZE","mean","sd","STDEV","VAR","S","STDEVA","VARA","STDEVPA","VARPA","sigma","WEIBULL","DIST","alpha","beta","cumulative","TEST","NORM","html","classof","regexpExec","R","TypeError","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","hoja","titulo","on","actualizar","eliminar","mas","menos","attrs","staticRenderFns","columnsExcel","filas","components","Navbar","mounted","fetch","Headers","filaNula","excel","getElementById","component","fixRegExpWellKnownSymbolLogic","anObject","toObject","toLength","toInteger","requireObjectCoercible","advanceStringIndex","regExpExec","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","maybeToString","it","REPLACE","nativeReplace","maybeCallNative","reason","REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","REPLACE_KEEPS_$0","UNSAFE_SUBSTITUTE","searchValue","replaceValue","O","replacer","regexp","done","rx","functionalReplace","fullUnicode","unicode","lastIndex","matchStr","accumulatedResult","nextSourcePosition","matched","captures","namedCaptures","groups","replacerArgs","getSubstitution","tailPos","symbols","ch","capture","createMethod","CONVERT_TO_STRING","$this","pos","codeAt","app","querySelector","modules","guid","documentElement","g","innerWidth","changedTouches","evt","MouseEvent","bubbles","cancelable","view","dispatchEvent","foundElement","targetElement","formObject","elements","http","files","extension","lastIndexOf","cover","encodeURIComponent","httpRequest","cache","withCredentials","beforeSend","responseText","err","requests","slideLeft","slideRight","slideTop","slideBottom","fadeIn","fadeOut","nodes","slider","dialog","onconfirm","actionUpControl","getLinkElement","back","panel","pages","controlSwipeLeft","scrollTo","behavior","prev","controlSwipeRight","next","actionOverControl","actionOutControl","onpopstate","state","route","validRange","startingDay","readonly","today","time","resetButton","placeholder","weekdays","weekdays_short","two","calendarReset","calendarConfirm","calendarControls","calendarContainer","calendarContent","calendarTableContainer","calendarHeaderPrev","calendarLabelYear","calendarLabelMonth","calendarHeaderTitle","calendarHeaderNext","calendarHeaderRow","calendarHeader","calendarBody","calendarFooter","calendarTable","calendarSelectHour","calendarSelectMin","calendarControlsFooter","calendarControlsTime","maxWidth","calendarControlsUpdateButton","calendarControlsUpdate","flexGrow","calendarBackdrop","updateActions","currentDay","getDays","getWindowWidth","update","getYears","setLabel","reset","isCurrentMonthAndYear","numberOfDays","firstDay","emptyRow","fontWeight","now","test1","test2","getMonths","fromFormatted","stopPropagation","keyUpControls","prettify","texts","justNow","xMinutesAgo","xHoursAgo","xDaysAgo","xWeeksAgo","xMonthsAgo","xYearsAgo","d1","d2","prettifyAll","dateOnly","v1","v2","weekday","isOpen","closeOnChange","palette","colors","shade","backdrop","closeButton","selected","create","itemContainer","itemText","disabled","itemShortCut","foundId","dialogHeader","dialogTitle","dialogMessage","dialogFooter","dialogContainer","dialogConfirm","dialogConfirmButton","confirmLabel","dialogCancel","dialogCancelButton","cancelLabel","oncancel","message","opacity","extractFromDom","onopen","minWidth","containerHeader","keyTimer","find","getUrl","setUrl","createItem","textLowerCase","node","groupNames","groupName","groupArrow","groupContent","updateLabel","selectIndex","oldLabel","currentIndex","indexToRemove","resetSelected","newLabel","selectItem","updateCursor","rectContainer","resetCursor","offsetTop","clientTop","firstVisible","newIndex","hasEvents","mouseup","onkeydown","offsetWidth","snippet","remoteParser","youtubeKey","userSearch","parseURL","dropZone","dropAsAttachment","acceptImages","acceptFiles","maxFileSize","border","padding","onenter","onkeyup","editorTimer","editorAction","overflowY","extractImageFromHtml","addImage","insertNodeAtCaret","newNode","sel","getSelection","rangeCount","getRangeAt","deleteContents","insertNode","setStartAfter","setEndAfter","removeAllRanges","addRange","appendElement","description","host","verifyEditor","thumbsContainer","detectUrl","getDomain","location","hostname","importImage","youtubeParser","getYoutube","getWebsite","parseContent","thumbnails","medium","encodeURI","json","tagged","users","userId","addPdf","canvas","Image","ctx","getContext","drawImage","toBlob","newImage","toDataURL","addFile","reader","FileReader","lastModified","readAsDataURL","editorMouseUp","editorMouseDown","editorMouseMove","editorKeyUp","editorKeyDown","editorDragStart","editorDragEnter","editorDragOver","editorDrop","editorPaste","editorBlur","editorFocus","removeRange","originalEvent","nodeName","caretRangeFromPoint","rangeParent","createRange","setStart","rangeOffset","anchorNode","dataTransfer","getDefaultToolbar","icon","userSelect","itemIcon","setCursor","startContainer","endContainer","setEnd","links","regExp","queryCommandState","singleFile","extensionNotAllowed","imageTooSmall","lastmodified","small","addImages","addFromFile","imageFile","srcElement","extentionNotAllowed","addFromUrl","attachmentInput","login","prepareRequest","accessToken","deviceToken","facebookUrl","facebookAuthentication","onsuccess","onerror","logo","newProfile","newProfileUrl","newProfileLogin","newPasswordValidation","messageElement","divLogo","labelCode","inputCode","divCode","inputHash","divHash","inputRecovery","divRecovery","labelLogin","inputLogin","divLogin","labelName","inputName","divName","labelUsername","inputUsername","divUsername","labelPassword","inputPassword","divPassword","labelRepeatPassword","inputRepeatPassword","divRepeatPassword","labelRemember","inputRemember","divRememberButton","actionButton","divActionButton","cancelButton","requestAccess","divCancelButton","labelCaptcha","inputCaptcha","imageCaptcha","divCaptcha","facebookButton","divFacebookButton","requestLoginViaFacebook","inputRequest","divRequestButton","requestNewPassword","inputNewProfile","divNewProfileButton","showMessage","captcha","codeConfirmation","changeMyPassword","localStorage","FB","getLoginStatus","authResponse","scope","jDestroy","fbLogin","jStart","jError","jExit","getFormElements","password","sha512","queryString","int64","msint_32","lsint_32","highOrder","lowOrder","T1","T2","H","K","W","charsize","utf8_encode","unescape","str2binb","bin","binb2hex","binarray","srcByte","hex_tab","safe_add_2","lsw","msw","safe_add_4","safe_add_5","maj","rotr","sigma0","rotr28","rotr34","rotr39","sigma1","rotr14","rotr18","rotr41","gamma0","rotr1","rotr8","shr7","shr","gamma1","rotr19","rotr61","shr6","strlen","pieces","valueDecimal","prepare","process","fromKeyCode","input","reverse","_to_ascii","shiftUps","mobile","createPage","callback","onpush","script","setTitle","closed","showPage","onleave","pushState","routePath","getContainer","toolbarContent","setBadge","toolbarIcon","toolbarBadge","toolbarBadgeContent","badge","toolbarTitle","actionsheet","actionContent","actionGroup","actionItem","actionInput","mouseUp","modal","resetPosition","notification","timeout","autoHide","closeable","notificationContainer","notificationHeader","notificationImage","notificationIcon","notificationName","notificationClose","notificationDate","notificationContent","notificationTitle","notificationMessage","rating","currentImage","addFiles","getFiles","allowAttachment","attachmentIcon","longTouchTimer","mouseDown","sorting","allowCreate","oncreate","animation","autoName","prefixName","hideHeaders","setBorder","headersItem","contentItem","tags","limit","limitMessage","validation","searchTerms","searchIndex","searchTimer","getSelectionStart","caret","extractTags","isValid","terms","nodeValue","tagsMouseUp","tagsKeyDown","tagsKeyUp","tagsPaste","tagsFocus","tagsBlur","collapse","nodeType","word","anchorOffset","tracker","ignore","currentHash","submitButton","load","validate","getElements","validateElement","emailChecker","addError","delError","getError","setHash","getHash","isChanged","resetTracker","setIgnore","ignoreFlag","confirmationMessage","returnValue","regexpFlags","stickyHelpers","nativeExec","patchedExec","UPDATES_LAST_INDEX_WRONG","re1","re2","UNSUPPORTED_Y","BROKEN_CARET","NPCG_INCLUDED","PATCH","reCopy","sticky","flags","charsAdded","strCopy","multiline","fails","RE","proto","forced","that","ignoreCase","dotAll","redefine","wellKnownSymbol","createNonEnumerableProperty","SPECIES","REPLACE_SUPPORTS_NAMED_GROUPS","SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","KEY","sham","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","constructor","nativeRegExpMethod","nativeMethod","arg2","forceStringMethod","stringMethod","regexMethod","arg"],"mappings":"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AAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,UAAY,WACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,WAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,WACzD,IAAIA,EAAM,WAAY,YAAa,IAAIA,EAAM,WAAY,YACzD,IAAIA,EAAM,UAAY,YAAa,IAAIA,EAAM,UAAY,YACzD,IAAIA,EAAM,UAAY,YA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","file":"js/chunk-89d7400a.d2bf8a8c.js","sourcesContent":["/**\r\n * jExcel v4.2.0\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jexcel/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distribute under MIT License\r\n */\r\n\r\n if (! jSuites && typeof(require) === 'function') {\r\n    var jSuites = require('jsuites');\r\n    require('jsuites/dist/jsuites.css');\r\n}\r\n\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jexcel = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\n    // Jexcel core object\n\n    var jexcel = (function(el, options) {\n        // Create jexcel object\n        var obj = {};\n        obj.options = {};\n\r\n        if (! (el instanceof Element || el instanceof HTMLDocument)) {\r\n            console.error('JEXCEL: el is not a valid DOM element');\r\n            return false;\r\n        } else if (el.tagName == 'TABLE') {\r\n            if (options = jexcel.createFromTable(el, options)) {\r\n                var div = document.createElement('div');\r\n                el.parentNode.insertBefore(div, el);\r\n                el.remove();\r\n                el = div;\r\n            } else {\r\n                console.error('JEXCEL: el is not a valid DOM element');\r\n                return false;\r\n            }\r\n        }\r\n\n        // Loading default configuration\n        var defaults = {\n            // External data\n            url:null,\n            // Data\n            data:null,\n            // Copy behavior\n            copyCompatibility:false,\n            root:null,\n            // Rows and columns definitions\n            rows:[],\n            columns:[],\n            // Deprected legacy options\n            colHeaders:[],\n            colWidths:[],\n            colAlignments:[],\n            nestedHeaders:null,\n            // Column width that is used by default\n            defaultColWidth:50,\n            defaultColAlign:'center',\n            // Spare rows and columns\n            minSpareRows:0,\n            minSpareCols:0,\n            // Minimal table dimensions\n            minDimensions:[0,0],\n            // Allow Export\n            allowExport:true,\r\n            // @type {boolean} - Include the header titles on download\r\n            includeHeadersOnDownload:false,\r\n            // @type {boolean} - Include the header titles on copy\r\n            includeHeadersOnCopy:false,\n            // Allow column sorting\n            columnSorting:true,\n            // Allow column dragging\n            columnDrag:false,\n            // Allow column resizing\n            columnResize:true,\n            // Allow row resizing\n            rowResize:false,\n            // Allow row dragging\n            rowDrag:true,\n            // Allow table edition\n            editable:true,\n            // Allow new rows\n            allowInsertRow:true,\n            // Allow new rows\n            allowManualInsertRow:true,\n            // Allow new columns\n            allowInsertColumn:true,\n            // Allow new rows\n            allowManualInsertColumn:true,\n            // Allow row delete\n            allowDeleteRow:true,\n            // Allow deleting of all rows\n            allowDeletingAllRows:false,\n            // Allow column delete\n            allowDeleteColumn:true,\n            // Allow rename column\n            allowRenameColumn:true,\n            // Allow comments\n            allowComments:false,\n            // Global wrap\n            wordWrap:false,\n            // Image options\n            imageOptions: null,\n            // CSV source\n            csv:null,\n            // Filename\n            csvFileName:'jexcel',\n            // Consider first line as header\n            csvHeaders:true,\r\n            // Delimiters\n            csvDelimiter:',',\r\n            // First row as header\r\n            parseTableFirstRowAsHeader:false,\r\n            parseTableAutoCellType:false,\n            // Disable corner selection\n            selectionCopy:true,\n            // Merged cells\n            mergeCells:{},\n            // Create toolbar\n            toolbar:null,\n            // Allow search\n            search:false,\n            // Create pagination\n            pagination:false,\n            paginationOptions:null,\r\n            // Full screen\n            fullscreen:false,\n            // Lazy loading\n            lazyLoading:false,\n            loadingSpin:false,\n            // Table overflow\n            tableOverflow:false,\n            tableHeight:'300px',\n            tableWidth:null,\n            // Meta\n            meta: null,\n            // Style\n            style:null,\n            // Execute formulas\n            parseFormulas:true,\n            autoIncrement:true,\n            autoCasting:true,\r\n            // Security\r\n            secureFormulas:true,\r\n            stripHTML:true,\r\n            // Filters\r\n            filters:false,\r\n            footers:null,\r\n            // Event handles\n            onundo:null,\n            onredo:null,\n            onload:null,\n            onchange:null,\n            onbeforechange:null,\n            onafterchanges:null,\n            onbeforeinsertrow: null,\n            oninsertrow:null,\n            onbeforeinsertcolumn: null,\n            oninsertcolumn:null,\n            onbeforedeleterow:null,\n            ondeleterow:null,\n            onbeforedeletecolumn:null,\n            ondeletecolumn:null,\n            onmoverow:null,\n            onmovecolumn:null,\n            onresizerow:null,\n            onresizecolumn:null,\n            onsort:null,\n            onselection:null,\n            oncopy:null,\n            onpaste:null,\n            onbeforepaste:null,\n            onmerge:null,\n            onfocus:null,\n            onblur:null,\n            onchangeheader:null,\n            oneditionstart:null,\n            oneditionend:null,\n            onchangestyle:null,\n            onchangemeta:null,\r\n            onchangepage:null,\r\n            onbeforesave:null,\r\n            onsave:null,\r\n            // Global event dispatcher\r\n            onevent:null,\r\n            // Persistance\r\n            persistance:false,\n            // Customize any cell behavior\n            updateTable:null,\n            // Detach the HTML table when calling updateTable\r\n            detachForUpdates: false,\r\n            freezeColumns:null,\n            // Texts\n            text:{\n                noRecordsFound: 'No records found',\n                showingPage: 'Showing page {0} of {1} entries',\n                show: 'Show ',\n                search: 'Search',\n                entries: ' entries',\n                columnName: 'Column name',\n                insertANewColumnBefore: 'Insert a new column before',\n                insertANewColumnAfter: 'Insert a new column after',\n                deleteSelectedColumns: 'Delete selected columns',\n                renameThisColumn: 'Rename this column',\n                orderAscending: 'Order ascending',\n                orderDescending: 'Order descending',\n                insertANewRowBefore: 'Insert a new row before',\n                insertANewRowAfter: 'Insert a new row after',\n                deleteSelectedRows: 'Delete selected rows',\n                editComments: 'Edit comments',\n                addComments: 'Add comments',\n                comments: 'Comments',\n                clearComments: 'Clear comments',\n                copy: 'Copy...',\n                paste: 'Paste...',\n                saveAs: 'Save as...',\n                about: 'About',\n                areYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\n                areYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\n                thisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\n                thisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\n                thereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\n                invalidMergeProperties: 'Invalid merged properties',\n                cellAlreadyMerged: 'Cell already merged',\n                noCellsSelected: 'No cells selected',\n            },\n            // About message\n            about:\"jExcel CE Spreadsheet\\nVersion 4.2.0\\nAuthor: Paul Hodel <paul.hodel@gmail.com>\\nWebsite: https://bossanova.uk/jexcel/v3\",\n        };\n    \n        // Loading initial configuration from user\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                if (property === 'text') {\r\n                    obj.options[property] = defaults[property];\r\n                    for (var textKey in options[property]) {\r\n                        if (options[property].hasOwnProperty(textKey)){\r\n                            obj.options[property][textKey] = options[property][textKey];\r\n                        }\r\n                    }\r\n                } else {\r\n                    obj.options[property] = options[property];\r\n                }\n            } else {\n                obj.options[property] = defaults[property];\n            }\n        }\n\n        // Global elements\n        obj.el = el;\n        obj.corner = null;\n        obj.contextMenu = null;\n        obj.textarea = null;\n        obj.ads = null;\n        obj.content = null;\n        obj.table = null;\n        obj.thead = null;\n        obj.tbody = null;\n        obj.rows = [];\n        obj.results = null;\n        obj.searchInput = null;\n        obj.toolbar = null;\n        obj.pagination = null;\n        obj.pageNumber = null;\n        obj.headerContainer = null;\n        obj.colgroupContainer = null;\n    \n        // Containers\n        obj.headers = [];\n        obj.records = [];\n        obj.history = [];\n        obj.formula = [];\n        obj.colgroup = [];\n        obj.selection = [];\n        obj.highlighted  = [];\n        obj.selectedCell = null;\n        obj.selectedContainer = null;\n        obj.style = [];\n        obj.data = null;\r\n        obj.filter = null;\n        obj.filters = [];\r\n\n        // Internal controllers\n        obj.cursor = null;\n        obj.historyIndex = -1;\n        obj.ignoreEvents = false;\n        obj.ignoreHistory = false;\n        obj.edition = null;\n        obj.hashString = null;\n        obj.resizing = null;\n        obj.dragging = null;\n    \n        // Lazy loading\n        if (obj.options.lazyLoading == true && (obj.options.tableOverflow == false && obj.options.fullscreen == false)) {\n            console.error('JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\n            obj.options.lazyLoading = false;\n        }\n        \n        /**\n         * Activate/Disable fullscreen \n         * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\n         * @Param {boolean} activate\n         */\n        obj.fullscreen = function(activate) {\n            // If activate not defined, get reverse options.fullscreen\n            if (activate == null) {\n                activate = ! obj.options.fullscreen;\n            }\n    \n            // If change\n            if (obj.options.fullscreen != activate) {\n                obj.options.fullscreen = activate;\n    \n                // Test LazyLoading conflict\n                if (activate == true) {\n                    el.classList.add('fullscreen');\n                } else {\n                    el.classList.remove('fullscreen');\n                }\n            } \n        }\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        obj.dispatch = function(event) {\r\n            // Dispatch events\r\n            if (! obj.ignoreEvents) {\r\n                // Call global event\r\n                if (typeof(obj.options.onevent) == 'function') {\r\n                    var ret = obj.options.onevent.apply(this, arguments);\r\n                }\r\n                // Call specific events\r\n                if (typeof(obj.options[event]) == 'function') {\r\n                    var ret = obj.options[event].apply(this, Array.prototype.slice.call(arguments, 1));\r\n                }\r\n            }\r\n\r\n            // Persistance\r\n            if (event == 'onafterchanges' && obj.options.persistance) {\r\n                var url = obj.options.persistance == true ? obj.options.url : obj.options.persistance;\r\n                var data = obj.prepareJson(arguments[2]);\r\n                obj.save(url, data);\r\n            }\r\n\r\n            return ret;\r\n        }\r\n\n        /**\n         * Prepare the jexcel table\n         * \n         * @Param config\n         */\n        obj.prepareTable = function() {\n            // Loading initial data from remote sources\n            var results = [];\n    \n            // Number of columns\n            var size = obj.options.columns.length;\n    \n            if (obj.options.data && typeof(obj.options.data[0]) !== 'undefined') {\n                // Data keys\n                var keys = Object.keys(obj.options.data[0]);\n    \n                if (keys.length > size) {\n                    size = keys.length;\n                }\n            }\n    \n            // Minimal dimensions\n            if (obj.options.minDimensions[0] > size) {\n                size = obj.options.minDimensions[0];\n            }\n    \n            // Requests\n            var multiple = [];\n    \n            // Preparations\n            for (var i = 0; i < size; i++) {\n                // Deprected options. You should use only columns\n                if (! obj.options.colHeaders[i]) {\n                    obj.options.colHeaders[i] = '';\n                }\n                if (! obj.options.colWidths[i]) {\n                    obj.options.colWidths[i] = obj.options.defaultColWidth;\n                }\n                if (! obj.options.colAlignments[i]) {\n                    obj.options.colAlignments[i] = obj.options.defaultColAlign;\n                }\n    \n                // Default column description\n                if (! obj.options.columns[i]) {\n                    obj.options.columns[i] = { type:'text' };\n                } else if (! obj.options.columns[i].type) {\n                    obj.options.columns[i].type = 'text';\n                }\n                if (! obj.options.columns[i].name) {\n                    obj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\n                }\n                if (! obj.options.columns[i].source) {\n                    obj.options.columns[i].source = [];\n                }\n                if (! obj.options.columns[i].options) {\n                    obj.options.columns[i].options = [];\n                }\n                if (! obj.options.columns[i].editor) {\n                    obj.options.columns[i].editor = null;\n                }\n                if (! obj.options.columns[i].allowEmpty) {\n                    obj.options.columns[i].allowEmpty = false;\n                }\n                if (! obj.options.columns[i].title) {\n                    obj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\n                }\n                if (! obj.options.columns[i].width) {\n                    obj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\n                }\n                if (! obj.options.columns[i].align) {\n                    obj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\n                }\n    \n                // Pre-load initial source for json autocomplete\n                if (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\n                    // if remote content\n                    if (obj.options.columns[i].url) {\n                        multiple.push(jSuites.ajax({\n                            url: obj.options.columns[i].url,\n                            index: i,\n                            method: 'GET',\n                            dataType: 'json',\n                            multiple: multiple,\n                            success: function(data) {\n                                var source = [];\n                                for (var i = 0; i < data.length; i++) {\n                                    obj.options.columns[this.index].source.push(data[i]);\n                                }\n                            },\n                            complete: function() {\n                                obj.createTable();\n                            }\n                        }));\n                    }\n                } else if (obj.options.columns[i].type == 'calendar') {\n                    // Default format for date columns\n                    if (! obj.options.columns[i].options.format) {\n                        obj.options.columns[i].options.format = 'DD/MM/YYYY';\n                    }\n                }\n            }\n    \n            // On complete\n            if (! multiple.length) {\n                obj.createTable();\n            }\n        }\n    \n        obj.createTable = function() {\n            // Elements\n            obj.table = document.createElement('table');\n            obj.thead = document.createElement('thead');\n            obj.tbody = document.createElement('tbody');\n\n            // Create headers controllers\n            obj.headers = [];\n            obj.colgroup = [];\n    \n            // Create table container\n            obj.content = document.createElement('div');\n            obj.content.classList.add('jexcel_content');\n            obj.content.onscroll = function(e) {\r\n                obj.scrollControls(e);\r\n            }\r\n            obj.content.onwheel = function(e) {\r\n                obj.wheelControls(e);\r\n            }\r\n\n            // Create toolbar object\n            obj.toolbar = document.createElement('div');\n            obj.toolbar.classList.add('jexcel_toolbar');\n    \n            // Search\n            var searchContainer = document.createElement('div');\n            var searchText = document.createTextNode((obj.options.text.search) + ': ');\n            obj.searchInput = document.createElement('input');\n            obj.searchInput.classList.add('jexcel_search');\n            searchContainer.appendChild(searchText);\n            searchContainer.appendChild(obj.searchInput);\n            obj.searchInput.onfocus = function() {\n                obj.resetSelection();\n            }\n    \n            // Pagination select option\n            var paginationUpdateContainer = document.createElement('div');\n    \n            if (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\n                obj.paginationDropdown = document.createElement('select');\n                obj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\n                obj.paginationDropdown.onchange = function() {\n                    obj.options.pagination = parseInt(this.value);\n                    obj.page(0);\n                }\n    \n                for (var i = 0; i < obj.options.paginationOptions.length; i++) {\n                    var temp = document.createElement('option');\n                    temp.value = obj.options.paginationOptions[i];\n                    temp.innerHTML = obj.options.paginationOptions[i];\n                    obj.paginationDropdown.appendChild(temp);\n                }\n    \n                paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\n                paginationUpdateContainer.appendChild(obj.paginationDropdown);\n                paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\n            }\n    \n            // Filter and pagination container\n            var filter = document.createElement('div');\n            filter.classList.add('jexcel_filter');\n            filter.appendChild(paginationUpdateContainer);\n            filter.appendChild(searchContainer);\n    \n            // Colsgroup\n            obj.colgroupContainer = document.createElement('colgroup');\n            var tempCol = document.createElement('col');\n            tempCol.setAttribute('width', '50');\n            obj.colgroupContainer.appendChild(tempCol);\n    \n            // Nested\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                // Flexible way to handle nestedheaders\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                        obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\n                    }\n                } else {\n                    obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\n                }\n            }\n    \n            // Row\n            obj.headerContainer = document.createElement('tr');\n            var tempCol = document.createElement('td');\n            tempCol.classList.add('jexcel_selectall');\n            obj.headerContainer.appendChild(tempCol);\n    \n            for (var i = 0; i < obj.options.columns.length; i++) {\n                // Create header\n                obj.createCellHeader(i);\n                // Append cell to the container\n                obj.headerContainer.appendChild(obj.headers[i]);\n                obj.colgroupContainer.appendChild(obj.colgroup[i]);\n            }\r\n\n            obj.thead.appendChild(obj.headerContainer);\r\n\r\n            // Filters\n            if (obj.options.filters == true) {\r\n                obj.filter = document.createElement('tr');\r\n                var td = document.createElement('td');\r\n                obj.filter.appendChild(td);\r\n\r\n                for (var i = 0; i < obj.options.columns.length; i++) {\r\n                    var td = document.createElement('td');\r\n                    td.innerHTML = '&nbsp;';\r\n                    td.setAttribute('data-x', i);\r\n                    td.className = 'jexcel_column_filter';\r\n                    obj.filter.appendChild(td);\r\n                }\r\n\r\n                obj.thead.appendChild(obj.filter);\r\n            }\n\n            // Content table\n            obj.table = document.createElement('table');\n            obj.table.classList.add('jexcel');\n            obj.table.setAttribute('cellpadding', '0');\n            obj.table.setAttribute('cellspacing', '0');\n            obj.table.setAttribute('unselectable', 'yes');\n            //obj.table.setAttribute('onselectstart', 'return false');\n            obj.table.appendChild(obj.colgroupContainer);\n            obj.table.appendChild(obj.thead);\n            obj.table.appendChild(obj.tbody);\r\n\n            // Spreadsheet corner\n            obj.corner = document.createElement('div');\n            obj.corner.className = 'jexcel_corner';\n            obj.corner.setAttribute('unselectable', 'on');\n            obj.corner.setAttribute('onselectstart', 'return false');\n    \n            if (obj.options.selectionCopy == false) {\n                obj.corner.style.display = 'none';\n            }\n    \n            // Textarea helper\n            obj.textarea = document.createElement('textarea');\n            obj.textarea.className = 'jexcel_textarea';\n            obj.textarea.id = 'jexcel_textarea';\n            obj.textarea.tabIndex = '-1';\r\n\n            // Contextmenu container\n            obj.contextMenu = document.createElement('div');\n            obj.contextMenu.className = 'jexcel_contextmenu';\n    \n            // Create element\n            jSuites.contextmenu(obj.contextMenu, {\n                onclick:function() {\n                    obj.contextMenu.contextmenu.close(false);\n                }\n            });\n    \n            // Powered by jExcel\r\n            var ads = document.createElement('a');\r\n            ads.setAttribute('href', 'https://bossanova.uk/jexcel/');\r\n            obj.ads = document.createElement('div');\r\n            obj.ads.className = 'jexcel_about';\r\n            if (typeof(sessionStorage) !== \"undefined\" && ! sessionStorage.getItem('jexcel')) {\r\n                sessionStorage.setItem('jexcel', true);\r\n                var img = document.createElement('img');\r\n                img.src = '//bossanova.uk/jexcel/logo.png';\r\n                ads.appendChild(img);\r\n            }\r\n            var span = document.createElement('span');\r\n            span.innerHTML = 'Jexcel spreadsheet';\r\n            ads.appendChild(span);\r\n            obj.ads.appendChild(ads);\r\n\n            // Create table container TODO: frozen columns\n            var container = document.createElement('div');\n            container.classList.add('jexcel_table');\n    \n            // Pagination\n            obj.pagination = document.createElement('div');\n            obj.pagination.classList.add('jexcel_pagination');\n            var paginationInfo = document.createElement('div');\n            var paginationPages = document.createElement('div');\n            obj.pagination.appendChild(paginationInfo);\n            obj.pagination.appendChild(paginationPages);\n\r\n            // Hide pagination if not in use\r\n            if (! obj.options.pagination) {\r\n                obj.pagination.style.display = 'none';\r\n            }\r\n\n            // Append containers to the table\n            if (obj.options.search == true) {\n                el.appendChild(filter);\n            }\n    \n            // Elements\n            obj.content.appendChild(obj.table);\n            obj.content.appendChild(obj.corner);\n            obj.content.appendChild(obj.textarea);\n    \n            el.appendChild(obj.toolbar);\n            el.appendChild(obj.content);\n            el.appendChild(obj.pagination);\n            el.appendChild(obj.contextMenu);\n            el.appendChild(obj.ads);\n            el.classList.add('jexcel_container');\n    \n            // Create toolbar\n            if (obj.options.toolbar && obj.options.toolbar.length) {\n                obj.createToolbar();\n            }\n    \n            // Fullscreen\n            if (obj.options.fullscreen == true) {\n                el.classList.add('fullscreen');\n            } else {\n                // Overflow\n                if (obj.options.tableOverflow == true) {\n                    if (obj.options.tableHeight) {\n                        obj.content.style['overflow-y'] = 'auto';\n                        obj.content.style.maxHeight = obj.options.tableHeight;\n                    }\n                    if (obj.options.tableWidth) {\n                        obj.content.style['overflow-x'] = 'auto';\n                        obj.content.style.width = obj.options.tableWidth;\n                    }\n                }\n            }\n    \n            // With toolbars\n            if (obj.options.tableOverflow != true && obj.options.toolbar) {\n                el.classList.add('with-toolbar');\n            }\n    \n            // Actions\n            if (obj.options.columnDrag == true) {\n                obj.thead.classList.add('draggable');\n            }\n            if (obj.options.columnResize == true) {\n                obj.thead.classList.add('resizable');\n            }\n            if (obj.options.rowDrag == true) {\n                obj.tbody.classList.add('draggable');\n            }\n            if (obj.options.rowResize == true) {\n                obj.tbody.classList.add('resizable');\n            }\n    \n            // Load data\n            obj.setData();\n    \n            // Style\n            if (obj.options.style) {\n                obj.setStyle(obj.options.style, null, null, 1, 1);\n            }\n        }\n\n        /**\n         * Refresh the data\r\n         * \r\n         * @return void\r\n         */\r\n        obj.refresh = function() {\r\n            if (obj.options.url) {\r\n                // Loading\r\n                if (obj.options.loadingSpin == true) {\r\n                    jSuites.loading.show();\r\n                }\r\n    \r\n                jSuites.ajax({\r\n                    url: obj.options.url,\r\n                    method: 'GET',\r\n                    dataType: 'json',\r\n                    success: function(result) {\r\n                        // Data\r\n                        obj.options.data = (result.data) ? result.data : result;\r\n                        // Prepare table\r\n                        obj.setData();\r\n                        // Hide spin\r\n                        if (obj.options.loadingSpin == true) {\r\n                            jSuites.loading.hide();\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                obj.setData();\r\n            }\r\n        }\r\n\n        /**\n         * Set data\n         * \n         * @param array data In case no data is sent, default is reloaded\n         * @return void\n         */\n        obj.setData = function(data) {\n            // Update data\n            if (data) {\n                if (typeof(data) == 'string') {\n                    data = JSON.parse(data);\n                }\n    \n                obj.options.data = data;\n            }\n    \n            // Data\n            if (! obj.options.data) {\n                obj.options.data = [];\n            }\n    \n            // Prepare data\n            if (obj.options.data && obj.options.data[0]) {\r\n                if (! Array.isArray(obj.options.data[0])) {\n                    var data = [];\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        var row = [];\n                        for (var i = 0; i < obj.options.columns.length; i++) {\r\n                            row[i] = obj.options.data[j][obj.options.columns[i].name];\n                        }\n                        data.push(row);\n                    }\n\n                    obj.options.data = data;\r\n                }\n            }\n\n            // Adjust minimal dimensions\n            var j = 0;\n            var i = 0;\n            var size_i = obj.options.columns.length;\n            var size_j = obj.options.data.length;\n            var min_i = obj.options.minDimensions[0];\n            var min_j = obj.options.minDimensions[1];\n            var max_i = min_i > size_i ? min_i : size_i;\n            var max_j = min_j > size_j ? min_j : size_j;\n    \n            for (j = 0; j < max_j; j++) {\n                for (i = 0; i < max_i; i++) {\n                    if (obj.options.data[j] == undefined) {\n                        obj.options.data[j] = [];\n                    }\n    \n                    if (obj.options.data[j][i] == undefined) {\n                        obj.options.data[j][i] = '';\n                    }\n                }\n            }\n    \n            // Reset containers\n            obj.rows = [];\n            obj.results = null;\n            obj.records = [];\n            obj.history = [];\n    \n            // Reset internal controllers\n            obj.historyIndex = -1;\n    \n            // Reset data\n            obj.tbody.innerHTML = '';\n    \n            // Lazy loading\n            if (obj.options.lazyLoading == true) {\n                // Load only 100 records\n                var startNumber = 0\n                var finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\n    \n                if (obj.options.pagination) {\n                    obj.options.pagination = false;\n                    console.error('JEXCEL: Pagination will be disable due the lazyLoading');\n                }\n            } else if (obj.options.pagination) {\n                // Pagination\n                if (! obj.pageNumber) {\n                    obj.pageNumber = 0;\n                }\n                var quantityPerPage = obj.options.pagination;\n                startNumber = (obj.options.pagination * obj.pageNumber);\n                finalNumber = (obj.options.pagination * obj.pageNumber) + obj.options.pagination;\n    \n                if (obj.options.data.length < finalNumber) {\n                    finalNumber = obj.options.data.length;\n                }\n            } else {\n                var startNumber = 0;\n                var finalNumber = obj.options.data.length;\n            }\n    \n            // Append nodes to the HTML\n            for (j = 0; j < obj.options.data.length; j++) {\n                // Create row\n                var tr = obj.createRow(j, obj.options.data[j]);\n                // Append line to the table\n                if (j >= startNumber && j < finalNumber) {\n                    obj.tbody.appendChild(tr);\n                }\n            }\n    \n            if (obj.options.lazyLoading == true) {\n                // Do not create pagination with lazyloading activated\n            } else if (obj.options.pagination) {\n                obj.updatePagination();\n            }\n    \n            // Merge cells\n            if (obj.options.mergeCells) {\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    var num = obj.options.mergeCells[keys[i]];\n                    obj.setMerge(keys[i], num[0], num[1], 1);\n                }\n            }\n\n            // Updata table with custom configurations if applicable\n            obj.updateTable();\n\r\n            // Onload\r\n            obj.dispatch('onload', el, obj);\n        }\n\n        /**\n         * Get the whole table data\n         * \n         * @param bool get highlighted cells only\n         * @return array data\n         */\n        obj.getData = function(highlighted, dataOnly) {\n            // Control vars\n            var dataset = [];\n            var px = 0;\n            var py = 0;\n\r\n            // Data type\r\n            var dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false;\r\n\n            // Column and row length\n            var x = obj.options.columns.length\n            var y = obj.options.data.length\n    \n            // Go through the columns to get the data\n            for (var j = 0; j < y; j++) {\n                px = 0;\n                for (var i = 0; i < x; i++) {\n                    // Cell selected or fullset\n                    if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                        // Get value\n                        if (! dataset[py]) {\n                            dataset[py] = [];\n                        }\n                        if (! dataType) {\n                            dataset[py][px] = obj.records[j][i].innerHTML;\n                        } else {\n                            dataset[py][px] = obj.options.data[j][i];\n                        }\n                        px++;\n                    }\n                }\n                if (px > 0) {\n                    py++;\n                }\n           }\n    \n           return dataset;\n        }\n    \n        /**\n         * Get the whole table data\n         * \n         * @param integer row number\n         * @return string value\n         */\n        obj.getJson = function(highlighted) {\n            // Control vars\n            var data = [];\n    \n            // Column and row length\n            var x = obj.options.columns.length\n            var y = obj.options.data.length\n    \n            // Go through the columns to get the data\n            for (var j = 0; j < y; j++) {\n                var row = null;\n                for (var i = 0; i < x; i++) {\n                    if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                        if (row == null) {\n                            row = {};\n                        }\n                        if (! obj.options.columns[i].name) {\r\n                            obj.options.columns[i].name = i;\r\n                        }\n                        row[obj.options.columns[i].name] = obj.options.data[j][i];\n                    }\n                }\n    \n                if (row != null) {\n                    data.push(row);\n                }\n           }\n    \n           return data;\n        }\n\r\n        /**\r\n         * Prepare JSON in the correct format\r\n         */\r\n        obj.prepareJson = function(data) {\r\n            var rows = [];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var x = data[i].x;\r\n                var y = data[i].y;\r\n                var k = obj.options.columns[x].name ? obj.options.columns[x].name : x;\r\n\r\n                // Create row\r\n                if (! rows[y]) {\r\n                    rows[y] = {\r\n                        row: y,\r\n                        data: {},\r\n                    };\r\n                }\r\n                rows[y].data[k] = data[i].newValue;\r\n            }\r\n\r\n            // Filter rows\r\n            return rows.filter(function (el) {\r\n                return el != null;\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Post json to a remote server\r\n         */\r\n        obj.save = function(url, data) {\r\n            // Parse anything in the data before sending to the server\r\n            var ret = obj.dispatch('onbeforesave', el, obj, data);\r\nconsole.log(ret);\r\n            if (ret) {\r\n                var data = ret;\r\n            } else {\r\n                if (ret === false) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            // Remove update\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: { data: JSON.stringify(data) },\r\n                success: function(result) {\r\n                    // Event\r\n                    obj.dispatch('onsave', el, obj, data);\r\n                }\r\n            });\r\n        }\r\n\n        /**\n         * Get a row data by rowNumber\n         */\n        obj.getRowData = function(rowNumber) {\n            return obj.options.data[rowNumber];\n        }\n    \n        /**\n         * Set a row data by rowNumber\n         */\n        obj.setRowData = function(rowNumber, data) {\n            for (var i = 0; i < obj.headers.length; i++) {\n                // Update cell\n                var columnName = jexcel.getColumnNameFromId([ i, rowNumber ]);\n                // Set value\n                if (data[i] != null) {\n                    obj.setValue(columnName, data[i]);\n                }\n            }\n        }\n    \n        /**\n         * Get a column data by columnNumber\n         */\n        obj.getColumnData = function(columnNumber) {\n            var dataset = [];\n            // Go through the rows to get the data\n            for (var j = 0; j < obj.options.data.length; j++) {\n                dataset.push(obj.options.data[j][columnNumber]);\n            }\n            return dataset;\n        }\n    \n        /**\n         * Set a column data by colNumber\n         */\n        obj.setColumnData = function(colNumber, data) {\n            for (var j = 0; j < obj.rows.length; j++) {\n                // Update cell\n                var columnName = jexcel.getColumnNameFromId([ colNumber, j ]);\n                // Set value\n                if (data[j] != null) {\n                    obj.setValue(columnName, data[j]);\n                }\n            }\n        }\n    \n        /**\n         * Create row\n         */\n        obj.createRow = function(j, data) {\n            // Create container\n            if (! obj.records[j]) {\n                obj.records[j] = [];\n            }\n            // Default data\n            if (! data) {\n                var data = obj.options.data[j];\n            }\n            // New line of data to be append in the table\n            obj.rows[j] = document.createElement('tr');\n            obj.rows[j].setAttribute('data-y', j);\n            // Definitions\n            if (obj.options.rows[j]) {\n                if (obj.options.rows[j].height) {\n                    obj.rows[j].style.height = obj.options.rows[j].height;\n                }\n            }\n            // Row number label\n            var td = document.createElement('td');\n            td.innerHTML = parseInt(j + 1);\n            td.setAttribute('data-y', j);\n            td.className = 'jexcel_row';\n            obj.rows[j].appendChild(td);\n    \n            // Data columns\n            for (var i = 0; i < obj.options.columns.length; i++) {\n                // New column of data to be append in the line\n                obj.records[j][i] = obj.createCell(i, j, data[i]);\n                // Add column to the row\n                obj.rows[j].appendChild(obj.records[j][i]);\n            }\n    \n            // Add row to the table body\n            return obj.rows[j];\n        }\n    \r\n        obj.parseValue = function(i, j, value) {\r\n            if ((''+value).substr(0,1) == '=' && obj.options.parseFormulas == true) {\r\n                value = obj.executeFormula(value, i, j)\r\n            }\r\n            if (obj.options.columns[i].mask) {\r\n                var decimal = obj.options.columns[i].decimal || '.';\r\n                value = '' + jSuites.mask.run(value, obj.options.columns[i].mask, decimal);\r\n            }\r\n\r\n            return value;\r\n        }\r\n\n        /**\n         * Create cell\n         */\n        obj.createCell = function(i, j, value) {\n            // Create cell and properties\n            var td = document.createElement('td');\n            td.setAttribute('data-x', i);\n            td.setAttribute('data-y', j);\r\n\r\n            // Security\r\n            if ((''+value).substr(0,1) == '=' && obj.options.secureFormulas == true) {\r\n                var val = secureFormula(value);\r\n                if (val != value) {\r\n                    // Update the data container\r\n                    value = val;\r\n                }\r\n            }\r\n\r\n            // Custom column\r\n            if (obj.options.columns[i].editor) {\r\n                if (obj.options.stripHTML == true) {\r\n                    td.innerText = value;\r\n                } else {\r\n                    td.innerHTML =  value;\r\n                }\r\n                if (typeof(obj.options.columns[i].editor.createCell) == 'function') {\r\n                    td = obj.options.columns[i].editor.createCell(td);\r\n                }\r\n            } else {\n                // Hidden column\n                if (obj.options.columns[i].type == 'hidden') {\n                    td.style.display = 'none';\n                    td.innerText = value;\n                } else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\n                    // Create input\n                    var element = document.createElement('input');\n                    element.type = obj.options.columns[i].type;\n                    element.name = 'c' + i;\n                    element.checked = (value == 1 || value == true || value == 'true') ? true : false;\n                    element.onclick = function() {\n                        obj.setValue(td, this.checked);\n                    }\n\n                    if (obj.options.columns[i].readOnly == true || obj.options.editable == false) {\n                        element.setAttribute('disabled', 'disabled');\n                    }\n\n                    // Append to the table\n                    td.appendChild(element);\n                    // Make sure the values are correct\n                    obj.options.data[j][i] = element.checked;\n                } else if (obj.options.columns[i].type == 'calendar') {\n                    // Try formatted date\n                    var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format);\n                    // Create calendar cell\n                    td.innerText = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\n                } else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\n                    // Create dropdown cell\n                    td.classList.add('jexcel_dropdown');\n                    td.innerText = obj.getDropDownValue(i, value);\n                } else if (obj.options.columns[i].type == 'color') {\n                    if (obj.options.columns[i].render == 'square') {\n                        var color = document.createElement('div');\n                        color.className = 'color';\n                        color.style.backgroundColor = value;\n                        td.appendChild(color);\n                    } else {\n                        td.style.color = value;\n                        td.innerText = value;\n                    }\n                } else if (obj.options.columns[i].type == 'image') {\n                    if (value && value.substr(0, 10) == 'data:image') {\n                        var img = document.createElement('img');\n                        img.src = value;\n                        td.appendChild(img);\n                    }\n                } else {\n                    if (obj.options.columns[i].type == 'html') {\r\n                        td.innerHTML = stripScript(obj.parseValue(i, j, value));\r\n                    } else {\r\n                        if (obj.options.stripHTML == true) {\r\n                            td.innerText = obj.parseValue(i, j, value);\r\n                        } else {\r\n                            td.innerHTML = stripScript(obj.parseValue(i, j, value));\r\n                        }\r\n                    }\n                }\r\n            }\n    \n            // Readonly\n            if (obj.options.columns[i].readOnly == true) {\n                td.className = 'readonly';\n            }\n    \n            // Text align\n            var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\n            td.style.textAlign = colAlign;\n    \n            // Wrap option\n            if (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\n                td.style.whiteSpace = 'pre-wrap';\n            }\n    \n            // Overflow\n            if (i > 0) {\n                if (value || td.innerHTML) {\n                    obj.records[j][i-1].style.overflow = 'hidden';\n                } else {\n                    if (i == obj.options.columns.length - 1) {\n                        td.style.overflow = 'hidden';\n                    }\n                }\n            }\n    \n            return td;\n        }\n    \n        obj.createCellHeader = function(colNumber) {\n            // Create col global control\n            var colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\n            var colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign;\n    \n            // Create header cell\n            obj.headers[colNumber] = document.createElement('td');\n            obj.headers[colNumber].innerText = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\n            obj.headers[colNumber].setAttribute('data-x', colNumber);\n            obj.headers[colNumber].style.textAlign = colAlign;\n            if (obj.options.columns[colNumber].title) {\n                obj.headers[colNumber].setAttribute('title', obj.options.columns[colNumber].title);\n            }\n    \n            // Width control\n            obj.colgroup[colNumber] = document.createElement('col');\n            obj.colgroup[colNumber].setAttribute('width', colWidth);\n    \n            // Hidden column\n            if (obj.options.columns[colNumber].type == 'hidden') {\n                obj.headers[colNumber].style.display = 'none';\n                obj.colgroup[colNumber].style.display = 'none';\n            }\n        }\n\r\n        /**\r\n         * Update a nested header title\r\n         */\r\n        obj.updateNestedHeader = function(x, y, title) {\r\n            if (obj.options.nestedHeaders[y][x].title) {\r\n                obj.options.nestedHeaders[y][x].title = title;\r\n                obj.options.nestedHeaders[y].element.children[x+1].innerText = title;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Create a nested header object\r\n         */\n        obj.createNestedHeader = function(nestedInformation) {\n            var tr = document.createElement('tr');\n            tr.classList.add('jexcel_nested');\n            var td = document.createElement('td');\n            tr.appendChild(td);\r\n            // Element\r\n            nestedInformation.element = tr;\n    \n            var headerIndex = 0;\n            for (var i = 0; i < nestedInformation.length; i++) {\n                // Default values\n                if (! nestedInformation[i].colspan) {\n                    nestedInformation[i].colspan = 1;\n                }\n                if (! nestedInformation[i].align) {\n                    nestedInformation[i].align = 'center';\n                }\n                if (! nestedInformation[i].title) {\n                    nestedInformation[i].title = '';\n                }\n    \n                // Number of columns\n                var numberOfColumns = nestedInformation[i].colspan;\n    \n                // Classes container\n                var column = [];\n                // Header classes for this cell\n                for (var x = 0; x < numberOfColumns; x++) {\n                    if (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\n                        numberOfColumns++;\n                    }\n                    column.push(headerIndex);\n                    headerIndex++;\n                }\n    \n                // Created the nested cell\n                var td = document.createElement('td');\n                td.setAttribute('data-column', column.join(','));\n                td.setAttribute('colspan', nestedInformation[i].colspan);\n                td.setAttribute('align', nestedInformation[i].align);\n                td.innerText = nestedInformation[i].title;\n                tr.appendChild(td);\n            }\n    \n            return tr;\n        }\n    \n        /**\n         * Create toolbar\n         */\n        obj.createToolbar = function(toolbar) {\n            if (toolbar) {\n                obj.options.toolbar = toolbar;\n            } else {\n                var toolbar = obj.options.toolbar;\n            }\n    \n            for (var i = 0; i < toolbar.length; i++) {\n                if (toolbar[i].type == 'i') {\n                    var toolbarItem = document.createElement('i');\n                    toolbarItem.classList.add('jexcel_toolbar_item');\n                    toolbarItem.classList.add('material-icons');\n                    toolbarItem.setAttribute('data-k', toolbar[i].k);\n                    toolbarItem.setAttribute('data-v', toolbar[i].v);\n                    // Tooltip\n                    if (toolbar[i].tooltip) {\n                        toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                    }\n                    // Handle click\n                    if (toolbar[i].onclick && typeof(toolbar[i].onclick)) {\n                        toolbarItem.onclick = toolbar[i].onclick;\n                    } else {\n                        toolbarItem.onclick = function() {\n                            var k = this.getAttribute('data-k');\n                            var v = this.getAttribute('data-v');\n                            obj.setStyle(obj.highlighted, k, v);\n                        }\n                    }\n                    // Append element\n                    toolbarItem.innerText = toolbar[i].content;\n                    obj.toolbar.appendChild(toolbarItem);\n                } else if (toolbar[i].type == 'select') {\n                   var toolbarItem = document.createElement('select');\n                   toolbarItem.classList.add('jexcel_toolbar_item');\n                   toolbarItem.setAttribute('data-k', toolbar[i].k);\n                   // Tooltip\n                   if (toolbar[i].tooltip) {\n                       toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                   }\n                   // Handle onchange\n                   if (toolbar[i].onchange && typeof(toolbar[i].onchange)) {\n                       toolbarItem.onchange = toolbar[i].onchange;\n                   } else {\n                       toolbarItem.onchange = function() {\n                           var k = this.getAttribute('data-k');\n                           obj.setStyle(obj.highlighted, k, this.value);\n                       }\n                   }\n                   // Add options to the dropdown\n                   for(var j = 0; j < toolbar[i].v.length; j++) {\n                        var toolbarDropdownOption = document.createElement('option');\n                        toolbarDropdownOption.value = toolbar[i].v[j];\n                        toolbarDropdownOption.innerText = toolbar[i].v[j];\n                        toolbarItem.appendChild(toolbarDropdownOption);\n                   }\n                   obj.toolbar.appendChild(toolbarItem);\n                } else if (toolbar[i].type == 'color') {\n                     var toolbarItem = document.createElement('i');\n                     toolbarItem.classList.add('jexcel_toolbar_item');\n                     toolbarItem.classList.add('material-icons');\n                     toolbarItem.setAttribute('data-k', toolbar[i].k);\n                     toolbarItem.setAttribute('data-v', '');\n                     // Tooltip\n                     if (toolbar[i].tooltip) {\n                         toolbarItem.setAttribute('title', toolbar[i].tooltip);\n                     }\n                     obj.toolbar.appendChild(toolbarItem);\n                     toolbarItem.onclick = function() {\n                         this.color.open();\n                     }\n                     toolbarItem.innerText = toolbar[i].content;\n                     jSuites.color(toolbarItem, {\n                         onchange:function(o, v) {\n                             var k = o.getAttribute('data-k');\n                             obj.setStyle(obj.highlighted, k, v);\n                         }\n                     });\n                }\n            }\n        }\n    \n        /**\n         * Merge cells\n         * @param cellName\n         * @param colspan\n         * @param rowspan\n         * @param ignoreHistoryAndEvents\n         */\n        obj.setMerge = function(cellName, colspan, rowspan, ignoreHistoryAndEvents) {\n            var test = false;\n    \n            if (! cellName) {\n                if (! obj.highlighted.length) {\n                    alert(obj.options.text.noCellsSelected);\n                    return null;\n                } else {\n                    var x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\n                    var y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\n                    var x2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-x'));\n                    var y2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-y'));\n                    var cellName = jexcel.getColumnNameFromId([ x1, y1 ]);\n                    var colspan = (x2 - x1) + 1;\n                    var rowspan = (y2 - y1) + 1;\n                }\n            }\n    \n            var cell = jexcel.getIdFromColumnName(cellName, true);\n    \n            if (obj.options.mergeCells[cellName]) {\n                if (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\n                    test = obj.options.text.cellAlreadyMerged;\n                }\n            } else if ((! colspan || colspan < 2) && (! rowspan || rowspan < 2)) {\n                test = obj.options.text.invalidMergeProperties;\n            } else {\n                var cells = [];\n                for (var j = cell[1]; j < cell[1] + rowspan; j++) {\n                    for (var i = cell[0]; i < cell[0] + colspan; i++) {\n                        var columnName = jexcel.getColumnNameFromId([i, j]);\n                        if (obj.records[j][i].getAttribute('data-merged')) {\n                            test = obj.options.text.thereIsAConflictWithAnotherMergedCell;\n                        }\n                    }\n                }\n            }\n    \n            if (test) {\n                alert(test);\n            } else {\n                // Add property\n                if (colspan > 1) {\n                    obj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\n                } else {\n                    colspan = 1;\n                }\n                if (rowspan > 1) {\n                    obj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\n                } else {\n                    rowspan = 1;\n                }\n                // Keep links to the existing nodes\n                obj.options.mergeCells[cellName] = [ colspan, rowspan, [] ];\n                // Mark cell as merged\n                obj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true');\n                // Overflow\n                obj.records[cell[1]][cell[0]].style.overflow = 'hidden';\n                // History data\n                var data = [];\n                // Adjust the nodes\n                for (var y = cell[1]; y < cell[1] + rowspan; y++) {\n                    for (var x = cell[0]; x < cell[0] + colspan; x++) {\n                        if (! (cell[0] == x && cell[1] == y)) {\n                            data.push(obj.options.data[y][x]);\n                            obj.updateCell(x, y, '', true);\n                            obj.options.mergeCells[cellName][2].push(obj.records[y][x]);\n                            obj.records[y][x].style.display = 'none';\n                            obj.records[y][x] = obj.records[cell[1]][cell[0]];\n                        }\n                    }\n                }\n                // In the initialization is not necessary keep the history\n                obj.updateSelection(obj.records[cell[1]][cell[0]]);\n    \n                if (! ignoreHistoryAndEvents) {\n                    obj.setHistory({\n                        action:'setMerge',\n                        column:cellName,\n                        colspan:colspan,\n                        rowspan:rowspan,\n                        data:data,\n                    });\n    \r\n                    obj.dispatch('onmerge', el, cellName, colspan, rowspan);\n                }\n            }\n        }\n    \n        /**\n         * Merge cells\n         * @param cellName\n         * @param colspan\n         * @param rowspan\n         * @param ignoreHistoryAndEvents\n         */\n        obj.getMerge = function(cellName) {\n            var data = {};\n            if (cellName) {\n                if (obj.options.mergeCells[cellName]) {\n                    data = [ obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1] ];\n                } else {\n                    data = null;\n                }\n            } else {\n                if (obj.options.mergeCells) {\n                    var mergedCells = obj.options.mergeCells;\n                    var keys = Object.keys(obj.options.mergeCells);\n                    for (var i = 0; i < keys.length; i++) {\n                        data[keys[i]] = [ obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1] ];\n                    }\n                }\n            }\n    \n            return data;\n        }\n    \n        /**\n         * Remove merge by cellname\n         * @param cellName\n         */\n        obj.removeMerge = function(cellName, data, keepOptions) {\n            if (obj.options.mergeCells[cellName]) {\n                var cell = jexcel.getIdFromColumnName(cellName, true);\n                obj.records[cell[1]][cell[0]].removeAttribute('colspan');\n                obj.records[cell[1]][cell[0]].removeAttribute('rowspan');\n                obj.records[cell[1]][cell[0]].removeAttribute('data-merged');\n                var info = obj.options.mergeCells[cellName];\n    \n                var index = 0;\n                for (var j = 0; j < info[1]; j++) {\n                    for (var i = 0; i < info[0]; i++) {\n                        if (j > 0 || i > 0) {\n                            obj.records[cell[1]+j][cell[0]+i] = info[2][index];\n                            obj.records[cell[1]+j][cell[0]+i].style.display = '';\n                            // Recover data\n                            if (data && data[index]) {\n                                obj.updateCell(cell[0]+i, cell[1]+j, data[index]);\n                            }\n                            index++;\n                        }\n                    }\n                }\n    \n                // Update selection\n                obj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1]+j-1][cell[0]+i-1]);\n    \n                if (! keepOptions) {\n                    delete(obj.options.mergeCells[cellName]);\n                }\n            }\n        }\n    \n        /**\n         * Remove all merged cells\n         */\n        obj.destroyMerged = function(keepOptions) {\n            // Remove any merged cells\n            if (obj.options.mergeCells) {\n                var mergedCells = obj.options.mergeCells;\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    obj.removeMerge(keys[i], null, keepOptions);\n                }\n            }\n        }\n    \n        /**\n         * Is column merged\n         */\n        obj.isColMerged = function(x, insertBefore) {\n            var cols = [];\n            // Remove any merged cells\n            if (obj.options.mergeCells) {\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    var info = jexcel.getIdFromColumnName(keys[i], true);\n                    var colspan = obj.options.mergeCells[keys[i]][0];\n                    var x1 = info[0];\n                    var x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\n    \n                    if (insertBefore == null) {\n                        if ((x1 <= x && x2 >= x)) {\n                            cols.push(keys[i]);\n                        }\n                    } else {\n                        if (insertBefore) {\n                            if ((x1 < x && x2 >= x)) {\n                                cols.push(keys[i]);\n                            }\n                        } else {\n                            if ((x1 <= x && x2 > x)) {\n                                cols.push(keys[i]);\n                            }\n                        }\n                    }\n                }\n            }\n    \n            return cols;\n        }\n    \n        /**\n         * Is rows merged\n         */\n        obj.isRowMerged = function(y, insertBefore) {\n            var rows = [];\n            // Remove any merged cells\n            if (obj.options.mergeCells) {\n                var keys = Object.keys(obj.options.mergeCells);\n                for (var i = 0; i < keys.length; i++) {\n                    var info = jexcel.getIdFromColumnName(keys[i], true);\n                    var rowspan = obj.options.mergeCells[keys[i]][1];\n                    var y1 = info[1];\n                    var y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\n    \n                    if (insertBefore == null) {\n                        if ((y1 <= y && y2 >= y)) {\n                            rows.push(keys[i]);\n                        }\n                    } else {\n                        if (insertBefore) {\n                            if ((y1 < y && y2 >= y)) {\n                                rows.push(keys[i]);\n                            }\n                        } else {\n                            if ((y1 <= y && y2 > y)) {\n                                rows.push(keys[i]);\n                            }\n                        }\n                    }\n                }\n            }\n    \n            return rows;\n        }\n\r\n        /**\r\n         * Open the column filter\r\n         */\r\n        obj.openFilter = function(columnId) {\r\n            if (! obj.options.filters) {\r\n                console.log('JEXCEL: filters not enabled.');\r\n            } else {\r\n                // Make sure is integer\r\n                columnId = parseInt(columnId);\r\n                // Reset selection\r\n                obj.resetSelection();\r\n                // Load options\r\n                var options = [];\r\n                for (var j = 0; j < obj.options.data.length; j++) {\r\n                    var k = obj.options.data[j][columnId];\r\n                    var v = obj.records[j][columnId].innerHTML;\r\n                    if (k && v) {\r\n                        options[k] = v;\r\n                    }\r\n                }\r\n                var keys = Object.keys(options);\r\n                var optionsFiltered = [];\r\n                for (var j = 0; j < keys.length; j++) {\r\n                    optionsFiltered.push({ id: keys[j], name: options[keys[j]] });\r\n                }\r\n\r\n                // Create dropdown\r\n                var div = document.createElement('div');\r\n                obj.filter.children[columnId + 1].innerHTML = '';\r\n                obj.filter.children[columnId + 1].appendChild(div);\r\n                obj.filter.children[columnId + 1].style.paddingLeft = '0px';\r\n                obj.filter.children[columnId + 1].style.paddingRight = '20px';\r\n                obj.filter.children[columnId + 1].style.overflow = 'initial';\r\n\r\n                // Dynamic dropdown\r\n                jSuites.dropdown(div, {\r\n                    data: optionsFiltered,\r\n                    multiple: true,\r\n                    autocomplete: true,\r\n                    opened: true,\r\n                    value: obj.filters[columnId] ? obj.filters[columnId] : '',\r\n                    width:'100%',\r\n                    position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\r\n                    onclose: function(o) {\r\n                        obj.resetFilters();\r\n                        obj.filters[columnId] = o.dropdown.getValue(true);\r\n                        obj.filter.children[columnId + 1].innerHTML = o.dropdown.getText();\r\n                        obj.filter.children[columnId + 1].style.paddingLeft = '';\r\n                        obj.filter.children[columnId + 1].style.paddingRight = '';\r\n                        obj.filter.children[columnId + 1].style.overflow = '';\r\n                        obj.closeFilter(columnId);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        obj.resetFilters = function() {\r\n            if (obj.options.filters) {\r\n                for (var i = 0; i < obj.filter.children.length; i++) {\r\n                    obj.filter.children[i].innerHTML = '&nbsp;';\r\n                    obj.filters[i] = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.closeFilter = function(columnId) {\r\n            if (! columnId) {\r\n                for (var i = 0; i < obj.filter.children.length; i++) {\r\n                    if (obj.filters[i]) {\r\n                        columnId = i;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Search filter\r\n            var search = function(query, x, y) {\r\n                for (var i = 0; i < query.length; i++) {\r\n                    if ((''+obj.options.data[y][x]).search(query[i]) >= 0 ||\r\n                        (''+obj.records[y][x].innerHTML).search(query[i]) >= 0) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            var query = obj.filters[columnId];\r\n            obj.results = [];\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                if (search(query, columnId, j)) {\r\n                    obj.results.push(j);\r\n                }\r\n            }\r\n            if (! obj.results.length) {\r\n                obj.results = null;\r\n            }\r\n\r\n            obj.updateResult();\r\n        }\r\n\n        /**\n         * Open the editor\n         * \n         * @param object cell\n         * @return void\n         */\n        obj.openEditor = function(cell, empty, e) {\n            // Get cell position\n            var y = cell.getAttribute('data-y');\n            var x = cell.getAttribute('data-x');\n    \n            // On edition start\n            obj.dispatch('oneditionstart', el, cell, x, y);\n    \n            // Overflow\n            if (x > 0) {\n                obj.records[y][x-1].style.overflow = 'hidden';\n            }\n    \n            // Create editor\n            var createEditor = function(type) {\n                // Cell information\n                var info = cell.getBoundingClientRect();\n    \n                // Create dropdown\n                var editor = document.createElement(type);\n                editor.style.width = (info.width) + 'px';\n                editor.style.height = (info.height - 2) + 'px';\n                editor.style.minHeight = (info.height - 2) + 'px';\n    \n                // Edit cell\n                cell.classList.add('editor');\n                cell.innerHTML = '';\n                cell.appendChild(editor);\n    \n                return editor;\n            }\n    \n            // Readonly\n            if (cell.classList.contains('readonly') == true) {\n                // Do nothing\n            } else {\n                // Holder\n                obj.edition = [ obj.records[y][x], obj.records[y][x].innerHTML, x, y ];\n    \n                // If there is a custom editor for it\n                if (obj.options.columns[x].editor) {\n                    // Custom editors\n                    obj.options.columns[x].editor.openEditor(cell, el, empty, e);\n                } else {\n                    // Native functions\n                    if (obj.options.columns[x].type == 'hidden') {\n                        // Do nothing\n                    } else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                        // Get value\n                        var value = cell.children[0].checked ? false : true;\n                        // Toogle value\n                        obj.setValue(cell, value);\n                        // Do not keep edition open\n                        obj.edition = null;\n                    } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                        // Get current value\n                        var value = obj.options.data[y][x];\n    \n                        // Create dropdown\n                        if (typeof(obj.options.columns[x].filter) == 'function') {\n                            var source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\n                        } else {\n                            var source = obj.options.columns[x].source;\n                        }\n    \n                        // Create editor\n                        var editor = createEditor('div');\n                        var options = {\n                            data: source,\n                            multiple: obj.options.columns[x].multiple ? true : false,\n                            autocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\n                            opened:true,\n                            value: obj.options.columns[x].multiple ? value.split(';') : value,\n                            width:'100%',\n                            height:editor.style.minHeight,\n                            position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\n                            onclose:function() {\n                                obj.closeEditor(cell, true);\n                            }\n                        };\n                        if (obj.options.columns[x].options && obj.options.columns[x].options.type) {\n                            options.type = obj.options.columns[x].options.type;\n                        }\n                        jSuites.dropdown(editor, options);\n                    } else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\n                        // Value\n                        var value = obj.options.data[y][x];\n                        // Create editor\n                        var editor = createEditor('input');\n                        editor.value = value;\n    \n                        if (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\n                            obj.options.columns[x].options.position = true;\n                        }\n                        obj.options.columns[x].options.value = obj.options.data[y][x];\n                        obj.options.columns[x].options.opened = true;\n                        obj.options.columns[x].options.onclose = function(el, value) {\n                            obj.closeEditor(cell, true);\n                        }\n                        // Current value\n                        if (obj.options.columns[x].type == 'color') {\n                            jSuites.color(editor, obj.options.columns[x].options);\n                        } else {\n                            jSuites.calendar(editor, obj.options.columns[x].options);\n                        }\n                        // Focus on editor\n                        editor.focus();\r\n                    } else if (obj.options.columns[x].type == 'html') {\r\n                        var value = obj.options.data[y][x];\r\n                        // Create editor\r\n                        var editor = createEditor('div');\r\n                        editor.style.position = 'relative';\r\n                        var div = document.createElement('div');\r\n                        div.classList.add('jexcel_richtext');\r\n                        editor.appendChild(div);\r\n                        jSuites.editor(div, {\r\n                            focus: true,\r\n                            value: value,\r\n                        });\r\n                        const rect = cell.getBoundingClientRect();\r\n                        const rectContent = div.getBoundingClientRect();\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            div.style.top = (rect.top) + 'px';\r\n                        }\n                    } else if (obj.options.columns[x].type == 'image') {\n                        // Value\n                        var img = cell.children[0];\n                        // Create editor\n                        var editor = createEditor('div');\n                        editor.style.position = 'relative';\n                        var div = document.createElement('div');\n                        div.classList.add('jclose');\n                        if (img && img.src) {\n                            div.appendChild(img);\n                        }\n                        editor.appendChild(div);\n                        jSuites.image(div, obj.options.imageOptions);\n                        const rect = cell.getBoundingClientRect();\n                        const rectContent = div.getBoundingClientRect();\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\n                            div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                        } else {\n                            div.style.top = (rect.top) + 'px';\n                        }\n                    } else {\n                        // Value\n                        var value = empty == true ? '' : obj.options.data[y][x];\n    \n                        // Basic editor\n                        if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\n                            var editor = createEditor('textarea');\n                        } else {\n                            var editor = createEditor('input');\r\n                            // Mask\n                            if (obj.options.columns[x].mask) {\n                                editor.setAttribute('data-mask', obj.options.columns[x].mask);\n                            }\n                        }\n    \n                        editor.onblur = function() {\n                            obj.closeEditor(cell, true);\n                        };\n                        editor.focus();\n                        editor.value = value;\n                    }\n                }\n            }\n        }\n    \n        /**\n         * Close the editor and save the information\n         * \n         * @param object cell\n         * @param boolean save\n         * @return void\n         */\n        obj.closeEditor = function(cell, save) {\n            var x = parseInt(cell.getAttribute('data-x'));\n            var y = parseInt(cell.getAttribute('data-y'));\n\n            // Get cell properties\n            if (save == true) {\n                // If custom editor\n                if (obj.options.columns[x].editor) {\n                    // Custom editor\n                    var value = obj.options.columns[x].editor.closeEditor(cell, save);\n                } else {\n                    // Native functions\n                    if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {\n                        // Do nothing\n                    } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                        var value = cell.children[0].dropdown.close(true);\r\n                    } else if (obj.options.columns[x].type == 'calendar') {\r\n                        var value = cell.children[0].calendar.close(true);\r\n                    } else if (obj.options.columns[x].type == 'color') {\n                        var value = cell.children[0].color.close(true);\r\n                    } else if (obj.options.columns[x].type == 'html') {\r\n                        var value = cell.children[0].children[0].editor.getData();\n                    } else if (obj.options.columns[x].type == 'image') {\n                        var img = cell.children[0].children[0].children[0];\n                        var value = img && img.tagName == 'IMG' ? img.src : '';\n                    } else if (obj.options.columns[x].type == 'numeric') {\n                        var value = cell.children[0].value;\n                        if (value.substr(0,1) != '=') {\n                            if (value == '') {\n                                value = obj.options.columns[x].allowEmpty ? '' : 0;\n                            }\n                        }\n                        cell.children[0].onblur = null;\n                    } else {\n                        var value = cell.children[0].value;\n                        cell.children[0].onblur = null;\n                    }\n                }\n\n                // Ignore changes if the value is the same\n                if (obj.options.data[y][x] == value) {\n                    cell.innerHTML = obj.edition[1];\n                } else {\n                    obj.setValue(cell, value);\n                }\n            } else {\n                if (obj.options.columns[x].editor) {\n                    // Custom editor\n                    obj.options.columns[x].editor.closeEditor(cell, save);\n                } else {\n                    if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                        cell.children[0].dropdown.close(true);\n                    } else if (obj.options.columns[x].type == 'calendar') {\n                        cell.children[0].calendar.close(true);\n                    } else if (obj.options.columns[x].type == 'color') {\n                        cell.children[0].color.close(true);\n                    } else {\n                        cell.children[0].onblur = null;\n                    }\n                }\n    \n                // Restore value\n                cell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\n            }\n    \n            // On edition end\r\n            obj.dispatch('oneditionend', el, cell, x, y, value, save);\n\n            // Remove editor class\n            cell.classList.remove('editor');\n    \n            // Finish edition\n            obj.edition = null;\n        }\n    \n        /**\n         * Get the cell object\n         * \n         * @param object cell\n         * @return string value\n         */\n        obj.getCell = function(cell) {\n            // Convert in case name is excel liked ex. A10, BB92\n            cell = jexcel.getIdFromColumnName(cell, true);\n            var x = cell[0];\n            var y = cell[1];\n    \n            return obj.records[y][x];\n        }\n    \n        /**\n         * Get the cell object from coords\n         * \n         * @param object cell\n         * @return string value\n         */\n        obj.getCellFromCoords = function(x, y) {\n            return obj.records[y][x];\n        }\n    \n        /**\n         * Get label\n         * \n         * @param object cell\n         * @return string value\n         */\n        obj.getLabel = function(cell) {\n            // Convert in case name is excel liked ex. A10, BB92\n            cell = jexcel.getIdFromColumnName(cell, true);\n            var x = cell[0];\n            var y = cell[1];\n    \n            return obj.records[y][x].innerHTML;\n        }\n    \n        /**\n         * Get labelfrom coords\n         * \n         * @param object cell\n         * @return string value\n         */\n        obj.getLabelFromCoords = function(x, y) {\n            return obj.records[y][x].innerHTML;\n        }\n    \n        /**\n         * Get the value from a cell\n         * \n         * @param object cell\n         * @return string value\n         */\n        obj.getValue = function(cell, processedValue) {\n            if (typeof(cell) == 'object') {\n                var x = cell.getAttribute('data-x');\n                var y = cell.getAttribute('data-y');\n            } else {\n                cell = jexcel.getIdFromColumnName(cell, true);\n                var x = cell[0];\n                var y = cell[1];\n            }\n    \n            var value = null;\n    \n            if (x != null && y != null) {\n                if (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\n                    value = obj.records[y][x].innerHTML;\n                } else {\n                    if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                        value = obj.options.data[y][x];\n                    }\n                }\n            }\n    \n            return value;\n        }\n    \n        /**\n         * Get the value from a coords\n         * \n         * @param int x\n         * @param int y\n         * @return string value\n         */\n        obj.getValueFromCoords = function(x, y, processedValue) {\n            var value = null;\n    \n            if (x != null && y != null) {\n                if ((obj.records[y] && obj.records[y][x]) && processedValue || obj.options.copyCompatibility == true) {\n                    value = obj.records[y][x].innerHTML;\n                } else {\n                    if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\n                        value = obj.options.data[y][x];\n                    }\n                }\n            }\n    \n            return value;\n        }\n    \n        /**\n         * Set a cell value\n         * \n         * @param mixed cell destination cell\n         * @param string value value\n         * @return void\n         */\n        obj.setValue = function(cell, value, force) {\n            var records = [];\n    \n            if (typeof(cell) == 'string') {\n                var columnId = jexcel.getIdFromColumnName(cell, true);\n                var x = columnId[0];\n                var y = columnId[1];\n    \n                // Update cell\n                records.push(obj.updateCell(x, y, value, force));\n    \n                // Update all formulas in the chain\n                obj.updateFormulaChain(x, y, records);\n            } else {\n                var x = null;\n                var y = null;\n                if (cell && cell.getAttribute) {\n                    var x = cell.getAttribute('data-x');\n                    var y = cell.getAttribute('data-y');\n                }\n    \n                // Update cell\n                if (x != null && y != null) {\n                    records.push(obj.updateCell(x, y, value, force));\n    \n                    // Update all formulas in the chain\n                    obj.updateFormulaChain(x, y, records);\n                } else {\n                    var keys = Object.keys(cell);\n                    if (keys.length > 0) {\n                        for (var i = 0; i < keys.length; i++) {\n                            if (typeof(cell[i]) == 'string') {\n                                var columnId = jexcel.getIdFromColumnName(cell[i], true);\n                                var x = columnId[0];\n                                var y = columnId[1];\n                            } else {\r\n                                if (cell[i].x != null && cell[i].y != null) {\r\n                                    var x = cell[i].x;\r\n                                    var y = cell[i].y;\r\n                                    // Flexible setup\r\n                                    if (cell[i].newValue != null) {\r\n                                        value = cell[i].newValue;\r\n                                    } else if (cell[i].value != null) {\r\n                                        value = cell[i].value;\r\n                                    }\r\n                                } else {\n                                    var x = cell[i].getAttribute('data-x');\n                                    var y = cell[i].getAttribute('data-y');\r\n                                }\n                            }\n    \n                             // Update cell\n                            if (x != null && y != null) {\n                                records.push(obj.updateCell(x, y, value, force));\n    \n                                // Update all formulas in the chain\n                                obj.updateFormulaChain(x, y, records);\n                            }\n                        }\n                    }\n                }\n            }\n    \n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n            });\n    \n            // Update table with custom configurations if applicable\n            obj.updateTable();\n    \n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    \n        /**\n         * Set a cell value based on coordinates\n         * \n         * @param int x destination cell\n         * @param int y destination cell\n         * @param string value\n         * @return void\n         */\n        obj.setValueFromCoords = function(x, y, value, force) {\n            var records = [];\n            records.push(obj.updateCell(x, y, value, force));\n    \n            // Update all formulas in the chain\n            obj.updateFormulaChain(x, y, records);\n    \n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n            });\n    \n            // Update table with custom configurations if applicable\n            obj.updateTable();\n    \n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    \n        /**\n         * Toogle\n         */\n        obj.setCheckRadioValue = function() {\n            var records = [];\n            var keys = Object.keys(obj.highlighted);\n            for (var i = 0; i < keys.length; i++) {\n                var x = obj.highlighted[i].getAttribute('data-x');\n                var y = obj.highlighted[i].getAttribute('data-y');\n    \n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                    // Update cell\n                    records.push(obj.updateCell(x, y, ! obj.options.data[y][x]));\n                }\n            }\n    \n            if (records.length) {\n                // Update history\n                obj.setHistory({\n                    action:'setValue',\n                    records:records,\n                    selection:obj.selectedCell,\n                });\n    \n                // On after changes\n                obj.onafterchanges(el, records);\n            }\n        }\n    \n        /**\n         * Strip tags\r\n         */\r\n        var stripScript = function(a) {\r\n            var b = new Option;\r\n            b.innerHTML = a;\r\n            var c = null;\r\n            for (a = b.getElementsByTagName('script'); c=a[0];) c.parentNode.removeChild(c);\r\n            return b.innerHTML;\r\n        }\r\n\n        /**\n         * Update cell content\n         * \n         * @param object cell\n         * @return void\n         */\n        obj.updateCell = function(x, y, value, force) {\n            // Changing value depending on the column type\n            if (obj.records[y][x].classList.contains('readonly') == true && ! force) {\n                // Do nothing\r\n                var record = {\r\n                    x: x,\r\n                    y: y,\r\n                    col: x,\r\n                    row: y\r\n                }\n            } else {\n                // Security\r\n                if ((''+value).substr(0,1) == '=' && obj.options.secureFormulas == true) {\r\n                    var val = secureFormula(value);\r\n                    if (val != value) {\r\n                        // Update the data container\r\n                        value = val;\r\n                    }\r\n                }\r\n\n                // On change\r\n                var val = obj.dispatch('onbeforechange', el, obj.records[y][x], x, y, value);\r\n\r\n                // If you return something this will overwrite the value\r\n                if (val != undefined) {\r\n                    value = val;\r\n                }\r\n\r\n                if (obj.options.columns[x].editor && typeof(obj.options.columns[x].editor.updateCell) == 'function') {\r\n                    value = obj.options.columns[x].editor.updateCell(obj.records[y][x], value, force);\r\n                }\r\n\n                // History format\n                var record = {\r\n                    x: x,\r\n                    y: y,\n                    col: x,\n                    row: y,\n                    newValue: value,\n                    oldValue: obj.options.data[y][x],\n                }\n\n                if (obj.options.columns[x].editor) {\n                    // Update data and cell\n                    obj.options.data[y][x] = value;\n                } else {\n                    // Native functions\n                    if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\n                        // Unchecked all options\n                        if (obj.options.columns[x].type == 'radio') {\n                            for (var j = 0; j < obj.options.data.length; j++) {\n                                obj.options.data[j][x] = false;\n                            }\n                        }\n\n                        // Update data and cell\n                        obj.records[y][x].children[0].checked = (value == 1 || value == true || value == 'true' || value == 'TRUE') ? true : false;\n                        obj.options.data[y][x] = obj.records[y][x].children[0].checked;\n                    } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\n                        // Update data and cell\n                        obj.options.data[y][x] = value;\n                        obj.records[y][x].innerText = obj.getDropDownValue(x, value);\n                    } else if (obj.options.columns[x].type == 'calendar') {\n                        // Update calendar\n                        var formatted = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format);\n                        // Update data and cell\n                        obj.options.data[y][x] = value;\n                        obj.records[y][x].innerText = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\n                    } else if (obj.options.columns[x].type == 'color') {\n                        // Update color\n                        obj.options.data[y][x] = value;\n                        // Render\n                        if (obj.options.columns[x].render == 'square') {\n                            var color = document.createElement('div');\n                            color.className = 'color';\n                            color.style.backgroundColor = value;\n                            obj.records[y][x].innerText = '';\n                            obj.records[y][x].appendChild(color);\n                        } else {\n                        obj.records[y][x].style.color = value;\n                            obj.records[y][x].innerText = value;\n                        }\r\n                    } else if (obj.options.columns[x].type == 'image') {\n                        value = ''+value;\n                        obj.options.data[y][x] = value;\n                        obj.records[y][x].innerHTML = '';\n                        if (value && value.substr(0, 10) == 'data:image') {\n                            var img = document.createElement('img');\n                            img.src = value;\n                            obj.records[y][x].appendChild(img);\n                        }\n                    } else {\n                        // Update data and cell\n                        obj.options.data[y][x] = value;\r\n                        // Label\n                        if (obj.options.columns[x].type == 'html') {\r\n                            obj.records[y][x].innerHTML = stripScript(obj.parseValue(x, y, value));\r\n                        } else {\r\n                            if (obj.options.stripHTML == true) {\n                                obj.records[y][x].innerText = obj.parseValue(x, y, value);\r\n                            } else {\r\n                                obj.records[y][x].innerHTML = stripScript(obj.parseValue(x, y, value));\r\n                            }\r\n                        }\n                        // Handle big text inside a cell\n                        if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\n                            obj.records[y][x].style.whiteSpace = 'pre-wrap';\n                        } else {\n                            obj.records[y][x].style.whiteSpace = '';\n                        }\n                    }\n                }\n\n                // Overflow\n                if (x > 0) {\n                    if (value) {\n                        obj.records[y][x-1].style.overflow = 'hidden';\n                    } else {\n                        obj.records[y][x-1].style.overflow = '';\n                    }\n                }\n\n                // On change\r\n                obj.dispatch('onchange', el, (obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null), x, y, value, record.oldValue);\n            }\n\n            return record;\n        }\n\n        /**\n         * Helper function to copy data using the corner icon\n         */\n        obj.copyData = function(o, d) {\n            // Get data from all selected cells\n            var data = obj.getData(true, true);\n\n            // Selected cells\n            var h = obj.selectedContainer;\n\n            // Cells\n            var x1 = parseInt(o.getAttribute('data-x'));\n            var y1 = parseInt(o.getAttribute('data-y'));\n            var x2 = parseInt(d.getAttribute('data-x'));\n            var y2 = parseInt(d.getAttribute('data-y'));\n\n            // Records\n            var records = [];\n            var breakControl = false;\n\r\n            if (h[0] == x1) {\r\n                // Vertical copy\r\n                if (y1 < h[1]) {\r\n                    var rowNumber = y1 - h[1];\r\n                } else {\r\n                    var rowNumber = 1;\r\n                }\r\n                var colNumber = 0;\r\n            } else {\r\n                if (x1 < h[0]) {\r\n                    var colNumber = x1 - h[0];\r\n                } else {\r\n                    var colNumber = 1;\r\n                }\r\n                var rowNumber = 0;\r\n            }\r\n\n            // Copy data procedure\n            var posx = 0;\n            var posy = 0;\n\r\n            for (var j = y1; j <= y2; j++) {\r\n                // Skip hidden rows\n                if (obj.rows[j] && obj.rows[j].style.display == 'none') {\n                    continue;\n                }\n\n                // Controls\n                if (data[posy] == undefined) {\n                    posy = 0;\n                }\n                posx = 0;\r\n\n                // Data columns\r\n                if (h[0] != x1) {\r\n                    if (x1 < h[0]) {\r\n                        var colNumber = x1 - h[0];\r\n                    } else {\r\n                        var colNumber = 1;\r\n                    }\r\n                }\n                // Data columns\n                for (var i = x1; i <= x2; i++) {\r\n                    // Update non-readonly\n                    if (obj.records[j][i] && ! obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\n                        // Stop if contains value\n                        if (! obj.selection.length) {\n                            if (obj.options.data[j][i] != '') {\n                                breakControl = true;\n                                continue;\n                            }\n                        }\n    \n                        // Column\n                        if (data[posy] == undefined) {\n                            posx = 0;\n                        } else if (data[posy][posx] == undefined) {\n                            posx = 0;\n                        }\r\n\r\n                        // Value\n                        var value = data[posy][posx];\n    \n                        if (value && ! data[1] && obj.options.autoIncrement == true) {\n                            if (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\r\n                                if ((''+value).substr(0,1) == '=') {\r\n                                    var tokens = value.match(/([A-Z]+[0-9]+)/g);\n    \n                                    if (tokens) {\n                                        var affectedTokens = [];\n                                        for (var index = 0; index < tokens.length; index++) {\n                                            var position = jexcel.getIdFromColumnName(tokens[index], 1);\n                                            position[0] += colNumber;\r\n                                            position[1] += rowNumber;\r\n                                            if (position[1] < 0) {\r\n                                                position[1] = 0;\r\n                                            }\n                                            var token = jexcel.getColumnNameFromId([position[0], position[1]]);\n    \n                                            if (token != tokens[index]) {\n                                                affectedTokens[tokens[index]] = token;\n                                            }\n                                        }\n                                        // Update formula\n                                        if (affectedTokens) {\n                                            value = obj.updateFormula(value, affectedTokens)\n                                        }\n                                    }\n                                } else {\n                                    if (value == Number(value)) {\n                                        value = Number(value) + rowNumber;\n                                    }\n                                }\n                            } else if (obj.options.columns[i].type == 'calendar') {\n                                var date = new Date(value);\n                                date.setDate(date.getDate() + rowNumber);\n                                value = date.getFullYear() + '-' + jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\n                            }\n                        }\n    \n                        records.push(obj.updateCell(i, j, value));\n    \n                        // Update all formulas in the chain\n                        obj.updateFormulaChain(i, j, records);\n                    }\n                    posx++;\r\n                    if (h[0] != x1) {\r\n                        colNumber++;\r\n                    }\n                }\n                posy++;\n                rowNumber++;\n            }\n    \n            // Update history\n            obj.setHistory({\n                action:'setValue',\n                records:records,\n                selection:obj.selectedCell,\n            });\n    \n            // Update table with custom configuration if applicable\n            obj.updateTable();\n    \n            // On after changes\n            obj.onafterchanges(el, records);\n        }\n    \n        /**\n         * Refresh current selection\n         */\n        obj.refreshSelection = function() {\n            if (obj.selectedCell) {\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            }\n        }\n    \n        /**\n         * Move coords to A1 in case ovelaps with an excluded cell\n         */\n        obj.conditionalSelectionUpdate = function(type, o, d) {\n            if (type == 1) {\n                if (obj.selectedCell && ((o >= obj.selectedCell[1] && o <= obj.selectedCell[3]) || (d >= obj.selectedCell[1] && d <= obj.selectedCell[3]))) {\n                    obj.resetSelection();\n                    return;\n                }\n            } else {\n                if (obj.selectedCell && ((o >= obj.selectedCell[0] && o <= obj.selectedCell[2]) || (d >= obj.selectedCell[0] && d <= obj.selectedCell[2]))) {\n                    obj.resetSelection();\n                    return;\n                }\n            }\n        }\n    \n        /**\n         * Clear table selection\n         */\n        obj.resetSelection = function(blur) {\n            // Remove style\n            if (! obj.highlighted.length) {\n                var previousStatus = 0;\n            } else {\n                var previousStatus = 1;\n    \n                for (var i = 0; i < obj.highlighted.length; i++) {\n                    obj.highlighted[i].classList.remove('highlight');\n                    obj.highlighted[i].classList.remove('highlight-left');\n                    obj.highlighted[i].classList.remove('highlight-right');\n                    obj.highlighted[i].classList.remove('highlight-top');\n                    obj.highlighted[i].classList.remove('highlight-bottom');\n                    obj.highlighted[i].classList.remove('highlight-selected');\n    \n                    var px = parseInt(obj.highlighted[i].getAttribute('data-x'));\n                    var py = parseInt(obj.highlighted[i].getAttribute('data-y'));\n    \n                    // Check for merged cells\n                    if (obj.highlighted[i].getAttribute('data-merged')) {\n                        var colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\n                        var rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\n                        var ux = colspan > 0 ? px + (colspan - 1) : px;\n                        var uy = rowspan > 0 ? py + (rowspan - 1): py;\n                    } else {\n                        var ux = px;\n                        var uy = py;\n                    }\n    \n                    // Remove selected from headers\n                    for (var j = px; j <= ux; j++) {\n                        if (obj.headers[j]) {\n                            obj.headers[j].classList.remove('selected');\n                        }\n                    }\n    \n                    // Remove selected from rows\n                    for (var j = py; j <= uy; j++) {\n                        if (obj.rows[j]) {\n                            obj.rows[j].classList.remove('selected');\n                        }\n                    }\n                }\n            }\n    \n            // Reset highlighed cells\n            obj.highlighted = [];\n    \n            // Reset\n            obj.selectedCell = null;\n    \n            // Hide corner\n            obj.corner.style.top = '-2000px';\n            obj.corner.style.left = '-2000px';\n    \n            if (blur == true && previousStatus == 1) {\r\n                obj.dispatch('onblur', el);\r\n            }\n    \n            return previousStatus;\n        }\n    \n        /**\n         * Update selection based on two cells\n         */\n        obj.updateSelection = function(el1, el2, origin) {\n            var x1 = el1.getAttribute('data-x');\n            var y1 = el1.getAttribute('data-y');\n            if (el2) {\n                var x2 = el2.getAttribute('data-x');\n                var y2 = el2.getAttribute('data-y');\n            } else {\n                var x2 = x1;\n                var y2 = y1;\n            }\n    \n            obj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\n        }\n    \n        /**\n         * Update selection from coords\n         */\n        obj.updateSelectionFromCoords = function(x1, y1, x2, y2, origin) {\n            // Reset Selection\n            var updated = null;\n            var previousState = obj.resetSelection();\n    \n            // Same element\n            if (x2 == null) {\n                x2 = x1;\n            }\n            if (y2 == null) {\n                y2 = y1;\n            }\n    \n            // Selection must be within the existing data\n            if (x1 >= obj.headers.length) {\n                x1 = obj.headers.length - 1;\n            }\n            if (y1 >= obj.rows.length) {\n                y1 = obj.rows.length - 1;\n            }\n            if (x2 >= obj.headers.length) {\n                x2 = obj.headers.length - 1;\n            }\n            if (y2 >= obj.rows.length) {\n                y2 = obj.rows.length - 1;\n            }\n    \n            // Keep selected cell\n            obj.selectedCell = [x1, y1, x2, y2];\n    \n            // Select cells\n            if (x1 != null) {\n                // Add selected cell\n                if (obj.records[y1][x1]) {\n                    obj.records[y1][x1].classList.add('highlight-selected');\n                }\n    \n                // Origin & Destination\n                if (parseInt(x1) < parseInt(x2)) {\n                    var px = parseInt(x1);\n                    var ux = parseInt(x2);\n                } else {\n                    var px = parseInt(x2);\n                    var ux = parseInt(x1);\n                }\n    \n                if (parseInt(y1) < parseInt(y2)) {\n                    var py = parseInt(y1);\n                    var uy = parseInt(y2);\n                } else {\n                    var py = parseInt(y2);\n                    var uy = parseInt(y1);\n                }\n    \n                // Verify merged columns\n                for (var i = px; i <= ux; i++) {\n                    for (var j = py; j <= uy; j++) {\n                        if (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\n                            var x = parseInt(obj.records[j][i].getAttribute('data-x'));\n                            var y = parseInt(obj.records[j][i].getAttribute('data-y'));\n                            var colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\n                            var rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\n    \n                            if (colspan > 1) {\n                                if (x < px) {\n                                    px = x;\n                                }\n                                if (x + colspan > ux) {\n                                    ux = x + colspan - 1;\n                                }\n                            }\n    \n                            if (rowspan) {\n                                if (y < py) {\n                                    py = y;\n    \n                                }\n                                if (y + rowspan > uy) {\n                                    uy = y + rowspan - 1;\n                                }\n                            }\n                        }\n                    }\n                }\n    \n                // Limits\n                var borderLeft = null;\n                var borderRight = null;\n                var borderTop = null;\n                var borderBottom = null;\n    \n                // Vertical limits\n                for (var j = py; j <= uy; j++) {\n                    if (obj.rows[j].style.display != 'none') {\n                        if (borderTop == null) {\n                            borderTop = j;\n                        }\n                        borderBottom = j;\n                    }\n                }\n    \n                // Redefining styles\n                for (var i = px; i <= ux; i++) {\n                    for (var j = py; j <= uy; j++) {\n                        if (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                            obj.records[j][i].classList.add('highlight');\n                            obj.highlighted.push(obj.records[j][i]);\n                        }\n                    }\n    \n                    // Horizontal limits\n                    if (obj.options.columns[i].type != 'hidden') {\n                        if (borderLeft == null) {\n                            borderLeft = i;\n                        }\n                        borderRight = i;\n                    }\n                }\n    \n                // Create borders\n                if (! borderLeft) {\n                    borderLeft = 0;\n                }\n                if (! borderRight) {\n                    borderRight = 0;\n                }\n                for (var i = borderLeft; i <= borderRight; i++) {\n                    if (obj.options.columns[i].type != 'hidden') {\n                        // Top border\n                        if (obj.records[borderTop][i]) {\n                            obj.records[borderTop][i].classList.add('highlight-top');\n                        }\n                        // Bottom border\n                        if (obj.records[borderBottom][i]) {\n                            obj.records[borderBottom][i].classList.add('highlight-bottom');\n                        }\n                        // Add selected from headers\n                        obj.headers[i].classList.add('selected');\n                    }\n                }\n    \n                for (var j = borderTop; j <= borderBottom; j++) {\n                    if (obj.rows[j].style.display != 'none') {\n                        // Left border\n                        obj.records[j][borderLeft].classList.add('highlight-left');\n                        // Right border\n                        obj.records[j][borderRight].classList.add('highlight-right');\n                        // Add selected from rows\n                        obj.rows[j].classList.add('selected');\n                    }\n                }\n    \n                obj.selectedContainer = [ borderLeft, borderTop, borderRight, borderBottom ];\n            }\n    \n            // Handle events\r\n            if (previousState == 0) {\r\n                obj.dispatch('onfocus', el);\r\n\r\n                obj.removeCopyingSelection();\n            }\n\r\n            obj.dispatch('onselection', el, borderLeft, borderTop, borderRight, borderBottom, origin);\r\n\r\n            // Find corner cell\n            obj.updateCornerPosition();\n        }\n    \n        /**\n         * Remove copy selection\n         * \n         * @return void\n         */\n        obj.removeCopySelection = function() {\n            // Remove current selection\n            for (var i = 0; i < obj.selection.length; i++) {\n                obj.selection[i].classList.remove('selection');\n                obj.selection[i].classList.remove('selection-left');\n                obj.selection[i].classList.remove('selection-right');\n                obj.selection[i].classList.remove('selection-top');\n                obj.selection[i].classList.remove('selection-bottom');\n            }\n    \n            obj.selection = [];\n        }\n    \n        /**\n         * Update copy selection\n         * \n         * @param int x, y\n         * @return void\n         */\n        obj.updateCopySelection = function(x3, y3) {\n            // Remove selection\n            obj.removeCopySelection();\n    \n            // Get elements first and last\n            var x1 = obj.selectedContainer[0];\n            var y1 = obj.selectedContainer[1];\n            var x2 = obj.selectedContainer[2];\n            var y2 = obj.selectedContainer[3];\n    \n            if (x3 != null && y3 != null) {\n                if (x3 - x2 > 0) {\n                    var px = parseInt(x2) + 1;\n                    var ux = parseInt(x3);\n                } else {\n                    var px = parseInt(x3);\n                    var ux = parseInt(x1) - 1;\n                }\n    \n                if (y3 - y2 > 0) {\n                    var py = parseInt(y2) + 1;\n                    var uy = parseInt(y3);\n                } else {\n                    var py = parseInt(y3);\n                    var uy = parseInt(y1) - 1;\n                }\n    \n                if (ux - px <= uy - py) {\n                    var px = parseInt(x1);\n                    var ux = parseInt(x2);\n                } else {\n                    var py = parseInt(y1);\n                    var uy = parseInt(y2);\n                }\n    \n                for (var j = py; j <= uy; j++) {\n                    for (var i = px; i <= ux; i++) {\n                        if (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\n                            obj.records[j][i].classList.add('selection');\n                            obj.records[py][i].classList.add('selection-top');\n                            obj.records[uy][i].classList.add('selection-bottom');\n                            obj.records[j][px].classList.add('selection-left');\n                            obj.records[j][ux].classList.add('selection-right');\n    \n                            // Persist selected elements\n                            obj.selection.push(obj.records[j][i]);\n                        }\n                    }\n                }\n            }\n        }\n    \n        /**\n         * Update corner position\n         * \n         * @return void\n         */\n        obj.updateCornerPosition = function() {\n            // If any selected cells\n            if (! obj.highlighted.length) {\n                obj.corner.style.top = '-2000px';\n                obj.corner.style.left = '-2000px';\n            } else {\r\n                // Get last cell\r\n                var last = obj.highlighted[obj.highlighted.length-1];\r\n\n                const contentRect = obj.content.getBoundingClientRect();\n                var x1 = contentRect.left;\n                var y1 = contentRect.top;\n\r\n                const lastRect = last.getBoundingClientRect();\n                var x2 = lastRect.left;\n                var y2 = lastRect.top;\n                var w2 = lastRect.width;\n                var h2 = lastRect.height;\n\n                var x = (x2 - x1) + obj.content.scrollLeft + w2 - 4;\n                var y = (y2 - y1) + obj.content.scrollTop + h2 - 4;\n\n                // Place the corner in the correct place\n                obj.corner.style.top = y + 'px';\n                obj.corner.style.left = x + 'px';\r\n\r\n                if (obj.options.freezeColumns) {\r\n                    var width = obj.getFreezeWidth();\r\n                    if (x2 - x1 + w2 < width) {\r\n                        obj.corner.style.display = 'none';\r\n                    } else {\r\n                        obj.corner.style.display = '';\r\n                    }\r\n                } else {\r\n                    obj.corner.style.display = '';\r\n                }\n            }\n        }\n    \n        /**\n         * Update scroll position based on the selection\n         */\n        obj.updateScroll = function(direction) {\n            // jExcel Container information\n            const contentRect = obj.content.getBoundingClientRect();\r\n            var x1 = contentRect.left;\r\n            var y1 = contentRect.top;\r\n            var w1 = contentRect.width;\r\n            var h1 = contentRect.height;\r\n\n            // Direction Left or Up\n            var reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]];\n    \n            // Reference\r\n            const referenceRect = reference.getBoundingClientRect();\r\n            var x2 = referenceRect.left;\r\n            var y2 = referenceRect.top;\r\n            var w2 = referenceRect.width;\r\n            var h2 = referenceRect.height;\n    \n            // Direction\n            if (direction == 0 || direction == 1) {\n                var x = (x2 - x1) + obj.content.scrollLeft;\n                var y = (y2 - y1) + obj.content.scrollTop - 2;\n            } else {\n                var x = (x2 - x1) + obj.content.scrollLeft + w2;\n                var y = (y2 - y1) + obj.content.scrollTop + h2;\n            }\n    \n            // Top position check\n            if (y > (obj.content.scrollTop + 30) && y < (obj.content.scrollTop + h1)) {\n                // In the viewport\n            } else {\n                // Out of viewport\n                if (y < obj.content.scrollTop + 30) {\n                    obj.content.scrollTop = y - h2;\n                } else {\n                    obj.content.scrollTop = y - (h1 - 2);\n                }\n            }\n    \r\n            // Freeze columns? \r\n            var freezed = obj.getFreezeWidth();\r\n\n            // Left position check - TODO: change that to the bottom border of the element\n            if (x > (obj.content.scrollLeft + freezed) && x < (obj.content.scrollLeft + w1)) {\n                // In the viewport\n            } else {\n                // Out of viewport\n                if (x < obj.content.scrollLeft + 30) {\n                    obj.content.scrollLeft = x;\n                    if (obj.content.scrollLeft < 50) {\n                        obj.content.scrollLeft = 0;\n                    }\r\n                } else if (x < obj.content.scrollLeft + freezed) {\r\n                    obj.content.scrollLeft = x - freezed - 1;\n                } else {\n                    obj.content.scrollLeft = x - (w1 - 20);\n                }\n            }\n        }\n    \n        /**\n         * Get the column width\n         * \n         * @param int column column number (first column is: 0)\n         * @return int current width\n         */\n        obj.getWidth = function(column) {\n            if (! column) {\n                // Get all headers\n                var data = [];\n                for (var i = 0; i < obj.headers.length; i++) {\n                    data.push(obj.options.columns[i].width);\n                }\n            } else {\n                // In case the column is an object\n                if (typeof(column) == 'object') {\n                    column = $(column).getAttribute('data-x');\n                }\n    \n                data = obj.colgroup[column].getAttribute('width')\n            }\n    \n            return data;\n        }\n\r\n\r\n        /**\r\n         * Set the column width\r\n         * \r\n         * @param int column number (first column is: 0)\r\n         * @param int new column width\r\n         * @param int old column width\r\n         */\r\n        obj.setWidth = function (column, width, oldWidth) {\r\n            if (width) {\r\n                if (Array.isArray(column)) {\r\n                    // Oldwidth\r\n                    if (! oldWidth) {\r\n                        var oldWidth = [];\r\n                    }\r\n                    // Set width\r\n                    for (var i = 0; i < column.length; i++) {\r\n                        if (! oldWidth[i]) {\r\n                            oldWidth[i] = obj.colgroup[column[i]].getAttribute('width');\r\n                        }\r\n                        var w = Array.isArray(width) && width[i] ? width[i] : width;\r\n                        obj.colgroup[column[i]].setAttribute('width', w);\r\n                        obj.options.columns[column[i]].width = w;\r\n                    }\r\n                } else {\r\n                    // Oldwidth\r\n                    if (! oldWidth) {\r\n                        oldWidth = obj.colgroup[column].getAttribute('width');\r\n                    }\r\n                    // Set width\r\n                    obj.colgroup[column].setAttribute('width', width);\r\n                    obj.options.columns[column].width = width;\r\n                }\r\n\r\n                // Keeping history of changes\r\n                obj.setHistory({\r\n                    action:'setWidth',\r\n                    column:column,\r\n                    oldValue:oldWidth,\r\n                    newValue:width,\r\n                });\r\n\r\n                // On resize column\r\n                obj.dispatch('onresizecolumn', el, column, width, oldWidth);\r\n\r\n                // Update corner position\r\n                obj.updateCornerPosition();\r\n            }\r\n        }\r\n\n        /**\n         * Set the row height\n         * \n         * @param row - row number (first row is: 0)\n         * @param height - new row height\n         * @param oldHeight - old row height\n         */\n        obj.setHeight = function (row, height, oldHeight) {\n            if (height > 0) {\n                // In case the column is an object\n                if (typeof(row) == 'object') {\n                    row = row.getAttribute('data-y');\n                }\n    \n                // Oldwidth\r\n                if (! oldHeight) {\r\n                    oldHeight = obj.rows[row].getAttribute('height');\r\n\r\n                    if (! oldHeight) {\r\n                        var rect = obj.rows[row].getBoundingClientRect();\r\n                        oldHeight = rect.height;\r\n                    }\r\n                }\r\n\r\n                // Integer\r\n                height = parseInt(height);\r\n\n                // Set width\n                obj.rows[row].style.height = height + 'px';\n    \n                // Keep options updated\n                if (! obj.options.rows[row]) {\n                    obj.options.rows[row] = {};\n                }\n                obj.options.rows[row].height = height;\n    \n                // Keeping history of changes\n                obj.setHistory({\n                    action:'setHeight',\n                    row:row,\n                    oldValue:oldHeight,\n                    newValue:height,\n                });\n\n                // On resize column\r\n                obj.dispatch('onresizerow', el, row, height, oldHeight);\n\n                // Update corner position\n                obj.updateCornerPosition();\n            }\n        }\n    \n        /**\n         * Get the row height\n         * \n         * @param row - row number (first row is: 0)\n         * @return height - current row height\n         */\n        obj.getHeight = function(row) {\n            if (! row) {\n                // Get height of all rows\n                var data = [];\n                for (var j = 0; j < obj.rows.length; j++) {\n                    var h = obj.rows[j].style.height;\n                    if (h) {\n                        data[j] = h;\n                    }\n                }\n            } else {\n                // In case the row is an object\n                if (typeof(row) == 'object') {\n                    row = $(row).getAttribute('data-y');\n                }\n    \n                var data = obj.rows[row].style.height;\n            }\n    \n            return data;\n        }\n    \r\n        obj.setFooter = function(data) {\r\n            if (data) {\r\n                obj.options.footers = data;\r\n            }\r\n\r\n            if (obj.options.footers) {\r\n                if (! obj.tfoot) {\r\n                    obj.tfoot = document.createElement('tfoot');\r\n                    obj.table.appendChild(obj.tfoot);\r\n                } \r\n\r\n                for (var j = 0; j < obj.options.footers.length; j++) {\r\n                    if (obj.tfoot.children[j]) {\r\n                        var tr = obj.tfoot.children[j];\r\n                    } else {\r\n                        var tr = document.createElement('tr');\r\n                        var td = document.createElement('td');\r\n                        tr.appendChild(td);\r\n                        obj.tfoot.appendChild(tr);\r\n                    }\r\n                    for (var i = 0; i < obj.headers.length; i++) {\r\n                        if (! obj.options.footers[j][i]) {\r\n                            obj.options.footers[j][i] = '';\r\n                        }\r\n                        if (obj.tfoot.children[j].children[i+1]) {\r\n                            var td = obj.tfoot.children[j].children[i+1];\r\n                        } else {\r\n                            var td = document.createElement('td');\r\n                            tr.appendChild(td);\r\n\r\n                            // Text align\r\n                            var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\r\n                            td.style.textAlign = colAlign;\r\n                        }\r\n                        td.innerText = obj.parseValue(i, j, obj.options.footers[j][i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\n        /**\n         * Get the column title\n         * \n         * @param column - column number (first column is: 0)\n         * @param title - new column title\n         */\n        obj.getHeader = function(column) {\n            return obj.headers[column].innerText;\n        }\n    \n        /**\n         * Set the column title\n         * \n         * @param column - column number (first column is: 0)\n         * @param title - new column title\n         */\n        obj.setHeader = function(column, newValue) {\n            if (obj.headers[column]) {\n                var oldValue = obj.headers[column].innerText;\n    \n                if (! newValue) {\n                    newValue = prompt(obj.options.text.columnName, oldValue)\n                }\n    \n                if (newValue) {\n                    obj.headers[column].innerText = newValue;\r\n                    // Keep the title property\r\n                    obj.headers[column].setAttribute('title', newValue);\r\n                    // Update title\r\n                    obj.options.columns[column].title = newValue;\n                }\n    \n                obj.setHistory({\n                    action: 'setHeader',\n                    column: column,\n                    oldValue: oldValue,\n                    newValue: newValue\n                });\n    \n                // On onchange header\r\n                obj.dispatch('onchangeheader', el, column, oldValue, newValue);\r\n            }\n        }\n    \n        /**\n         * Get the headers\n         * \n         * @param asArray\n         * @return mixed\n         */\n        obj.getHeaders = function (asArray) {\n            var title = [];\n    \n            for (var i = 0; i < obj.headers.length; i++) {\n                title.push(obj.getHeader(i));\n            }\n    \n            return asArray ? title : title.join(obj.options.csvDelimiter);\n        }\n    \n        /**\n         * Get meta information from cell(s)\n         * \n         * @return integer\n         */\n        obj.getMeta = function(cell, key) {\n            if (! cell) {\n                return obj.options.meta;\n            } else {\n                if (key) {\n                    return obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\n                } else {\n                    return obj.options.meta[cell] ? obj.options.meta[cell] : null;\n                }\n            }\n        }\n    \n        /**\n         * Set meta information to cell(s)\n         * \n         * @return integer\n         */\n        obj.setMeta = function(o, k, v) {\n            if (! obj.options.meta) {\n                obj.options.meta = {}\n            }\n    \n            if (k && v) {\n                // Set data value\n                if (! obj.options.meta[o]) {\n                    obj.options.meta[o] = {};\n                }\n                obj.options.meta[o][k] = v;\n            } else {\n                // Apply that for all cells\n                var keys = Object.keys(o);\n                for (var i = 0; i < keys.length; i++) {\n                    if (! obj.options.meta[keys[i]]) {\n                        obj.options.meta[keys[i]] = {};\n                    }\n    \n                    var prop = Object.keys(o[keys[i]]);\n                    for (var j = 0; j < prop.length; j++) {\n                        obj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\n                    }\n                }\n            }\n    \r\n            obj.dispatch('onchangemeta', el, o, k, v);\n        }\n    \n        /**\n         * Update meta information\n         * \n         * @return integer\n         */\n        obj.updateMeta = function(affectedCells) {\n            if (obj.options.meta) {\n                var newMeta = {};\n                var keys = Object.keys(obj.options.meta);\n                for (var i = 0; i < keys.length; i++) {\n                    if (affectedCells[keys[i]]) {\n                        newMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\n                    } else {\n                        newMeta[keys[i]] = obj.options.meta[keys[i]];\n                    }\n                }\n                // Update meta information\n                obj.options.meta = newMeta;\n            }\n        }\n    \n        /**\n         * Get style information from cell(s)\n         * \n         * @return integer\n         */\n        obj.getStyle = function(cell, key) {\n            // Cell\n            if (! cell) {\n                // Control vars\n                var data = {};\n    \n                // Column and row length\n                var x = obj.options.data[0].length;\n                var y = obj.options.data.length;\n    \n                // Go through the columns to get the data\n                for (var j = 0; j < y; j++) {\n                    for (var i = 0; i < x; i++) {\n                        // Value\n                        var v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style');\n    \n                        // Any meta data for this column?\n                        if (v) {\n                            // Column name\n                            var k = jexcel.getColumnNameFromId([i, j]);\n                            // Value\n                            data[k] = v;\n                        }\n                    }\n                }\n    \n               return data;\n            } else {\n                cell = jexcel.getIdFromColumnName(cell, true);\n    \n                return key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\n            }\n        },\n    \n        obj.resetStyle = function(o, ignoreHistoryAndEvents) {\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i++) {\n                // Position\n                var cell = jexcel.getIdFromColumnName(keys[i], true);\n                if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                    obj.records[cell[1]][cell[0]].setAttribute('style', '');\n                }\n            }\n            obj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\n        }\n    \n        /**\n         * Set meta information to cell(s)\n         * \n         * @return integer\n         */\n        obj.setStyle = function(o, k, v, force, ignoreHistoryAndEvents) {\n            var newValue = {};\n            var oldValue = {};\n    \n            // Apply style\n            var applyStyle = function(cellId, key, value) {\n                // Position\n                var cell = jexcel.getIdFromColumnName(cellId, true);\n    \n                if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\n                    // Current value\n                    var currentValue = obj.records[cell[1]][cell[0]].style[key];\n    \n                    // Change layout\n                    if (currentValue == value && ! force) {\n                        value = '';\n                        obj.records[cell[1]][cell[0]].style[key] = '';\n                    } else {\n                        obj.records[cell[1]][cell[0]].style[key] = value;\n                    }\n    \n                    // History\n                    if (! oldValue[cellId]) {\n                        oldValue[cellId] = [];\n                    }\n                    if (! newValue[cellId]) {\n                        newValue[cellId] = [];\n                    }\n    \n                    oldValue[cellId].push([key + ':' + currentValue]);\n                    newValue[cellId].push([key + ':' + value]);\n                }\n            }\n    \n            if (k && v) {\n                // Get object from string\n                if (typeof(o) == 'string') {\n                    applyStyle(o, k, v);\n                } else {\n                    // Avoid duplications\n                    var oneApplication = [];\n                    // Apply that for all cells\n                    for (var i = 0; i < o.length; i++) {\n                        var x = o[i].getAttribute('data-x');\n                        var y = o[i].getAttribute('data-y');\n                        var cellName = jexcel.getColumnNameFromId([x, y]);\n                        // This happens when is a merged cell\n                        if (! oneApplication[cellName]) {\n                            applyStyle(cellName, k, v);\n                            oneApplication[cellName] = true;\n                        }\n                    }\n                }\n            } else {\n                var keys = Object.keys(o);\n                for (var i = 0; i < keys.length; i++) {\n                    var style = o[keys[i]];\n                    if (typeof(style) == 'string') {\n                        style = style.split(';');\n                    }\n                    for (var j = 0; j < style.length; j++) {\n                        if (typeof(style[j]) == 'string') {\n                            style[j] = style[j].split(':');\n                        }\n                        // Apply value\n                        if (style[j][0].trim()) {\n                            applyStyle(keys[i], style[j][0].trim(), style[j][1]);\n                        }\n                    }\n                }\n            }\n    \n            var keys = Object.keys(oldValue);\n            for (var i = 0; i < keys.length; i++) {\n                oldValue[keys[i]] = oldValue[keys[i]].join(';');\n            }\n            var keys = Object.keys(newValue);\n            for (var i = 0; i < keys.length; i++) {\n                newValue[keys[i]] = newValue[keys[i]].join(';');\n            }\n    \n            if (! ignoreHistoryAndEvents) {\n                // Keeping history of changes\n                obj.setHistory({\n                    action: 'setStyle',\n                    oldValue: oldValue,\n                    newValue: newValue,\n                });\n            }\n\r\n            obj.dispatch('onchangestyle', el, o, k, v);\r\n        }\n\n        /**\n         * Get cell comments, null cell for all\r\n         */\n        obj.getComments = function(cell, withAuthor) {\r\n            if (cell) {\n                if (typeof(cell) == 'string') {\n                    var cell = jexcel.getIdFromColumnName(cell, true);\n                }\n\n                if (withAuthor) {\n                    return [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\n                } else {\n                    return obj.records[cell[1]][cell[0]].getAttribute('title') || '';\n                }\r\n            } else {\r\n                var data = {};\r\n                for (var j = 0; j < obj.options.data.length; j++) {\r\n                    for (var i = 0; i < obj.options.columns.length; i++) {\r\n                        var comments = obj.records[j][i].getAttribute('title');\r\n                        if (comments) {\r\n                            var cell = jexcel.getColumnNameFromId([i, j]);\r\n                            data[cell] = comments;\r\n                        }\r\n                    }\r\n                }\r\n                return data;\r\n            }\n        }\n\n        /**\n         * Set cell comments\n         */\n        obj.setComments = function(cellId, comments, author) {\n            if (typeof(cellId) == 'string') {\n                var cell = jexcel.getIdFromColumnName(cellId, true);\n            } else {\n                var cell = cellId;\n            }\n    \n            // Keep old value\n            var title = obj.records[cell[1]][cell[0]].getAttribute('title');\n            var author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\n            var oldValue = [ title, author ];\n    \n            // Set new values\n            obj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\n            obj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : '');\n    \n            // Remove class if there is no comment\n            if (comments) {\n                obj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\n            } else {\n                obj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\n            }\n    \n            // Save history\n            obj.setHistory({\n                action:'setComments',\n                column: cellId,\n                newValue: [ comments, author ],\n                oldValue: oldValue,\n            });\n        }\n    \n        /**\n         * Get table config information\n         */\n        obj.getConfig = function() {\n            var options = obj.options;\n            options.style = obj.getStyle();\n            options.mergeCells = obj.getMerge();\r\n            options.comments = obj.getComments();\n    \n            return options;\n        }\n    \n        /**\n         * Sort data and reload table\n         */\n        obj.orderBy = function(column, order) {\n            if (column >= 0) {\n                // Merged cells\n                if (Object.keys(obj.options.mergeCells).length > 0) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        // Remove merged cells\n                        obj.destroyMerged();\n                    }\n                }\n    \n                // Direction\n                if (order == null) {\n                    order = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\n                } else {\n                    order = order ? 1 : 0;\n                }\n    \n                // Filter\n                Array.prototype.orderBy = function(p, o) {\n                    return this.slice(0).sort(function(a, b) {\n                        var valueA = a[p];\r\n                        var valueB = b[p];\r\n    \n                        if (! o) {\n                            return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? 1 : (valueA < valueB) ? -1 :  0;\n                        } else {\n                            return (valueA == '' && valueB != '') ? 1 : (valueA != '' && valueB == '') ? -1 : (valueA > valueB) ? -1 : (valueA < valueB) ? 1 :  0;\n                        }\n                    });\n                }\n    \n                // Test order\n                var temp = [];\n                if (obj.options.columns[column].type == 'number' || obj.options.columns[column].type == 'percentage' || obj.options.columns[column].type == 'autonumber' || obj.options.columns[column].type == 'color') {\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        temp[j] = [ j, Number(obj.options.data[j][column]) ];\r\n                    }\r\n                } else if (obj.options.columns[column].type == 'calendar' || obj.options.columns[column].type == 'checkbox' || obj.options.columns[column].type == 'radio') {\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\n                        temp[j] = [ j, obj.options.data[j][column] ];\n                    }\n                } else {\n                    for (var j = 0; j < obj.options.data.length; j++) {\n                        temp[j] = [ j, obj.records[j][column].innerText.toLowerCase() ];\r\n                    }\n                }\n                temp = temp.orderBy(1, order);\n    \n                // Save history\n                var newValue = [];\n                for (var j = 0; j < temp.length; j++) {\n                    newValue[j] = temp[j][0];\n                }\n    \n                // Save history\n                obj.setHistory({\n                    action: 'orderBy',\n                    rows: newValue,\n                    column: column,\n                    order: order,\n                });\n    \n                // Update order\n                obj.updateOrderArrow(column, order);\n                obj.updateOrder(newValue);\n    \n                // On sort event\r\n                obj.dispatch('onsort', el, column, order);\n    \n                return true;\n            }\n        }\n    \n        /**\n         * Update order arrow\n         */\n        obj.updateOrderArrow = function(column, order) {\n            // Remove order\n            for (var i = 0; i < obj.headers.length; i++) {\n                obj.headers[i].classList.remove('arrow-up');\n                obj.headers[i].classList.remove('arrow-down');\n            }\n    \n            // No order specified then toggle order\n            if (order) {\n                obj.headers[column].classList.add('arrow-up');\n            } else {\n                obj.headers[column].classList.add('arrow-down');\n            }\n        }\n    \n        /**\n         * Update rows position\n         */\n        obj.updateOrder = function(rows) {\n            // History\n            var data = []\n            for (var j = 0; j < rows.length; j++) {\n                data[j] = obj.options.data[rows[j]];\n            }\n            obj.options.data = data;\n    \n            var data = []\n            for (var j = 0; j < rows.length; j++) {\n                data[j] = obj.records[rows[j]];\n            }\n            obj.records = data;\n    \n            var data = []\n            for (var j = 0; j < rows.length; j++) {\n                data[j] = obj.rows[rows[j]];\n            }\n            obj.rows = data;\n    \n            // Update references\n            obj.updateTableReferences();\n    \n            // Redo search\n            if (obj.results && obj.results.length) {\r\n                if (obj.searchInput.value) {\n                    obj.search(obj.searchInput.value);\r\n                } else {\r\n                    obj.closeFilter();\r\n                }\n            } else {\n                // Create page\n                obj.results = null;\n                obj.pageNumber = 0;\n    \n                if (obj.options.pagination > 0) {\n                    obj.page(0);\n                } else if (obj.options.lazyLoading == true) {\n                    obj.loadPage(0);\n                } else {\n                    for (var j = 0; j < obj.rows.length; j++) {\n                        obj.tbody.appendChild(obj.rows[j]);\n                    }\n                }\n            }\n        }\n    \n        /**\n         * Move row\n         * \n         * @return void\n         */\n        obj.moveRow = function(o, d, ignoreDom) {\n            if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                if (o > d) {\r\n                    var insertBefore = 1;\r\n                } else {\r\n                    var insertBefore = 0;\r\n                }\r\n\n                if (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n    \n            if (obj.options.search == true) {\n                if (obj.results && obj.results.length != obj.rows.length) {\n                    if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                        obj.resetSearch();\n                    } else {\n                        return false;\n                    }\n                }\n    \n                obj.results = null;\n            }\n    \n            if (! ignoreDom) {\n                if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\n                    if (o > d) {\n                        obj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\n                    } else {\n                        obj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\n                    }\n                } else {\n                    obj.tbody.removeChild(obj.rows[o]);\n                }\n            }\n    \n            // Place references in the correct position\n            obj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\n            obj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\n            obj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]);\n    \n            // Respect pagination\n            if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n                obj.page(obj.pageNumber);\n            }\n    \n            // Keeping history of changes\n            obj.setHistory({\n                action:'moveRow',\n                oldValue: o,\n                newValue: d,\n            });\n    \n            // Update table references\n            obj.updateTableReferences();\n    \n            // Events\r\n            obj.dispatch('onmoverow', el, o, d);\r\n        }\n\n        /**\n         * Insert a new row\n         * \n         * @param mixed - number of blank lines to be insert or a single array with the data of the new row\n         * @param rowNumber\n         * @param insertBefore\n         * @return void\n         */\n        obj.insertRow = function(mixed, rowNumber, insertBefore) {\n            // Configuration\n            if (obj.options.allowInsertRow == true) {\n                // Records\n                var records = [];\n    \n                // Data to be insert\n                var data = [];\n    \n                // The insert could be lead by number of rows or the array of data\n                if (mixed > 0) {\n                    var numOfRows = mixed;\n                } else {\n                    var numOfRows = 1;\n    \n                    if (mixed) {\n                        data = mixed;\n                    }\n                }\n    \n                // Direction\n                var insertBefore = insertBefore ? true : false;\n    \n                // Current column number\n                var lastRow = obj.options.data.length - 1;\n    \r\n                if (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\n                    rowNumber = lastRow;\n                }\n    \n                // Onbeforeinsertrow\r\n                if (obj.dispatch('onbeforeinsertrow', el, rowNumber, numOfRows, insertBefore) === false) {\n                    console.log('onbeforeinsertrow returned false');\n\n                    return false;\n                }\n    \n                // Merged cells\n                if (Object.keys(obj.options.mergeCells).length > 0) {\n                    if (obj.isRowMerged(rowNumber, insertBefore).length) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n                }\n    \n                // Clear any search\n                if (obj.options.search == true) {\n                    if (obj.results && obj.results.length != obj.rows.length) {\n                        if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                            obj.resetSearch();\n                        } else {\n                            return false;\n                        }\n                    }\n    \n                    obj.results = null;\n                }\n    \n                // Insertbefore\n                var rowIndex = (! insertBefore) ? rowNumber + 1 : rowNumber;\n\n                // Keep the current data\n                var currentRecords = obj.records.splice(rowIndex);\n                var currentData = obj.options.data.splice(rowIndex);\n                var currentRows = obj.rows.splice(rowIndex);\n    \r\n                // Adding lines\n                var rowRecords = [];\n                var rowData = [];\n                var rowNode = [];\n\n                for (var row = rowIndex; row < (numOfRows + rowIndex); row++) {\r\n                    // Push data to the data container\n                    obj.options.data[row] = [];\n                    for (var col = 0; col < obj.options.columns.length; col++) {\n                        obj.options.data[row][col]  = data[col] ? data[col] : '';\n                    }\n                    // Create row\n                    var tr = obj.createRow(row, obj.options.data[row]);\r\n                    // Append node\r\n                    if (currentRows[0]) {\r\n                        if (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\r\n                            obj.tbody.insertBefore(tr, currentRows[0]);\r\n                        }\r\n                    } else {\r\n                        if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\r\n                            obj.tbody.appendChild(tr);\r\n                        }\r\n                    }\n                    // Record History\n                    rowRecords.push(obj.records[row]);\n                    rowData.push(obj.options.data[row]);\n                    rowNode.push(tr);\n                }\n    \n                // Copy the data back to the main data\n                Array.prototype.push.apply(obj.records, currentRecords);\n                Array.prototype.push.apply(obj.options.data, currentData);\n                Array.prototype.push.apply(obj.rows, currentRows);\n    \n                // Respect pagination\n                if (obj.options.pagination > 0) {\n                    obj.page(obj.pageNumber);\n                }\n    \n                // Keep history\n                obj.setHistory({\n                    action: 'insertRow',\n                    rowNumber: rowNumber,\n                    numOfRows: numOfRows,\n                    insertBefore: insertBefore,\n                    rowRecords: rowRecords,\n                    rowData: rowData,\n                    rowNode: rowNode,\n                });\n    \n                // Remove table references\n                obj.updateTableReferences();\n    \n                // Events\r\n                obj.dispatch('oninsertrow', el, rowNumber, numOfRows, rowRecords, insertBefore);\n            }\n        }\n    \n        /**\n         * Delete a row by number\n         * \n         * @param integer rowNumber - row number to be excluded\n         * @param integer numOfRows - number of lines\n         * @return void\n         */\n        obj.deleteRow = function(rowNumber, numOfRows) {\n            // Global Configuration\n            if (obj.options.allowDeleteRow == true) {\n                if (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\n                    // Delete row definitions\n                    if (rowNumber == undefined) {\n                        var number = obj.getSelectedRows();\n    \n                        if (! number[0]) {\n                            rowNumber = obj.options.data.length - 1;\n                            numOfRows = 1;\n                        } else {\n                            rowNumber = parseInt(number[0].getAttribute('data-y'));\n                            numOfRows = number.length;\n                        }\n                    }\n    \n                    // Last column\n                    var lastRow = obj.options.data.length - 1;\n    \n                    if (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\n                        rowNumber = lastRow;\n                    }\n    \n                    if (! numOfRows) {\n                        numOfRows = 1;\n                    }\n    \n                    // Do not delete more than the number of recoreds\n                    if (rowNumber + numOfRows >= obj.options.data.length) {\n                        numOfRows = obj.options.data.length - rowNumber;\n                    }\n\n                    // Onbeforedeleterow\n                    if (obj.dispatch('onbeforedeleterow', el, rowNumber, numOfRows) === false) {\n                        console.log('onbeforedeleterow returned false');\n                        return false;\n                    }\n    \n                    if (parseInt(rowNumber) > -1) {\n                        // Merged cells\n                        var mergeExists = false;\n                        if (Object.keys(obj.options.mergeCells).length > 0) {\n                            for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                                if (obj.isRowMerged(row, false).length) {\n                                    mergeExists = true;\n                                }\n                            }\n                        }\n                        if (mergeExists) {\n                            if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                                return false;\n                            } else {\n                                obj.destroyMerged();\n                            }\n                        }\n    \n                        // Clear any search\n                        if (obj.options.search == true) {\n                            if (obj.results && obj.results.length != obj.rows.length) {\n                                if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\n                                    obj.resetSearch();\n                                } else {\n                                    return false;\n                                }\n                            }\n    \n                            obj.results = null;\n                        }\n    \n                        // Remove node\n                        for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\n                            if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\n                                obj.rows[row].className = '';\n                                obj.rows[row].parentNode.removeChild(obj.rows[row]);\n                            }\n                        }\n    \n                        // Remove data\n                        var rowRecords = obj.records.splice(rowNumber, numOfRows);\n                        var rowData = obj.options.data.splice(rowNumber, numOfRows);\n                        var rowNode = obj.rows.splice(rowNumber, numOfRows);\n    \n                        // Respect pagination\n                        if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\n                            obj.page(obj.pageNumber);\n                        }\n    \n                        // Remove selection\n                        obj.conditionalSelectionUpdate(1, rowNumber, (rowNumber + numOfRows) - 1);\n    \n                        // Keep history\n                        obj.setHistory({\n                            action: 'deleteRow',\n                            rowNumber: rowNumber,\n                            numOfRows: numOfRows,\n                            insertBefore: 1,\n                            rowRecords: rowRecords,\n                            rowData: rowData,\n                            rowNode: rowNode\n                        });\n    \n                        // Remove table references\n                        obj.updateTableReferences();\n    \n                        // Events\r\n                        obj.dispatch('ondeleterow', el, rowNumber, numOfRows, rowRecords);\n                    }\n                } else {\n                    console.error('JEXCEL. It is not possible to delete the last row');\n                }\n            }\n        }\n    \n    \n        /**\n         * Move column\n         * \n         * @return void\n         */\n        obj.moveColumn = function(o, d) {\n            if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                if (o > d) {\r\n                    var insertBefore = 1;\r\n                } else {\r\n                    var insertBefore = 0;\r\n                }\r\n\n                if (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                        return false;\n                    } else {\n                        obj.destroyMerged();\n                    }\n                }\n            }\n    \n            var o = parseInt(o);\n            var d = parseInt(d);\n    \n            if (o > d) {\n                obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\n                obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\n    \n                for (var j = 0; j < obj.rows.length; j++) {\n                    obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\n                }\n            } else {\n                obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\n                obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\n    \n                for (var j = 0; j < obj.rows.length; j++) {\n                    obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\n                }\n            }\n    \n            obj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\n            obj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\n            obj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\n    \n            for (var j = 0; j < obj.rows.length; j++) {\n                obj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\n                obj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\n            }\n    \r\n            // Update footers position\r\n            if (obj.options.footers) {\r\n                for (var j = 0; j < obj.options.footers.length; j++) {\r\n                    obj.options.footers[j].splice(d, 0, obj.options.footers[j].splice(o, 1)[0]);\r\n                }\r\n            }\r\n\n            // Keeping history of changes\n            obj.setHistory({\n                action:'moveColumn',\n                oldValue: o,\n                newValue: d,\n            });\n    \n            // Update table references\n            obj.updateTableReferences();\n    \n            // Events\r\n            obj.dispatch('onmovecolumn', el, o, d);\n        }\n\n        /**\n         * Insert a new column\n         * \n         * @param mixed - num of columns to be added or data to be added in one single column\n         * @param int columnNumber - number of columns to be created\n         * @param bool insertBefore\n         * @param object properties - column properties\n         * @return void\n         */\n        obj.insertColumn = function(mixed, columnNumber, insertBefore, properties) {\n            // Configuration\n            if (obj.options.allowInsertColumn == true) {\n                // Records\n                var records = [];\n    \n                // Data to be insert\n                var data = [];\n    \n                // The insert could be lead by number of rows or the array of data\n                if (mixed > 0) {\n                    var numOfColumns = mixed;\n                } else {\n                    var numOfColumns = 1;\n    \n                    if (mixed) {\n                        data = mixed;\n                    }\n                }\n    \n                // Direction\n                var insertBefore = insertBefore ? true : false;\n    \n                // Current column number\n                var lastColumn = obj.options.columns.length - 1;\n    \n                // Confirm position\n                if (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\n                    columnNumber = lastColumn;\n                }\n    \n                // Onbeforeinsertcolumn\n                if (obj.dispatch('onbeforeinsertcolumn', el, columnNumber, numOfColumns, insertBefore) === false) {\n                    console.log('onbeforeinsertcolumn returned false');\n\n                    return false;\n                }\n    \n                // Merged cells\n                if (Object.keys(obj.options.mergeCells).length > 0) {\n                    if (obj.isColMerged(columnNumber, insertBefore).length) {\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                            return false;\n                        } else {\n                            obj.destroyMerged();\n                        }\n                    }\n                }\n    \n                // Create default properties\n                if (! properties) {\n                    properties = [];\n                }\n    \n                for (var i = 0; i < numOfColumns; i++) {\n                    if (! properties[i]) {\n                        properties[i] = { type:'text', source:[], options:[], width:obj.options.defaultColWidth, align:obj.options.defaultColAlign };\n                    }\n                }\n    \n                // Insert before\n                var columnIndex = (! insertBefore) ? columnNumber + 1 : columnNumber;\n                obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, properties);\n    \n                // Open space in the containers\n                var currentHeaders = obj.headers.splice(columnIndex);\n                var currentColgroup = obj.colgroup.splice(columnIndex);\n    \n                // History\n                var historyHeaders = [];\n                var historyColgroup = [];\n                var historyRecords = [];\n                var historyData = [];\r\n                var historyFooters = [];\r\n    \n                // Add new headers\n                for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                    obj.createCellHeader(col);\n                    obj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col+1]);\n                    obj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col+1]);\n    \n                    historyHeaders.push(obj.headers[col]);\n                    historyColgroup.push(obj.colgroup[col]);\n                }\n    \r\n                // Add new footer cells\r\n                if (obj.options.footers) {\r\n                    for (var j = 0; j < obj.options.footers.length; j++) {\r\n                        historyFooters[j] = [];\r\n                        for (var i = 0; i < numOfColumns; i++) {\r\n                            historyFooters[j].push('');\r\n                        }\r\n                        obj.options.footers[j].splice(columnIndex, 0, historyFooters[j]);\r\n                    }\r\n                }\r\n\r\n                // Adding visual columns\n                for (var row = 0; row < obj.options.data.length; row++) {\n                    // Keep the current data\n                    var currentData = obj.options.data[row].splice(columnIndex);\n                    var currentRecord = obj.records[row].splice(columnIndex);\n    \n                    // History\n                    historyData[row] = [];\n                    historyRecords[row] = [];\n    \n                    for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\n                        // New value\n                        var value = data[row] ? data[row] : '';\n                        obj.options.data[row][col] = value;\n                        // New cell\n                        var td = obj.createCell(col, row, obj.options.data[row][col]);\n                        obj.records[row][col] = td;\n                        // Add cell to the row\n                        if (obj.rows[row]) {\n                            obj.rows[row].insertBefore(td, obj.rows[row].children[col+1]);\n                        }\n    \n                        // Record History\n                        historyData[row].push(value);\n                        historyRecords[row].push(td);\n                    }\n    \n                    // Copy the data back to the main data\n                    Array.prototype.push.apply(obj.options.data[row], currentData);\n                    Array.prototype.push.apply(obj.records[row], currentRecord);\n                }\n    \n                Array.prototype.push.apply(obj.headers, currentHeaders);\n                Array.prototype.push.apply(obj.colgroup, currentColgroup);\n    \n                // Adjust nested headers\n                if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                    // Flexible way to handle nestedheaders\n                    if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                        for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                            var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + numOfColumns;\n                            obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                            obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                        }\n                    } else {\n                        var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\n                        obj.options.nestedHeaders[0].colspan = colspan;\n                        obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                    }\n                }\n    \n                // Keep history\n                obj.setHistory({\n                    action: 'insertColumn',\n                    columnNumber:columnNumber,\n                    numOfColumns:numOfColumns,\n                    insertBefore:insertBefore,\n                    columns:properties,\n                    headers:historyHeaders,\n                    colgroup:historyColgroup,\n                    records:historyRecords,\r\n                    footers:historyFooters,\n                    data:historyData,\n                });\n    \n                // Remove table references\n                obj.updateTableReferences();\n    \n                // Events\r\n                obj.dispatch('oninsertcolumn', el, columnNumber, numOfColumns, historyRecords, insertBefore);\n            }\n        }\n    \n        /**\n         * Delete a column by number\n         * \n         * @param integer columnNumber - reference column to be excluded\n         * @param integer numOfColumns - number of columns to be excluded from the reference column\n         * @return void\n         */\n        obj.deleteColumn = function(columnNumber, numOfColumns) {\n            // Global Configuration\n            if (obj.options.allowDeleteColumn == true) {\n                if (obj.headers.length > 1) {\n                    // Delete column definitions\n                    if (columnNumber == undefined) {\n                        var number = obj.getSelectedColumns(true);\n    \n                        if (! number.length) {\n                            // Remove last column\n                            columnNumber = obj.headers.length - 1;\n                            numOfColumns = 1;\n                        } else {\n                            // Remove selected\n                            columnNumber = parseInt(number[0]);\n                            numOfColumns = parseInt(number.length);\n                        }\n                    }\n    \n                    // Lasat column\n                    var lastColumn = obj.options.data[0].length - 1;\n    \n                    if (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\n                        columnNumber = lastColumn;\n                    }\n    \n                    // Minimum of columns to be delete is 1\n                    if (! numOfColumns) {\n                        numOfColumns = 1;\n                    }\n    \n                    // Can't delete more than the limit of the table\n                    if (numOfColumns > obj.options.data[0].length - columnNumber) {\n                        numOfColumns = obj.options.data[0].length - columnNumber;\n                    }\n    \n                    // onbeforedeletecolumn\n                   if (obj.dispatch('onbeforedeletecolumn', el, columnNumber, numOfColumns) === false) {\n                      console.log('onbeforedeletecolumn returned false');\n                      return false;\n                   }\n    \n                    // Can't remove the last column\n                    if (parseInt(columnNumber) > -1) {\n                        // Merged cells\n                        var mergeExists = false;\n                        if (Object.keys(obj.options.mergeCells).length > 0) {\n                            for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                                if (obj.isColMerged(col, false).length) {\n                                    mergeExists = true;\n                                }\n                            }\n                        }\n                        if (mergeExists) {\n                            if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\n                                return false;\n                            } else {\n                                obj.destroyMerged();\n                            }\n                        }\n    \n                        // Delete the column properties\n                        var columns = obj.options.columns.splice(columnNumber, numOfColumns);\n    \n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                            obj.colgroup[col].className = '';\n                            obj.headers[col].className = '';\n                            obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\n                            obj.headers[col].parentNode.removeChild(obj.headers[col]);\n                        }\n    \n                        var historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\n                        var historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\n                        var historyRecords = [];\n                        var historyData = [];\n                        var historyFooters = [];\r\n\n                        for (var row = 0; row < obj.options.data.length; row++) {\n                            for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\n                                obj.records[row][col].className = '';\n                                obj.records[row][col].parentNode.removeChild(obj.records[row][col]);\n                            }\n                        }\n    \n                        // Delete headers\n                        for (var row = 0; row < obj.options.data.length; row++) {\n                            // History\n                            historyData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\n                            historyRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\r\n                        }\n\r\n                        // Delete footers\r\n                        if (obj.options.footers) {\r\n                            for (var row = 0; row < obj.options.footers.length; row++) {\r\n                                historyFooters[row] = obj.options.footers[row].splice(columnNumber, numOfColumns);\r\n                            }\r\n                        }\r\n\n                        // Remove selection\n                        obj.conditionalSelectionUpdate(0, columnNumber, (columnNumber + numOfColumns) - 1);\n    \n                        // Adjust nested headers\n                        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                            // Flexible way to handle nestedheaders\n                            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                                    var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - numOfColumns;\n                                    obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                                    obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                                }\n                            } else {\n                                var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\n                                obj.options.nestedHeaders[0].colspan = colspan;\n                                obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                            }\n                        }\n    \n                        // Keeping history of changes\n                        obj.setHistory({\n                            action:'deleteColumn',\n                            columnNumber:columnNumber,\n                            numOfColumns:numOfColumns,\n                            insertBefore: 1,\n                            columns:columns,\n                            headers:historyHeaders,\n                            colgroup:historyColgroup,\n                            records:historyRecords,\r\n                            footers:historyFooters,\n                            data:historyData,\n                        });\n    \n                        // Update table references\n                        obj.updateTableReferences();\n    \n                        // Delete\r\n                        obj.dispatch('ondeletecolumn', el, columnNumber, numOfColumns, historyRecords);\n                    }\n                } else {\n                    console.error('JEXCEL. It is not possible to delete the last column');\n                }\n            }\n        }\n    \n        /**\n         * Get seleted rows numbers\n         * \n         * @return array\n         */\n        obj.getSelectedRows = function(asIds) {\n            var rows = [];\n            // Get all selected rows\n            for (var j = 0; j < obj.rows.length; j++) {\n                if (obj.rows[j].classList.contains('selected')) {\n                    if (asIds) {\n                        rows.push(j);\n                    } else {\n                        rows.push(obj.rows[j]);\n                    }\n                }\n            }\n    \n            return rows;\n        },\n    \n        /**\n         * Get seleted column numbers\n         * \n         * @return array\n         */\n        obj.getSelectedColumns = function() {\n            var cols = [];\n            // Get all selected cols\n            for (var i = 0; i < obj.headers.length; i++) {\n                if (obj.headers[i].classList.contains('selected')) {\n                    cols.push(i);\n                }\n            }\n    \n            return cols;\n        }\n    \n        /**\n         * Get highlighted\n         * \n         * @return array\n         */\n        obj.getHighlighted = function() {\n            return obj.highlighted;\n        }\n    \n        /**\n         * Update cell references\n         * \n         * @return void\n         */\n        obj.updateTableReferences = function() {\n            // Update headers\n            for (var i = 0; i < obj.headers.length; i++) {\n                var x = obj.headers[i].getAttribute('data-x');\n    \n                if (x != i) {\n                    // Update coords\n                    obj.headers[i].setAttribute('data-x', i);\n                    // Title\n                    if (! obj.headers[i].getAttribute('title')) {\n                        obj.headers[i].innerHTML = jexcel.getColumnName(i);\n                    }\n                }\n            }\n    \n            // Update all rows\n            for (var j = 0; j < obj.rows.length; j++) {\n                if (obj.rows[j]) {\n                    var y = obj.rows[j].getAttribute('data-y');\n    \n                    if (y != j) {\n                        // Update coords\n                        obj.rows[j].setAttribute('data-y', j);\n                        obj.rows[j].children[0].setAttribute('data-y', j);\n                        // Row number\n                        obj.rows[j].children[0].innerHTML = j + 1;\n                    }\n                }\n            }\n    \n            // Regular cells affected by this change\n            var affectedTokens = [];\n            var mergeCellUpdates = [];\n    \n            // Update cell\n            var updatePosition = function(x,y,i,j) {\n                if (x != i) {\n                    obj.records[j][i].setAttribute('data-x', i);\n                }\n                if (y != j) {\n                    obj.records[j][i].setAttribute('data-y', j);\n                }\n    \n                // Other updates\n                if (x != i || y != j) {\n                    var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                    var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                    affectedTokens[columnIdFrom] = columnIdTo;\n                }\n            }\n    \n            for (var j = 0; j < obj.records.length; j++) {\n                for (var i = 0; i < obj.records[0].length; i++) {\n                    if (obj.records[j][i]) {\n                        // Current values\n                        var x = obj.records[j][i].getAttribute('data-x');\n                        var y = obj.records[j][i].getAttribute('data-y');\n    \n                        // Update column\n                        if (obj.records[j][i].getAttribute('data-merged')) {\n                            var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\n                            var columnIdTo = jexcel.getColumnNameFromId([i, j]);\n                            if (mergeCellUpdates[columnIdFrom] == null) {\n                                if (columnIdFrom == columnIdTo) {\n                                    mergeCellUpdates[columnIdFrom] = false;\n                                } else {\n                                    var totalX = parseInt(i - x);\n                                    var totalY = parseInt(j - y);\n                                    mergeCellUpdates[columnIdFrom] = [ columnIdTo, totalX, totalY ];\n                                }\n                            }\n                        } else {\n                            updatePosition(x,y,i,j);\n                        }\n                    }\n                }\n            }\n    \n            // Update merged if applicable\n            var keys = Object.keys(mergeCellUpdates);\n            if (keys.length) {\n                for (var i = 0; i < keys.length; i++) {\n                    if (mergeCellUpdates[keys[i]]) {\n                        var info = jexcel.getIdFromColumnName(keys[i], true)\n                        var x = info[0];\n                        var y = info[1];\n                        updatePosition(x,y,x + mergeCellUpdates[keys[i]][1],y + mergeCellUpdates[keys[i]][2]);\n    \n                        var columnIdFrom = keys[i];\n                        var columnIdTo = mergeCellUpdates[keys[i]][0];\n                        for (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\n                            var x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\n                            var y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\n                            obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\n                            obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\n                        }\n    \n                        obj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\n                        delete(obj.options.mergeCells[columnIdFrom]);\n                    }\n                }\n            }\n    \n            // Update formulas\n            obj.updateFormulas(affectedTokens);\n    \n            // Update meta data\n            obj.updateMeta(affectedTokens);\n    \n            // Refresh selection\n            obj.refreshSelection();\n    \n            // Update table with custom configuration if applicable\n            obj.updateTable();\n        }\n    \n        /**\n         * Custom settings for the cells\n         */\n        obj.updateTable = function() {\n            // Check for spare\n            if (obj.options.minSpareRows > 0) {\n                var numBlankRows = 0;\n                for (var j = obj.rows.length - 1; j >= 0; j--) {\n                    var test = false;\n                    for (var i = 0; i < obj.headers.length; i++) {\n                        if (obj.options.data[j][i]) {\n                            test = true;\n                        }\n                    }\n                    if (test) {\n                        break;\n                    } else {\n                        numBlankRows++;\n                    }\n                }\n    \n                if (obj.options.minSpareRows - numBlankRows > 0) {\n                    obj.insertRow(obj.options.minSpareRows - numBlankRows)\n                }\n            }\n    \n            if (obj.options.minSpareCols > 0) {\n                var numBlankCols = 0;\n                for (var i = obj.headers.length - 1; i >= 0 ; i--) {\n                    var test = false;\n                    for (var j = 0; j < obj.rows.length; j++) {\n                        if (obj.options.data[j][i]) {\n                            test = true;\n                        }\n                    }\n                    if (test) {\n                        break;\n                    } else {\n                        numBlankCols++;\n                    }\n                }\n    \n                if (obj.options.minSpareCols - numBlankCols > 0) {\n                    obj.insertColumn(obj.options.minSpareCols - numBlankCols)\n                }\n            }\n    \n            // Customizations by the developer\n            if (typeof(obj.options.updateTable) == 'function') {\n                if (obj.options.detachForUpdates) {\r\n                    el.removeChild(obj.content);\r\n                }\r\n\n                for (var j = 0; j < obj.rows.length; j++) {\n                    for (var i = 0; i < obj.headers.length; i++) {\n                        obj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].innerText, jexcel.getColumnNameFromId([i, j]));\n                    }\n                }\n\r\n                if (obj.options.detachForUpdates) {\r\n                    el.insertBefore(obj.content, obj.pagination);\r\n                }\n            }\n    \r\n            // Update footers\r\n            if (obj.options.footers) {\r\n                obj.setFooter();\r\n            }\r\n\n            // Update corner position\n            setTimeout(function() {\n                obj.updateCornerPosition();\n            },0);\n        }\n\r\n        /**\r\n         * Show row\r\n         */\r\n        obj.showRow = function(rowNumber) {\r\n            obj.rows[rowNumber].style.display = '';\r\n        }\r\n\r\n        /**\r\n         * Hide row\r\n         */\r\n        obj.hideRow = function(rowNumber) {\r\n            obj.rows[rowNumber].style.display = 'none';\r\n        }\r\n\r\n        /**\r\n         * Show column\r\n         */\r\n        obj.showColumn = function(colNumber) {\r\n            obj.headers[colNumber].style.display = '';\r\n            obj.colgroup[colNumber].style.display = '';\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                obj.records[j][colNumber].style.display = '';\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Hide column\r\n         */\r\n        obj.hideColumn = function(colNumber) {\r\n            obj.headers[colNumber].style.display = 'none';\r\n            obj.colgroup[colNumber].style.display = 'none';\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                obj.records[j][colNumber].style.display = 'none';\r\n            }\r\n        }\r\n\n        /**\n         * Show index column\n         */\n        obj.showIndex = function() {\n            obj.table.classList.remove('jexcel_hidden_index');\n        }\n    \n        /**\n         * Hide index column\n         */\n        obj.hideIndex = function() {\n            obj.table.classList.add('jexcel_hidden_index');\n        }\n    \n        /**\n         * Update all related cells in the chain\n         */\n        var chainLoopProtection = [];\n    \n        obj.updateFormulaChain = function(x, y, records) {\n            var cellId = jexcel.getColumnNameFromId([x, y]);\n            if (obj.formula[cellId] && obj.formula[cellId].length > 0) {\n                if (chainLoopProtection[cellId]) {\n                    obj.records[y][x].innerHTML = '#ERROR';\n                    obj.formula[cellId] = '';\n                } else {\n                    // Protection\n                    chainLoopProtection[cellId] = true;\n    \n                    for (var i = 0; i < obj.formula[cellId].length; i++) {\n                        var cell = jexcel.getIdFromColumnName(obj.formula[cellId][i], true);\n                        // Update cell\n                        var value = ''+obj.options.data[cell[1]][cell[0]];\n                        if (value.substr(0,1) == '=') {\n                            records.push(obj.updateCell(cell[0], cell[1], value, true));\n                        } else {\n                            // No longer a formula, remove from the chain\n                            Object.keys(obj.formula)[i] = null;\n                        }\n                        obj.updateFormulaChain(cell[0], cell[1], records);\n                    }\n                }\n            }\n    \n            chainLoopProtection = [];\n        }\n    \n        /**\n         * Update formulas\n         */\n        obj.updateFormulas = function(referencesToUpdate) {\n            // Update formulas\n            for (var j = 0; j < obj.options.data.length; j++) {\n                for (var i = 0; i < obj.options.data[0].length; i++) {\n                    var value = '' + obj.options.data[j][i];\n                    // Is formula\n                    if (value.substr(0,1) == '=') {\n                        // Replace tokens\n                        var newFormula = obj.updateFormula(value, referencesToUpdate);\n                        if (newFormula != value) {\n                            obj.options.data[j][i] = newFormula;\n                        }\n                    }\n                }\n            }\n    \n            // Update formula chain\n            var formula = [];\n            var keys = Object.keys(obj.formula);\n            for (var j = 0; j < keys.length; j++) {\n                // Current key and values\n                var key = keys[j];\n                var value = obj.formula[key];\n                // Update key\n                if (referencesToUpdate[key]) {\n                    key = referencesToUpdate[key];\n                }\n                // Update values\n                formula[key] = [];\n                for (var i = 0; i < value.length; i++) {\n                    var letter = value[i];\n                    if (referencesToUpdate[letter]) {\n                        letter = referencesToUpdate[letter];\n                    }\n                    formula[key].push(letter);\n                }\n            }\n            obj.formula = formula;\n        }\n    \n        /**\n         * Update formula\n         */\n        obj.updateFormula = function(formula, referencesToUpdate) {\n            var testLetter = /[A-Z]/;\n            var testNumber = /[0-9]/;\n    \n            var newFormula = '';\n            var letter = null;\n            var number = null;\n            var token = '';\n    \n            for (var index = 0; index < formula.length; index++) {\n                if (testLetter.exec(formula[index])) {\n                    letter = 1;\n                    number = 0;\n                    token += formula[index];\n                } else if (testNumber.exec(formula[index])) {\n                    number = letter ? 1 : 0;\n                    token += formula[index];\n                } else {\n                    if (letter && number) {\n                        token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n                    }\n                    newFormula += token;\n                    newFormula += formula[index];\n                    letter = 0;\n                    number = 0;\n                    token = '';\n                }\n            }\n    \n            if (token) {\n                if (letter && number) {\n                    token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\n                }\n                newFormula += token;\n            }\n    \n            return newFormula;\n        }\n    \n        /**\n         * Secure formula\r\n         */\r\n        var secureFormula = function(oldValue) {\r\n            var newValue = '';\r\n            var inside = 0;\r\n\r\n            for (var i = 0; i < oldValue.length; i++) {\r\n                if (oldValue[i] == '\"') {\r\n                    if (inside == 0) {\r\n                        inside = 1;\r\n                    } else {\r\n                        inside = 0;\r\n                    }\r\n                }\r\n\r\n                if (inside == 1) {\r\n                    newValue += oldValue[i];\r\n                } else {\r\n                    newValue += oldValue[i].toUpperCase();\r\n                }\r\n            }\r\n\r\n            return newValue;\r\n        }\r\n\n        /**\n         * Parse formulas\n         */\n        obj.executeFormula = function(expression, x, y) {\n    \n            var formulaResults = [];\n            var formulaLoopProtection = [];\n    \n            // Execute formula with loop protection\n            var execute = function(expression, x, y) {\n             // Parent column identification\n                var parentId = jexcel.getColumnNameFromId([x, y]);\n    \n                // Code protection\n                if (formulaLoopProtection[parentId]) {\n                    console.error('Reference loop detected');\n                    return '#ERROR';\n                }\n    \n                formulaLoopProtection[parentId] = true;\n    \n                // Convert range tokens\n                var tokensUpdate = function(tokens) {\n                    for (var index = 0; index < tokens.length; index++) {\n                        var f = [];\n                        var token = tokens[index].split(':');\n                        var e1 = jexcel.getIdFromColumnName(token[0], true);\n                        var e2 = jexcel.getIdFromColumnName(token[1], true);\n    \n                        if (e1[0] <= e2[0]) {\n                            var x1 = e1[0];\n                            var x2 = e2[0];\n                        } else {\n                            var x1 = e2[0];\n                            var x2 = e1[0];\n                        }\n    \n                        if (e1[1] <= e2[1]) {\n                            var y1 = e1[1];\n                            var y2 = e2[1];\n                        } else {\n                            var y1 = e2[1];\n                            var y2 = e1[1];\n                        }\n    \n                        for (var j = y1; j <= y2; j++) {\n                            for (var i = x1; i <= x2; i++) {\n                                f.push(jexcel.getColumnNameFromId([i, j]));\n                            }\n                        }\n    \n                        expression = expression.replace(tokens[index], f.join(','));\n                    }\n                }\n    \n                var tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\n                if (tokens && tokens.length) {\n                    tokensUpdate(tokens);\n                }\n    \n                // String\n                var evalstring = '';\n    \n                // Get tokens\n                var tokens = expression.match(/([A-Z]+[0-9]+)/g);\n    \n                // Direct self-reference protection\n                if (tokens && tokens.indexOf(parentId) > -1) {\n                    console.error('Self Reference detected');\n                    return '#ERROR';\n                } else {\n                    if (tokens) {\n                        for (var i = 0; i < tokens.length; i++) {\n                            // Keep chain\n                            if (! obj.formula[tokens[i]]) {\n                                obj.formula[tokens[i]] = [];\n                            }\n                            // Is already in the register\n                            if (obj.formula[tokens[i]].indexOf(parentId) < 0) {\n                                obj.formula[tokens[i]].push(parentId);\n                            }\n    \n                            // Do not calculate again\n                            if (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\n                                // Coords\n                                var position = jexcel.getIdFromColumnName(tokens[i], 1);\n                                // Get value\n                                if (typeof(obj.options.data[position[1]]) != 'undefined' && typeof(obj.options.data[position[1]][position[0]]) != 'undefined') {\n                                    var value = obj.options.data[position[1]][position[0]];\n                                } else {\n                                    var value = '';\n                                }\n                                // Get column data\n                                if ((''+value).substr(0,1) == '=') {\n                                    if (formulaResults[tokens[i]]) {\n                                        value = formulaResults[tokens[i]];\n                                    } else {\n                                        value = execute(value, position[0], position[1]);\n                                        formulaResults[tokens[i]] = value;\n                                    }\n                                }\n                                // Type!\n                                if ((''+value).trim() == '') {\n                                    // Null\n                                    evalstring += \"var \" + tokens[i] + \" = null;\";\n                                } else {\n                                    if (value == Number(value) && obj.options.autoCasting == true) {\n                                        // Number\n                                        evalstring += \"var \" + tokens[i] + \" = \" + Number(value) + \";\";\n                                    } else {\n                                        // Trying any formatted number\n                                        var number = obj.parseNumber(value, position[0])\n                                        if (obj.options.autoCasting == true && number) {\n                                            // Render as number\n                                            evalstring += \"var \" + tokens[i] + \" = \" + number + \";\";\n                                        } else {\n                                            // Render as string\n                                            evalstring += \"var \" + tokens[i] + \" = '\" + value + \"';\";\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n    \n                    // Convert formula to javascript\n                    try {\n                        evalstring += \"function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; }; function TABLE() { return obj; }; function VALUE(col, row) { return obj.records[row-1][col-1].innerHTML; }; function THISROWCELL(col) { var id = jexcel.getIdFromColumnName(col+(parseInt(y)+1), true); return obj.records[id[1]][id[0]].innerHTML; }\";\n    \n                        var res = eval(evalstring + expression.substr(1));\n                    } catch (e) {\n                        var res = '#ERROR';\n                    }\n    \n                    return res;\n                }\n            }\n    \n            return execute(expression, x, y);\n        }\n    \n        /**\n         * Trying to extract a number from a string\n         */\n        obj.parseNumber = function(value, columnNumber) {\n            // Decimal point\n            var decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.';\n    \n            // Parse both parts of the number\n            var number = ('' + value);\n            number = number.split(decimal);\n            number[0] = number[0].match(/[+-]?[0-9]/g);\n            if (number[0]) {\n                number[0] = number[0].join('');\n            }\n            if (number[1]) {\n                number[1] = number[1].match(/[0-9]*/g).join('');\n            }\n    \n            // Is a valid number\n            if (number[0] && Number(number[0]) >= 0) {\n                if (! number[1]) {\n                    var value = Number(number[0] + '.00');\n                } else {\n                    var value = Number(number[0] + '.' + number[1]);\n                }\n            } else {\n                var value = null;\n            }\n    \n            return value;\n        }\n    \n        /**\n         * Get row number\n         */\n        obj.row = function(cell) {\n        }\n    \n        /**\n         * Get col number\n         */\n        obj.col = function(cell) {\n        }\n    \n        obj.up = function(shiftKey, ctrlKey) {\n            if (shiftKey) {\n                if (obj.selectedCell[3] > 0) {\n                    obj.up.visible(1, ctrlKey ? 0 : 1)\n                }\n            } else {\n                if (obj.selectedCell[1] > 0) {\n                    obj.up.visible(0, ctrlKey ? 0 : 1)\n                }\n                obj.selectedCell[2] = obj.selectedCell[0];\n                obj.selectedCell[3] = obj.selectedCell[1];\n            }\n    \n            // Update selection\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n    \n            // Change page\n            if (obj.options.lazyLoading == true) {\n                if (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\n                    obj.loadPage(0);\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    if (obj.loadValidation()) {\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    } else {\n                        var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n                        if (obj.selectedCell[1] - item < 30) {\n                            obj.loadUp();\n                            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                        }\n                    }\n                }\n            } else if (obj.options.pagination > 0) {\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\n                if (pageNumber != obj.pageNumber) {\n                    obj.page(pageNumber);\n                }\n            }\n    \n            obj.updateScroll(1);\n        }\n    \n        obj.up.visible = function(group, direction) {\n            if (group == 0) {\n                var x = parseInt(obj.selectedCell[0]);\n                var y = parseInt(obj.selectedCell[1]);\n            } else {\n                var x = parseInt(obj.selectedCell[2]);\n                var y = parseInt(obj.selectedCell[3]);\n            }\n    \n            if (direction == 0) {\n                for (var j = 0; j < y; j++) {\n                    if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                        y = j;\n                        break;\n                    }\n                }\n            } else {\n                y = obj.up.get(x, y);\n            }\n    \n            if (group == 0) {\n                obj.selectedCell[0] = x;\n                obj.selectedCell[1] = y;\n            } else {\n                obj.selectedCell[2] = x;\n                obj.selectedCell[3] = y;\n            }\n        }\n    \n        obj.up.get = function(x, y) {\n            var x = parseInt(x);\n            var y = parseInt(y);\n            for (var j = (y - 1); j >= 0; j--) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    if (obj.records[j][x].getAttribute('data-merged')) {\n                        if (obj.records[j][x] == obj.records[y][x]) {\n                            continue;\n                        }\n                    }\n                    y = j;\n                    break;\n                }\n            }\n    \n            return y;\n        }\n    \n        obj.down = function(shiftKey, ctrlKey) {\n            if (shiftKey) {\n                if (obj.selectedCell[3] < obj.records.length - 1) {\n                    obj.down.visible(1, ctrlKey ? 0 : 1)\n                }\n            } else {\n                if (obj.selectedCell[1] < obj.records.length - 1) {\n                    obj.down.visible(0, ctrlKey ? 0 : 1)\n                }\n                obj.selectedCell[2] = obj.selectedCell[0];\n                obj.selectedCell[3] = obj.selectedCell[1];\n            }\n    \n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n    \n            // Change page\n            if (obj.options.lazyLoading == true) {\n                if ((obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n                    obj.loadPage(-1);\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                } else {\n                    if (obj.loadValidation()) {\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                    } else {\n                        var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n                        if (item - obj.selectedCell[3] < 30) {\n                            obj.loadDown();\n                            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n                        }\n                    }\n                }\n            } else if (obj.options.pagination > 0) {\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\n                if (pageNumber != obj.pageNumber) {\n                    obj.page(pageNumber);\n                }\n            }\n    \n            obj.updateScroll(3);\n        }\n    \n        obj.down.visible = function(group, direction) {\n            if (group == 0) {\n                var x = parseInt(obj.selectedCell[0]);\n                var y = parseInt(obj.selectedCell[1]);\n            } else {\n                var x = parseInt(obj.selectedCell[2]);\n                var y = parseInt(obj.selectedCell[3]);\n            }\n    \n            if (direction == 0) {\n                for (var j = obj.rows.length - 1; j > y; j--) {\n                    if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                        y = j;\n                        break;\n                    }\n                }\n            } else {\n                y = obj.down.get(x, y);\n            }\n    \n            if (group == 0) {\n                obj.selectedCell[0] = x;\n                obj.selectedCell[1] = y;\n            } else {\n                obj.selectedCell[2] = x;\n                obj.selectedCell[3] = y;\n            }\n        }\n    \n        obj.down.get = function(x, y) {\n            var x = parseInt(x);\n            var y = parseInt(y);\n            for (var j = (y + 1); j < obj.rows.length; j++) {\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\n                    if (obj.records[j][x].getAttribute('data-merged')) {\n                        if (obj.records[j][x] == obj.records[y][x]) {\n                            continue;\n                        }\n                    }\n                    y = j;\n                    break;\n                }\n            }\n    \n            return y;\n        }\n    \n        obj.right = function(shiftKey, ctrlKey) {\n            if (shiftKey) {\n                if (obj.selectedCell[2] < obj.headers.length - 1) {\n                    obj.right.visible(1, ctrlKey ? 0 : 1)\n                }\n            } else {\n                if (obj.selectedCell[0] < obj.headers.length - 1) {\n                    obj.right.visible(0, ctrlKey ? 0 : 1)\n                }\n                obj.selectedCell[2] = obj.selectedCell[0];\n                obj.selectedCell[3] = obj.selectedCell[1];\n            }\n    \n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            obj.updateScroll(2);\n        }\n    \n        obj.right.visible = function(group, direction) {\n            if (group == 0) {\n                var x = parseInt(obj.selectedCell[0]);\n                var y = parseInt(obj.selectedCell[1]);\n            } else {\n                var x = parseInt(obj.selectedCell[2]);\n                var y = parseInt(obj.selectedCell[3]);\n            }\n    \n            if (direction == 0) {\n                for (var i = obj.headers.length - 1; i > x; i--) {\n                    if (obj.records[y][i].style.display != 'none') {\n                        x = i;\n                        break;\n                    }\n                }\n            } else {\n                x = obj.right.get(x, y);\n            }\n    \n            if (group == 0) {\n                obj.selectedCell[0] = x;\n                obj.selectedCell[1] = y;\n            } else {\n                obj.selectedCell[2] = x;\n                obj.selectedCell[3] = y;\n            }\n        }\n    \n        obj.right.get = function(x, y) {\n            var x = parseInt(x);\n            var y = parseInt(y);\n    \n            for (var i = (x + 1); i < obj.headers.length; i++) {\n                if (obj.records[y][i].style.display != 'none') {\n                    if (obj.records[y][i].getAttribute('data-merged')) {\n                        if (obj.records[y][i] == obj.records[y][x]) {\n                            continue;\n                        }\n                    }\n                    x = i;\n                    break;\n                }\n            }\n    \n            return x;\n        }\n    \n        obj.left = function(shiftKey, ctrlKey) {\n            if (shiftKey) {\n                if (obj.selectedCell[2] > 0) {\n                    obj.left.visible(1, ctrlKey ? 0 : 1)\n                }\n            } else {\n                if (obj.selectedCell[0] > 0) {\n                    obj.left.visible(0, ctrlKey ? 0 : 1)\n                }\n                obj.selectedCell[2] = obj.selectedCell[0];\n                obj.selectedCell[3] = obj.selectedCell[1];\n            }\n    \n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            obj.updateScroll(0);\n        }\n    \n        obj.left.visible = function(group, direction) {\n            if (group == 0) {\n                var x = parseInt(obj.selectedCell[0]);\n                var y = parseInt(obj.selectedCell[1]);\n            } else {\n                var x = parseInt(obj.selectedCell[2]);\n                var y = parseInt(obj.selectedCell[3]);\n            }\n    \n            if (direction == 0) {\n                for (var i = 0; i < x; i++) {\n                    if (obj.records[y][i].style.display != 'none') {\n                        x = i;\n                        break;\n                    }\n                }\n            } else {\n                x = obj.left.get(x, y);\n            }\n    \n            if (group == 0) {\n                obj.selectedCell[0] = x;\n                obj.selectedCell[1] = y;\n            } else {\n                obj.selectedCell[2] = x;\n                obj.selectedCell[3] = y;\n            }\n        }\n    \n        obj.left.get = function(x, y) {\n            var x = parseInt(x);\n            var y = parseInt(y);\n            for (var i = (x - 1); i >= 0; i--) {\n                if (obj.records[y][i].style.display != 'none') {\n                    if (obj.records[y][i].getAttribute('data-merged')) {\n                        if (obj.records[y][i] == obj.records[y][x]) {\n                            continue;\n                        }\n                    }\n                    x = i;\n                    break;\n                }\n            }\n    \n            return x;\n        }\n    \n        obj.first = function(shiftKey, ctrlKey) {\n            if (shiftKey) {\n                if (ctrlKey) {\n                    obj.selectedCell[3] = 0;\n                } else {\n                    obj.left.visible(1, 0);\n                }\n            } else {\n                if (ctrlKey) {\n                    obj.selectedCell[1] = 0;\n                } else {\n                    obj.left.visible(0, 0);\n                }\n                obj.selectedCell[2] = obj.selectedCell[0];\n                obj.selectedCell[3] = obj.selectedCell[1];\n            }\n    \n            // Change page\n            if (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\n                obj.loadPage(0);\n            } else if (obj.options.pagination > 0) {\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\n                if (pageNumber != obj.pageNumber) {\n                    obj.page(pageNumber);\n                }\n            }\n    \n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            obj.updateScroll(1);\n        }\n    \n        obj.last = function(shiftKey, ctrlKey) {\n            if (shiftKey) {\n                if (ctrlKey) {\n                    obj.selectedCell[3] = obj.records.length - 1;\n                } else {\n                    obj.right.visible(1, 0);\n                }\n            } else {\n                if (ctrlKey) {\n                    obj.selectedCell[1] = obj.records.length - 1;\n                } else {\n                    obj.right.visible(0, 0);\n                }\n                obj.selectedCell[2] = obj.selectedCell[0];\n                obj.selectedCell[3] = obj.selectedCell[1];\n            }\n    \n            // Change page\n            if (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\n                obj.loadPage(-1);\n            } else if (obj.options.pagination > 0) {\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\n                if (pageNumber != obj.pageNumber) {\n                    obj.page(pageNumber);\n                }\n            }\n    \n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n            obj.updateScroll(3);\n        }\n    \n        obj.selectAll = function() {\n            if (! obj.selectedCell) {\n                obj.selectedCell = [];\n            }\n    \n            obj.selectedCell[0] = 0;\n            obj.selectedCell[1] = 0;\n            obj.selectedCell[2] = obj.headers.length - 1;\n            obj.selectedCell[3] = obj.records.length - 1;\n    \n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\n        }\n    \n        /**\n         * Go to a page in a lazyLoading\n         */\n        obj.loadPage = function(pageNumber) {\n            // Search\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results;\n            } else {\n                var results = obj.rows;\n            }\n    \n            // Per page\n            var quantityPerPage = 100;\n    \n            // pageNumber\n            if (pageNumber == null || pageNumber == -1) {\n                // Last page\n                pageNumber = Math.ceil(results.length / quantityPerPage); \n            }\n    \n            var startRow = (pageNumber * quantityPerPage);\n            var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n            if (finalRow > results.length) {\n                finalRow = results.length;\n            }\n            startRow = finalRow - 100;\n            if (startRow < 0) {\n                startRow = 0;\n            }\n    \n            // Appeding items\n            for (var j = startRow; j < finalRow; j++) {\n                if (obj.options.search == true && obj.results) {\n                    obj.tbody.appendChild(obj.rows[results[j]]);\n                } else {\n                    obj.tbody.appendChild(obj.rows[j]);\n                }\n    \n                if (obj.tbody.children.length > quantityPerPage) {\n                    obj.tbody.removeChild(obj.tbody.firstChild);\n                }\n            }\n        }\n    \n        obj.loadUp = function() {\n            // Search\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results;\n            } else {\n                var results = obj.rows;\n            }\n            var test = 0;\n            if (results.length > 100) {\n                // Get the first element in the page\n                var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\n                if (obj.options.search == true && obj.results) {\n                    item = results.indexOf(item);\n                }\n                if (item > 0) {\n                    for (var j = 0; j < 30; j++) {\n                        item = item - 1;\n                        if (item > -1) {\n                            if (obj.options.search == true && obj.results) {\n                                obj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\n                            } else {\n                                obj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\n                            }\n                            if (obj.tbody.children.length > 100) {\n                                obj.tbody.removeChild(obj.tbody.lastChild);\n                                test = 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return test;\n        }\n    \n        obj.loadDown = function() {\n            // Search\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results;\n            } else {\n                var results = obj.rows;\n            }\n            var test = 0;\n            if (results.length > 100) {\n                // Get the last element in the page\n                var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\n                if (obj.options.search == true && obj.results) {\n                    item = results.indexOf(item);\n                }\n                if (item < obj.rows.length - 1) {\n                    for (var j = 0; j <= 30; j++) {\n                        if (item < results.length) {\n                            if (obj.options.search == true && obj.results) {\n                                obj.tbody.appendChild(obj.rows[results[item]]);\n                            } else {\n                                obj.tbody.appendChild(obj.rows[item]);\n                            }\n                            if (obj.tbody.children.length > 100) {\n                                obj.tbody.removeChild(obj.tbody.firstChild);\n                                test = 1;\n                            }\n                        }\n                        item = item + 1;\n                    }\n                }\n            }\n    \n            return test;\n        }\n    \n        obj.loadValidation = function() {\n            if (obj.selectedCell) {\n                var currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\n                var selectedPage = parseInt(obj.selectedCell[3] / 100);\n                var totalPages = parseInt(obj.rows.length / 100);\n    \n                if (currentPage != selectedPage && selectedPage <= totalPages) {\n                    if (! Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\n                        obj.loadPage(selectedPage);\n                        return true;\n                    }\n                }\n            }\n    \n            return false;\n        }\n    \n        /**\n         * Reset search\n         */\n        obj.resetSearch = function() {\n            obj.searchInput.value = '';\n            obj.search('');\n            obj.results = null;\n        }\n\r\n        /**\n         * Search\n         */\n        obj.search = function(query) {\n            // Query\n            if (query) {\n                var query = query.toLowerCase();\n            }\n    \r\n            // Reset any filter\r\n            if (obj.options.filters) {\r\n                obj.resetFilters();\r\n            }\r\n\n            // Reset selection\n            obj.resetSelection();\n    \n            // Total of results\n            obj.pageNumber = 0;\n            obj.results = [];\n    \n            if (query) {\n                // Search filter\n                var search = function(item, query, index) {\n                    for (var i = 0; i < item.length; i++) {\n                        if ((''+item[i]).toLowerCase().search(query) >= 0 ||\n                            (''+obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\n                            return true;\n                        }\n                    }\n                    return false;\n                }\n    \n                // Result\n                var addToResult = function(k) {\n                    if (obj.results.indexOf(k) == -1) {\n                        obj.results.push(k);\n                    }\n                }\n    \n                // Filter\n                var data = obj.options.data.filter(function(v, k) {\n                    if (search(v, query, k)) {\n                        // Merged rows found\n                        var rows = obj.isRowMerged(k);\n                        if (rows.length) {\n                            for (var i = 0; i < rows.length; i++) {\n                                var row = jexcel.getIdFromColumnName(rows[i], true);\n                                for (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\n                                    addToResult(row[1]+j);\n                                }\n                            }\n                        } else {\n                            // Normal row found\n                            addToResult(k);\n                        }\n                        return true;\n                    } else {\n                        return false;\n                    }\n                });\n            } else {\n                obj.results = null;\n            }\n\r\n            return obj.updateResult();\n        }\n    \r\n        obj.updateResult = function() {\r\n            var total = 0;\r\n            var index = 0;\r\n    \r\n            // Page 1\r\n            if (obj.options.lazyLoading == true) {\r\n                total = 100;\r\n            } else if (obj.options.pagination > 0) {\r\n                total = obj.options.pagination;\r\n            } else {\r\n                if (obj.results) {\r\n                    total = obj.results.length;\r\n                } else {\r\n                    total = obj.rows.length;\r\n                }\r\n            }\r\n    \r\n            // Reset current nodes\r\n            while (obj.tbody.firstChild) {\r\n                obj.tbody.removeChild(obj.tbody.firstChild);\r\n            }\r\n    \r\n            // Hide all records from the table\r\n            for (var j = 0; j < obj.rows.length; j++) {\r\n                if (! obj.results || obj.results.indexOf(j) > -1) {\r\n                    if (index < total) {\r\n                        obj.tbody.appendChild(obj.rows[j]);\r\n                        index++;\r\n                    }\r\n                    obj.rows[j].style.display = '';\r\n                } else {\r\n                    obj.rows[j].style.display = 'none';\r\n                }\r\n            }\r\n    \r\n            // Update pagination\r\n            if (obj.options.pagination > 0) {\r\n                obj.updatePagination();\r\n            }\r\n\r\n            obj.updateCornerPosition();\r\n    \r\n            return total;\r\n        }\r\n\n        /**\n         * Which page the cell is\n         */\n        obj.whichPage = function(cell) {\n            // Search\n            if (obj.options.search == true && obj.results) {\n                cell = obj.results.indexOf(cell);\n            }\n    \n            return (Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination))) - 1;\n        }\n    \n        /**\n         * Go to page\n         */\n        obj.page = function(pageNumber) {\r\n            var oldPage = obj.pageNumber;\r\n\n            // Search\n            if (obj.options.search == true && obj.results) {\n                var results = obj.results;\n            } else {\n                var results = obj.rows;\n            }\n    \n            // Per page\n            var quantityPerPage = parseInt(obj.options.pagination);\n    \n            // pageNumber\n            if (pageNumber == null || pageNumber == -1) {\n                // Last page\n                pageNumber = Math.ceil(results.length / quantityPerPage); \n            }\n    \n            // Page number\n            obj.pageNumber = pageNumber;\n    \n            var startRow = (pageNumber * quantityPerPage);\n            var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\n            if (finalRow > results.length) {\n                finalRow = results.length;\n            }\n            if (startRow < 0) {\n                startRow = 0;\n            }\n    \n            // Reset container\n            while (obj.tbody.firstChild) {\n                obj.tbody.removeChild(obj.tbody.firstChild);\n            }\n    \n            // Appeding items\n            for (var j = startRow; j < finalRow; j++) {\n                if (obj.options.search == true && obj.results) {\n                    obj.tbody.appendChild(obj.rows[results[j]]);\n                } else {\n                    obj.tbody.appendChild(obj.rows[j]);\n                }\n            }\n    \n            if (obj.options.pagination > 0) {\n                obj.updatePagination();\n            }\n    \n            // Update corner position\n            obj.updateCornerPosition();\r\n\r\n            // Events\r\n            obj.dispatch('onchangepage', el, pageNumber, oldPage);\r\n        }\n    \n        /**\n         * Update the pagination\n         */\n        obj.updatePagination = function() {\n            // Reset container\n            obj.pagination.children[0].innerHTML = '';\n            obj.pagination.children[1].innerHTML = '';\n    \n            // Start pagination\n            if (obj.options.pagination) {\n                // Searchable\n                if (obj.options.search == true && obj.results) {\n                    var results = obj.results.length;\n                } else {\n                    var results = obj.rows.length;\n                }\n    \n                if (! results) {\n                    // No records found\n                    obj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\n                } else {\n                    // Pagination container\n                    var quantyOfPages = Math.ceil(results / obj.options.pagination);\n    \n                    if (obj.pageNumber < 6) {\n                        var startNumber = 1;\n                        var finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\n                    } else if (quantyOfPages - obj.pageNumber < 5) {\n                        var startNumber = quantyOfPages - 9;\n                        var finalNumber = quantyOfPages;\n                        if (startNumber < 1) {\n                            startNumber = 1;\n                        }\n                    } else {\n                        var startNumber = obj.pageNumber - 4;\n                        var finalNumber = obj.pageNumber + 5;\n                    }\n    \n                    // First\n                    if (startNumber > 1) {\n                        var paginationItem = document.createElement('div');\n                        paginationItem.className = 'jexcel_page';\n                        paginationItem.innerHTML = '<';\n                        paginationItem.title = 1;\n                        obj.pagination.children[1].appendChild(paginationItem);\n                    }\n    \n                    // Get page links\n                    for (var i = startNumber; i <= finalNumber; i++) {\n                        var paginationItem = document.createElement('div');\n                        paginationItem.className = 'jexcel_page';\n                        paginationItem.innerHTML = i;\n                        obj.pagination.children[1].appendChild(paginationItem);\n    \n                        if (obj.pageNumber == (i-1)) {\n                            paginationItem.classList.add('jexcel_page_selected');\n                        }\n                    }\n    \n                    // Last\n                    if (finalNumber < quantyOfPages) {\n                        var paginationItem = document.createElement('div');\n                        paginationItem.className = 'jexcel_page';\n                        paginationItem.innerHTML = '>';\n                        paginationItem.title = quantyOfPages;\n                        obj.pagination.children[1].appendChild(paginationItem);\n                    }\n    \n                    // Text\n                    var format = function(format) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        return format.replace(/{(\\d+)}/g, function(match, number) {\n                          return typeof args[number] != 'undefined'\n                            ? args[number]\n                            : match\n                          ;\n                        });\n                    };\n    \n                    obj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages)\n                }\n            }\n        }\n    \n        /**\n         * Download CSV table\n         * \n         * @return null\n         */\n        obj.download = function(includeHeaders) {\n            if (obj.options.allowExport == false) {\n                console.error('Export not allowed');\n            } else {\n                // Data\n                var data = '';\n                if (includeHeaders == true || obj.options.includeHeadersOnDownload == true) {\n                    data += obj.getHeaders();\n                    data += \"\\r\\n\";\n                }\r\n\r\n                // Get data\r\n                data += obj.copy(false, obj.options.csvDelimiter, true);\r\n\r\n                // Download element\r\n                var blob = new Blob([\"\\uFEFF\"+data], {type: 'text/csv;charset=utf-8;'});\r\n\r\n                // IE Compatibility\r\n                if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                    window.navigator.msSaveOrOpenBlob(blob, options.csvFileName + '.csv');\r\n                } else {\n                    // Download element\n                    var pom = document.createElement('a');\n                    var url = URL.createObjectURL(blob);\n                    pom.href = url;\n                    pom.setAttribute('download', obj.options.csvFileName + '.csv');\n                    document.body.appendChild(pom);\n                    pom.click();\n                    pom.parentNode.removeChild(pom);\r\n                }\n            }\n        }\n    \n        /**\n         * Initializes a new history record for undo/redo\n         * \n         * @return null\n         */\n        obj.setHistory = function(changes) {\n            if (obj.ignoreHistory != true) {\n                // Increment and get the current history index\n                var index = ++obj.historyIndex;\n    \n                // Slice the array to discard undone changes\n                obj.history = (obj.history = obj.history.slice(0, index + 1));\n    \n                // Keep history\n                obj.history[index] = changes;\n            }\n        }\n    \n        /**\n         * Copy method\n         * \n         * @param bool highlighted - Get only highlighted cells\n         * @param delimiter - \\t default to keep compatibility with excel\n         * @return string value\n         */\n        obj.copy = function(highlighted, delimiter, returnData) {\n            if (! delimiter) {\n                delimiter = \"\\t\";\n            }\n    \n            // Controls\n            var col = [];\n            var colLabel = [];\n            var row = [];\n            var rowLabel = [];\n            var x = obj.options.data[0].length\n            var y = obj.options.data.length\n            var tmp = '';\n\r\n            // Headers\r\n            if (obj.options.includeHeadersOnCopy == true) {\r\n                if (obj.options.copyCompatibility == true) {\r\n                    strLabel.push(obj.getHeaders(true).join(delimiter));\r\n                } else {\r\n                    str.push(obj.getHeaders(true).join(delimiter));\r\n                }\r\n            }\r\n\n            // Reset container\n            obj.style = [];\n    \n            // Go through the columns to get the data\n            for (var j = 0; j < y; j++) {\n                col = [];\n                colLabel = [];\n    \n                for (var i = 0; i < x; i++) {\n                    // If cell is highlighted\n                    if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\n                        // Values\n                        var value = obj.options.data[j][i];\n                        if (value.match && (value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\n                            value = value.replace(new RegExp('\"', 'g'), '\"\"');\n                            value = '\"' + value + '\"';\n                        }\n                        col.push(value);\n    \n                        // Labels\r\n                        if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n                            var label = value;\n                        } else {\r\n                            var label = obj.records[j][i].innerHTML;\r\n                            if (label.match && (label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\r\n                                // Scape double quotes\r\n                                label = label.replace(new RegExp('\"', 'g'), '\"\"');\r\n                                label = '\"' + label + '\"';\r\n                            }\r\n                        }\n                        colLabel.push(label);\n    \n                        // Get style\n                        tmp = obj.records[j][i].getAttribute('style');\r\n                        tmp = tmp.replace('display: none;', '');\n                        obj.style.push(tmp ? tmp : '');\n                    }\n                }\n    \n                if (col.length) {\n                    row.push(col.join(delimiter));\n                }\n                if (colLabel.length) {\n                    rowLabel.push(colLabel.join(delimiter));\n                }\n            }\n\n            // Final string\n            var str = row.join(\"\\r\\n\");\n            var strLabel = rowLabel.join(\"\\r\\n\");\n\n            // Create a hidden textarea to copy the values\n            if (! returnData) {\n                if (obj.options.copyCompatibility == true) {\n                    obj.textarea.value = strLabel;\n                } else {\n                    obj.textarea.value = str;\n                }\n                obj.textarea.select();\n                document.execCommand(\"copy\");\n            }\n    \n            // Keep data\n            if (obj.options.copyCompatibility == true) {\n                obj.data = strLabel;\n            } else {\n                obj.data = str;\n            }\n            // Keep non visible information\n            obj.hashString = obj.hash(obj.data);\n    \r\n            // Border\r\n            if (obj.highlighted) {\r\n                for (var i = 0; i < obj.highlighted.length; i++) {\r\n                    obj.highlighted[i].classList.add('copying');\r\n                    if (obj.highlighted[i].classList.contains('highlight-left')) {\r\n                        obj.highlighted[i].classList.add('copying-left');\r\n                    }\r\n                    if (obj.highlighted[i].classList.contains('highlight-right')) {\r\n                        obj.highlighted[i].classList.add('copying-right');\r\n                    }\r\n                    if (obj.highlighted[i].classList.contains('highlight-top')) {\r\n                        obj.highlighted[i].classList.add('copying-top');\r\n                    }\r\n                    if (obj.highlighted[i].classList.contains('highlight-bottom')) {\r\n                        obj.highlighted[i].classList.add('copying-bottom');\r\n                    }\r\n                }\r\n            }\r\n\n            // Paste event\r\n            obj.dispatch('oncopy', el, obj.options.copyCompatibility == true ? rowLabel : row, obj.hashString);\r\n\n            return obj.data;\n        }\n    \n        /**\n         * jExcel paste method\n         * \n         * @param integer row number\n         * @return string value\n         */\n        obj.paste = function(x, y, data) {\n            // Paste filter\n            var ret = obj.dispatch('onbeforepaste', el, data, x, y);\r\n\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                var data = ret;\r\n            }\n    \n            // Controls\n            var hash = obj.hash(data);\n            var style = (hash == obj.hashString) ? obj.style : null;\n    \n            // Depending on the behavior\n            if (obj.options.copyCompatibility == true && hash == obj.hashString) {\n                var data = obj.data;\n            }\n    \n            // Split new line\n            var data = obj.parseCSV(data, \"\\t\");\n    \n            if (x != null && y != null && data) {\n                // Records\n                var i = 0;\n                var j = 0;\n                var records = [];\n                var newStyle = {};\n                var oldStyle = {};\n                var styleIndex = 0;\n    \n                // Index\n                var colIndex = parseInt(x);\n                var rowIndex = parseInt(y);\n                var row = null;\n    \n                // Go through the columns to get the data\n                while (row = data[j]) {\n                    i = 0;\n                    colIndex = parseInt(x);\n    \n                    while (row[i] != null) {\n                        // Update and keep history\n                        var record = obj.updateCell(colIndex, rowIndex, row[i]);\n                        // Keep history\n                        records.push(record);\n                        // Update all formulas in the chain\n                        obj.updateFormulaChain(colIndex, rowIndex, records);\n                        // Style\n                        if (style && style[styleIndex]) {\n                            var columnName = jexcel.getColumnNameFromId([colIndex, rowIndex]);\n                            newStyle[columnName] = style[styleIndex];\n                            oldStyle[columnName] = obj.getStyle(columnName);\n                            obj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\n                            styleIndex++\n                        }\n                        i++;\n                        if (row[i] != null) {\n                            if (colIndex >= obj.headers.length - 1) {\n                                obj.insertColumn();\n                            }\n                            colIndex = obj.right.get(colIndex, rowIndex);\n                        }\n                    }\n    \n                    j++;\n                    if (data[j]) {\n                        if (rowIndex >= obj.rows.length-1) {\n                            obj.insertRow();\n                        }\n                        rowIndex = obj.down.get(x, rowIndex);\n                    }\n                }\n    \n                // Select the new cells\n                obj.updateSelectionFromCoords(x, y, colIndex, rowIndex);\n    \n                // Update history\n                obj.setHistory({\n                    action:'setValue',\n                    records:records,\n                    selection:obj.selectedCell,\n                    newStyle:newStyle,\n                    oldStyle:oldStyle,\n                });\n    \n                // Update table\n                obj.updateTable();\n    \n                // Paste event\r\n                obj.dispatch('onpaste', el, data);\n    \n                // On after changes\n                obj.onafterchanges(el, records);\n            }\r\n\r\n            obj.removeCopyingSelection();\n        }\n\r\n        /**\r\n         * Remove copying border\r\n         */\r\n        obj.removeCopyingSelection = function() {\r\n            var copying = document.querySelectorAll('.jexcel .copying');\r\n            for (var i = 0; i < copying.length; i++) {\r\n                copying[i].classList.remove('copying');\r\n                copying[i].classList.remove('copying-left');\r\n                copying[i].classList.remove('copying-right');\r\n                copying[i].classList.remove('copying-top');\r\n                copying[i].classList.remove('copying-bottom');\r\n            }\r\n        }\r\n\n        /**\n         * Process row\n         */\n        obj.historyProcessRow = function(type, historyRecord) {\n            var rowIndex = (! historyRecord.insertBefore) ? historyRecord.rowNumber + 1 : historyRecord.rowNumber;\n    \n            if (obj.options.search == true) {\n                if (obj.results && obj.results.length != obj.rows.length) {\n                    obj.resetSearch();\n                }\n            }\n    \n            // Remove row\n            if (type == 1) {\n                var numOfRows = historyRecord.numOfRows;\n                // Remove nodes\n                for (var j = rowIndex; j < (numOfRows + rowIndex); j++) {\n                    obj.rows[j].parentNode.removeChild(obj.rows[j]);\n                }\n                // Remove references\n                obj.records.splice(rowIndex, numOfRows);\n                obj.options.data.splice(rowIndex, numOfRows);\n                obj.rows.splice(rowIndex, numOfRows);\n    \n                obj.conditionalSelectionUpdate(1, rowIndex, (numOfRows + rowIndex) - 1);\n            } else {\n                // Insert data\n                obj.records = jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\n                obj.options.data = jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\n                obj.rows = jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode);\n                // Insert nodes\n                var index = 0\n                for (var j = rowIndex; j < (historyRecord.numOfRows + rowIndex); j++) {\n                    obj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\n                    index++;\n                }\n            }\n    \n            // Respect pagination\n            if (obj.options.pagination > 0) {\n                obj.page(obj.pageNumber);\n            }\n    \n            obj.updateTableReferences();\n        }\n    \n        /**\n         * Process column\n         */\n        obj.historyProcessColumn = function(type, historyRecord) {\n            var columnIndex = (! historyRecord.insertBefore) ? historyRecord.columnNumber + 1 : historyRecord.columnNumber;\n    \n            // Remove column\n            if (type == 1) {\n                var numOfColumns = historyRecord.numOfColumns;\n    \n                obj.options.columns.splice(columnIndex, numOfColumns);\n                for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                    obj.headers[i].parentNode.removeChild(obj.headers[i]);\n                    obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\n                }\n                obj.headers.splice(columnIndex, numOfColumns);\n                obj.colgroup.splice(columnIndex, numOfColumns);\n                for (var j = 0; j < historyRecord.data.length; j++) {\n                    for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\n                        obj.records[j][i].parentNode.removeChild(obj.records[j][i]);\n                    }\n                    obj.records[j].splice(columnIndex, numOfColumns);\n                    obj.options.data[j].splice(columnIndex, numOfColumns);\n                }\r\n                // Process footers\r\n                if (obj.options.footers) {\n                    for (var j = 0; j < obj.options.footers.length; j++) {\r\n                        obj.options.footers[j].splice(columnIndex, numOfColumns);\n                    }\r\n                }\n            } else {\n                // Insert data\n                obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\n                obj.headers = jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\n                obj.colgroup = jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\n    \r\n                var index = 0\n                for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                    obj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i+1]);\n                    obj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i+1]);\n                    index++;\n                }\n    \n                for (var j = 0; j < historyRecord.data.length; j++) {\n                    obj.options.data[j] = jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\n                    obj.records[j] = jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\n                    var index = 0\n                    for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\n                        obj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i+1]);\n                        index++;\n                    }\n                }\r\n                // Process footers\r\n                if (obj.options.footers) {\r\n                    for (var j = 0; j < obj.options.footers.length; j++) {\r\n                        obj.options.footers[j] = jexcel.injectArray(obj.options.footers[j], columnIndex, historyRecord.footers[j]);\r\n                    }\r\n                }\n            }\n    \n            // Adjust nested headers\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\n                // Flexible way to handle nestedheaders\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\n                        if (type == 1) {\n                            var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - historyRecord.numOfColumns;\n                        } else {\n                            var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + historyRecord.numOfColumns;\n                        }\n                        obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\n                        obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\n                    }\n                } else {\n                    if (type == 1) {\n                        var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\n                    } else {\n                        var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\n                    }\n                    obj.options.nestedHeaders[0].colspan = colspan;\n                    obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\n                }\n            }\n    \n            obj.updateTableReferences();\n        }\n    \n        /**\n         * Undo last action\n         */\n        obj.undo = function() {\n            // Ignore events and history\n            var ignoreEvents = obj.ignoreEvents ? true : false;\n            var ignoreHistory = obj.ignoreHistory ? true : false;\n    \n            obj.ignoreEvents = true;\n            obj.ignoreHistory = true;\n    \n            // Records\n            var records = [];\n    \n            // Update cells\n            if (obj.historyIndex >= 0) {\n                // History\n                var historyRecord = obj.history[obj.historyIndex--];\n    \n                if (historyRecord.action == 'insertRow') {\n                    obj.historyProcessRow(1, historyRecord);\n                } else if (historyRecord.action == 'deleteRow') {\n                    obj.historyProcessRow(0, historyRecord);\n                } else if (historyRecord.action == 'insertColumn') {\n                    obj.historyProcessColumn(1, historyRecord);\n                } else if (historyRecord.action == 'deleteColumn') {\n                    obj.historyProcessColumn(0, historyRecord);\n                } else if (historyRecord.action == 'moveRow') {\n                    obj.moveRow(historyRecord.newValue, historyRecord.oldValue);\n                } else if (historyRecord.action == 'moveColumn') {\n                    obj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\n                } else if (historyRecord.action == 'setMerge') {\n                    obj.removeMerge(historyRecord.column, historyRecord.data);\n                } else if (historyRecord.action == 'setStyle') {\n                    obj.setStyle(historyRecord.oldValue, null, null, 1);\n                } else if (historyRecord.action == 'setWidth') {\n                    obj.setWidth(historyRecord.column, historyRecord.oldValue);\n                } else if (historyRecord.action == 'setHeight') {\n                    obj.setHeight(historyRecord.row, historyRecord.oldValue);\n                } else if (historyRecord.action == 'setHeader') {\n                    obj.setHeader(historyRecord.column, historyRecord.oldValue);\n                } else if (historyRecord.action == 'setComments') {\n                    obj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\n                } else if (historyRecord.action == 'orderBy') {\n                    var rows = [];\n                    for (var j = 0; j < historyRecord.rows.length; j++) {\n                        rows[historyRecord.rows[j]] = j;\n                    }\n                    obj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\n                    obj.updateOrder(rows);\n                } else if (historyRecord.action == 'setValue') {\r\n                    // Redo for changes in cells\r\n                    for (var i = 0; i < historyRecord.records.length; i++) {\r\n                        records.push({\r\n                            x: historyRecord.records[i].x,\r\n                            y: historyRecord.records[i].y,\r\n                            newValue: historyRecord.records[i].oldValue,\r\n                        });\r\n\r\n                        if (historyRecord.oldStyle) {\r\n                            obj.resetStyle(historyRecord.oldStyle);\r\n                        }\r\n                    }\r\n                    // Update records\r\n                    obj.setValue(records);\r\n\r\n                    // Update selection\r\n                    if (historyRecord.selection) {\r\n                        obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\r\n                    }\n                }\n            }\n            obj.ignoreEvents = ignoreEvents;\n            obj.ignoreHistory = ignoreHistory;\n    \r\n            // Events\r\n            obj.dispatch('onundo', el, historyRecord);\n        }\n    \n        /**\n         * Redo previously undone action\n         */\n        obj.redo = function() {\n            // Ignore events and history\n            var ignoreEvents = obj.ignoreEvents ? true : false;\n            var ignoreHistory = obj.ignoreHistory ? true : false;\n    \n            obj.ignoreEvents = true;\n            obj.ignoreHistory = true;\n    \n            // Records\n            var records = [];\n    \n            // Update cells\n            if (obj.historyIndex < obj.history.length - 1) {\n                // History\n                var historyRecord = obj.history[++obj.historyIndex];\n    \n                if (historyRecord.action == 'insertRow') {\n                    obj.historyProcessRow(0, historyRecord);\n                } else if (historyRecord.action == 'deleteRow') {\n                    obj.historyProcessRow(1, historyRecord);\n                } else if (historyRecord.action == 'insertColumn') {\n                    obj.historyProcessColumn(0, historyRecord);\n                } else if (historyRecord.action == 'deleteColumn') {\n                    obj.historyProcessColumn(1, historyRecord);\n                } else if (historyRecord.action == 'moveRow') {\n                    obj.moveRow(historyRecord.oldValue, historyRecord.newValue);\n                } else if (historyRecord.action == 'moveColumn') {\n                    obj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\n                } else if (historyRecord.action == 'setMerge') {\n                    obj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\n                } else if (historyRecord.action == 'setStyle') {\n                    obj.setStyle(historyRecord.newValue, null, null, 1);\n                } else if (historyRecord.action == 'setWidth') {\n                    obj.setWidth(historyRecord.column, historyRecord.newValue);\n                } else if (historyRecord.action == 'setHeight') {\n                    obj.setHeight(historyRecord.row, historyRecord.newValue);\n                } else if (historyRecord.action == 'setHeader') {\n                    obj.setHeader(historyRecord.column, historyRecord.newValue);\n                } else if (historyRecord.action == 'setComments') {\n                    obj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\n                } else if (historyRecord.action == 'orderBy') {\n                    obj.updateOrderArrow(historyRecord.column, historyRecord.order);\n                    obj.updateOrder(historyRecord.rows);\n                } else if (historyRecord.action == 'setValue') {\r\n                    obj.setValue(historyRecord.records);\r\n                    // Redo for changes in cells\r\n                    for (var i = 0; i < historyRecord.records.length; i++) {\r\n                        if (historyRecord.oldStyle) {\r\n                            obj.resetStyle(historyRecord.newStyle);\r\n                        }\r\n                    }\r\n                    // Update selection\r\n                    if (historyRecord.selection) {\r\n                        obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\r\n                    }\n                }\n            }\n            obj.ignoreEvents = ignoreEvents;\n            obj.ignoreHistory = ignoreHistory;\n    \r\n            // Events\r\n            obj.dispatch('onredo', el, historyRecord);\n        }\n    \n        /**\n         * Get dropdown value from key\n         */\n        obj.getDropDownValue = function(column, key) {\n            var value = [];\n    \n            if (obj.options.columns[column] && obj.options.columns[column].source) {\n                // Create array from source\n                var combo = [];\n                var source = obj.options.columns[column].source;\n    \n                for (var i = 0; i < source.length; i++) {\n                    if (typeof(source[i]) == 'object') {\n                        combo[source[i].id] = source[i].name;\n                    } else {\n                        combo[source[i]] = source[i];\n                    }\n                }\n    \n                // Garante single multiple compatibily\n                var keys = ('' + key).split(';')\n    \n                for (var i = 0; i < keys.length; i++) {\n                    if (combo[keys[i]]) {\n                        value.push(combo[keys[i]]);\n                    }\n                }\n            } else {\n                console.error('Invalid column');\n            }\n    \n            return (value.length > 0) ? value.join('; ') : '';\n        }\n    \n        /**\n         * From starckoverflow contributions\n         */\n        obj.parseCSV = function(str, delimiter) {\n            // Remove last line break\n            str = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\");\n            // Last caracter is the delimiter\n            if (str.charCodeAt(str.length-1) == 9) {\n                str += \"\\0\";\n            }\n            // user-supplied delimeter or default comma\n            delimiter = (delimiter || \",\");\n    \n            var arr = [];\n            var quote = false;  // true means we're inside a quoted field\n            // iterate over each character, keep track of current row and column (of the returned array)\n            for (var row = 0, col = 0, c = 0; c < str.length; c++) {\n                var cc = str[c], nc = str[c+1];\n                arr[row] = arr[row] || [];\n                arr[row][col] = arr[row][col] || '';\n    \n                // If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\n                if (cc == '\"' && quote && nc == '\"') { arr[row][col] += cc; ++c; continue; }  \n    \n                // If it's just one quotation mark, begin/end quoted field\n                if (cc == '\"') { quote = !quote; continue; }\n    \n                // If it's a comma and we're not in a quoted field, move on to the next column\n                if (cc == delimiter && !quote) { ++col; continue; }\n    \n                // If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\n                if (cc == '\\r' && nc == '\\n' && !quote) { ++row; col = 0; ++c; continue; }\n    \n                // If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\n                if (cc == '\\n' && !quote) { ++row; col = 0; continue; }\n                if (cc == '\\r' && !quote) { ++row; col = 0; continue; }\n    \n                // Otherwise, append the current character to the current column\n                arr[row][col] += cc;\n            }\n            return arr;\n        }\n    \n        obj.hash = function(str) {\n            var hash = 0, i, chr;\n    \n            if (str.length === 0) {\n                return hash;\n            } else {\n                for (i = 0; i < str.length; i++) {\n                  chr = str.charCodeAt(i);\n                  hash = ((hash << 5) - hash) + chr;\n                  hash |= 0;\n                }\n            }\n            return hash;\n        }\n    \n        obj.onafterchanges = function(el, records) {\r\n            // Events\r\n            obj.dispatch('onafterchanges', el, records);\r\n        }\n    \r\n        obj.destroy = function() {\r\n            jexcel.destroy(el);\r\n        }\r\n\n        /**\n         * Initialization method\n         */\n        obj.init = function() {\n            jexcel.current = obj;\n    \n            // Build handlers\n            if (typeof(jexcel.build) == 'function') {\n                if (obj.options.root) {\r\n                    jexcel.build(obj.options.root);\r\n                } else {\r\n                    jexcel.build(document);\r\n                    jexcel.build = null;\n                }\n            }\n    \n            // Event\r\n            el.setAttribute('tabindex', 1);\r\n            el.addEventListener('focus', function(e) {\r\n                if (jexcel.current && ! obj.selectedCell) {\r\n                    obj.updateSelectionFromCoords(0,0,0,0);\r\n                    obj.left();\r\n                }\r\n            });\r\n\n            // Load the table data based on an CSV file\n            if (obj.options.csv) {\n                // Loading\n                if (obj.options.loadingSpin == true) {\n                    jSuites.loading.show();\n                }\n    \n                // Load CSV file\n                jSuites.ajax({\n                    url: obj.options.csv,\n                    method: 'GET',\n                    dataType: 'text',\n                    success: function(result) {\n                        // Convert data\n                        var newData = obj.parseCSV(result, obj.options.csvDelimiter)\n    \n                        // Headers\n                        if (obj.options.csvHeaders == true && newData.length > 0) {\n                            var headers = newData.shift();\n                            for(var i = 0; i < headers.length; i++) {\n                                if (! obj.options.columns[i]) {\n                                    obj.options.columns[i] = { type:'text', align:obj.options.defaultColAlign, width:obj.options.defaultColWidth };\n                                }\n                                // Precedence over pre-configurated titles\n                                if (typeof obj.options.columns[i].title === 'undefined') {\n                                  obj.options.columns[i].title = headers[i];\n                                }\n                            }\n                        }\n                        // Data\n                        obj.options.data = newData;\n                        // Prepare table\n                        obj.prepareTable();\n                        // Hide spin\n                        if (obj.options.loadingSpin == true) {\n                            jSuites.loading.hide();\n                        }\n                    }\n                });\n            } else if (obj.options.url) {\n                // Loading\n                if (obj.options.loadingSpin == true) {\n                    jSuites.loading.show();\n                }\n    \n                jSuites.ajax({\n                    url: obj.options.url,\n                    method: 'GET',\n                    dataType: 'json',\n                    success: function(result) {\n                        // Data\n                        obj.options.data = (result.data) ? result.data : result;\n                        // Prepare table\n                        obj.prepareTable();\n                        // Hide spin\n                        if (obj.options.loadingSpin == true) {\n                            jSuites.loading.hide();\n                        }\n                    }\n                });\n            } else {\n                // Prepare table\n                obj.prepareTable();\n            }\n        }\n    \n        // Context menu\n        if (options && options.contextMenu != null) {\n            obj.options.contextMenu = options.contextMenu;\n        } else {\n            obj.options.contextMenu = function(el, x, y, e) {\n                var items = [];\n    \n                if (y == null) {\n                    // Insert a new column\n                    if (obj.options.allowInsertColumn == true) {\n                        items.push({\n                            title:obj.options.text.insertANewColumnBefore,\n                            onclick:function() {\n                                obj.insertColumn(1, parseInt(x), 1);\n                            }\n                        });\n                    }\n    \n                    if (obj.options.allowInsertColumn == true) {\n                        items.push({\n                            title:obj.options.text.insertANewColumnAfter,\n                            onclick:function() {\n                                obj.insertColumn(1, parseInt(x), 0);\n                            }\n                        });\n                    }\n    \n                    // Delete a column\n                    if (obj.options.allowDeleteColumn == true) {\n                        items.push({\n                            title:obj.options.text.deleteSelectedColumns,\n                            onclick:function() {\n                                obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\n                            }\n                        });\n                    }\n    \n                    // Rename column\n                    if (obj.options.allowRenameColumn == true) {\n                        items.push({\n                            title:obj.options.text.renameThisColumn,\n                            onclick:function() {\n                                obj.setHeader(x);\n                            }\n                        });\n                    }\n    \n                    // Sorting\n                    if (obj.options.columnSorting == true) {\n                        // Line\n                        items.push({ type:'line' });\n    \n                        items.push({\n                            title:obj.options.text.orderAscending,\n                            onclick:function() {\n                                obj.orderBy(x, 0);\n                            }\n                        });\n                        items.push({\n                            title:obj.options.text.orderDescending,\n                            onclick:function() {\n                                obj.orderBy(x, 1);\n                            }\n                        });\n                    }\n                } else {\n                    // Insert new row\n                    if (obj.options.allowInsertRow == true) {\n                        items.push({\n                            title:obj.options.text.insertANewRowBefore,\n                            onclick:function() {\n                                obj.insertRow(1, parseInt(y), 1);\n                            }\n                        });\n    \n                        items.push({\n                            title:obj.options.text.insertANewRowAfter,\n                            onclick:function() {\n                                obj.insertRow(1, parseInt(y));\n                            }\n                        });\n                    }\n    \n                    if (obj.options.allowDeleteRow == true) {\n                        items.push({\n                            title:obj.options.text.deleteSelectedRows,\n                            onclick:function() {\n                                obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\n                            }\n                        });\n                    }\n    \n                    if (x) {\n                        if (obj.options.allowComments == true) {\n                            items.push({ type:'line' });\n    \n                            var title = obj.records[y][x].getAttribute('title') || '';\r\n\r\n                            items.push({\n                                title: title ? obj.options.text.editComments : obj.options.text.addComments,\n                                onclick:function() {\r\n                                    var comment = prompt(obj.options.text.comments, title);\r\n                                    if (comment) {\r\n                                        obj.setComments([ x, y ], comment);\r\n                                    }\n                                }\n                            });\n    \n                            if (title) {\n                                items.push({\n                                    title:obj.options.text.clearComments,\n                                    onclick:function() {\n                                        obj.setComments([ x, y ], '');\n                                    }\n                                });\n                            }\n                        }\n                    }\n                }\n    \n                // Line\n                items.push({ type:'line' });\n    \n                // Copy\n                items.push({\n                    title:obj.options.text.copy,\n                    shortcut:'Ctrl + C',\n                    onclick:function() {\n                        obj.copy(true);\n                    }\n                });\n    \n                // Paste\n                if (navigator && navigator.clipboard) {\n                    items.push({\n                        title:obj.options.text.paste,\n                        shortcut:'Ctrl + V',\n                        onclick:function() {\n                            if (obj.selectedCell) {\n                                navigator.clipboard.readText().then(function(text) {\n                                    if (text) {\n                                        jexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\n                                    }\n                                });\n                            }\n                        }\n                    });\n                }\n    \n                // Save\n                if (obj.options.allowExport) {\n                    items.push({\n                        title: obj.options.text.saveAs,\n                        shortcut: 'Ctrl + S',\n                        onclick: function () {\n                            obj.download();\n                        }\n                    });\n                }\n    \n                // About\n                if (obj.options.about) {\n                    items.push({\n                        title:obj.options.text.about,\n                        onclick:function() {\n                            alert(obj.options.about);\n                        }\n                    });\n                }\n    \n                return items;\n            }\n        }\n    \n        obj.scrollControls = function(e) {\r\n            obj.wheelControls();\r\n\n            if (obj.options.freezeColumns > 0 && obj.content.scrollLeft != scrollLeft) {\r\n                obj.updateFreezePosition();\r\n            }\r\n\n            // Close editor\n            if (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\n                if (obj.edition && e.target.className.substr(0,9) != 'jdropdown') {\n                    obj.closeEditor(obj.edition[0], true);\n                }\n            }\n        }\n\r\n        obj.wheelControls = function(e) {\r\n            if (obj.options.lazyLoading == true) {\r\n                if (jexcel.timeControlLoading == null) {\r\n                    jexcel.timeControlLoading = setTimeout(function() {\r\n                        if (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight) {\r\n                            if (obj.loadDown()) {\r\n                                if (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\r\n                                    obj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\r\n                                }\r\n                                obj.updateCornerPosition();\r\n                            }\r\n                        } else if (obj.content.scrollTop <= obj.content.clientHeight) {\r\n                            if (obj.loadUp()) {\r\n                                if (obj.content.scrollTop < 10) {\r\n                                    obj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\r\n                                }\r\n                                obj.updateCornerPosition();\r\n                            }\r\n                        }\r\n    \r\n                        jexcel.timeControlLoading = null;\r\n                    }, 100);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Get width of all freezed cells together\r\n        obj.getFreezeWidth = function() {\r\n            var width = 0;\r\n            if (obj.options.freezeColumns > 0) {\r\n                for (var i = 0; i < obj.options.freezeColumns; i++) {\r\n                    width += parseInt(obj.options.columns[i].width);\r\n                }\r\n            }\r\n            return width;\r\n        }\r\n\r\n        var scrollLeft = 0;\r\n\r\n        obj.updateFreezePosition = function() {\r\n            scrollLeft = obj.content.scrollLeft;\r\n            var width = 0;\r\n            if (scrollLeft > 50) {\r\n                for (var i = 0; i < obj.options.freezeColumns; i++) {\r\n                    if (i > 0) {\r\n                        width += parseInt(obj.options.columns[i-1].width);\r\n                    }\r\n                    obj.headers[i].classList.add('jexcel_freezed');\r\n                    obj.headers[i].style.left = width + 'px';\r\n                    for (var j = 0; j < obj.rows.length; j++) {\r\n                        if (obj.rows[j] && obj.records[j][i]) {\r\n                            var shifted = (scrollLeft + (i > 0 ? obj.records[j][i-1].style.width : 0)) - 51 + 'px';\r\n                            obj.records[j][i].classList.add('jexcel_freezed');\r\n                            obj.records[j][i].style.left = shifted;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                for (var i = 0; i < obj.options.freezeColumns; i++) {\r\n                    obj.headers[i].classList.remove('jexcel_freezed');\r\n                    obj.headers[i].style.left = '';\r\n                    for (var j = 0; j < obj.rows.length; j++) {\r\n                        if (obj.records[j][i]) {\r\n                            obj.records[j][i].classList.remove('jexcel_freezed');\r\n                            obj.records[j][i].style.left = '';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Place the corner in the correct place\r\n            obj.updateCornerPosition();\r\n        }\r\n\n        el.addEventListener(\"DOMMouseScroll\", obj.wheelControls);\n        el.addEventListener(\"mousewheel\", obj.wheelControls);\n    \n        el.jexcel = obj;\n    \n        obj.init();\n    \n        return obj;\n    });\n    \n    jexcel.current = null;\n    jexcel.timeControl = null;\n    jexcel.timeControlLoading = null;\n    \n    jexcel.destroy = function(element, destroyEventHandlers) {\n        if (element.jexcel) {\n            var root = element.jexcel.options.root ? element.jexcel.options.root : document;\n            element.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\n            element.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\n            element.jexcel = null;\n            element.innerHTML = '';\n    \n            if (destroyEventHandlers) {\n                root.removeEventListener(\"mouseup\", jexcel.mouseUpControls);\n                root.removeEventListener(\"mousedown\", jexcel.mouseDownControls);\n                root.removeEventListener(\"mousemove\", jexcel.mouseMoveControls);\n                root.removeEventListener(\"mouseover\", jexcel.mouseOverControls);\n                root.removeEventListener(\"dblclick\", jexcel.doubleClickControls);\n                root.removeEventListener(\"paste\", jexcel.pasteControls);\n                root.removeEventListener(\"contextmenu\", jexcel.contextMenuControls);\n                root.removeEventListener(\"touchstart\", jexcel.touchStartControls);\n                root.removeEventListener(\"touchend\", jexcel.touchEndControls);\n                root.removeEventListener(\"touchcancel\", jexcel.touchEndControls);\r\n                document.removeEventListener(\"keydown\", jexcel.keyDownControls);\n                jexcel = null;\n            }\n        }\n    }\n    \n    jexcel.build = function(root) {\n        root.addEventListener(\"mouseup\", jexcel.mouseUpControls);\n        root.addEventListener(\"mousedown\", jexcel.mouseDownControls);\n        root.addEventListener(\"mousemove\", jexcel.mouseMoveControls);\n        root.addEventListener(\"mouseover\", jexcel.mouseOverControls);\n        root.addEventListener(\"dblclick\", jexcel.doubleClickControls);\n        root.addEventListener(\"paste\", jexcel.pasteControls);\n        root.addEventListener(\"contextmenu\", jexcel.contextMenuControls);\n        root.addEventListener(\"touchstart\", jexcel.touchStartControls);\n        root.addEventListener(\"touchend\", jexcel.touchEndControls);\n        root.addEventListener(\"touchcancel\", jexcel.touchEndControls);\n        root.addEventListener(\"touchmove\", jexcel.touchEndControls);\r\n        document.addEventListener(\"keydown\", jexcel.keyDownControls);\n    }\n    \n    /**\n     * Events\n     */\n    jexcel.keyDownControls = function(e) {\n        if (jexcel.current) {\n            if (jexcel.current.edition) {\n                if (e.which == 27) {\n                    // Escape\n                    if (jexcel.current.edition) {\n                        // Exit without saving\n                        jexcel.current.closeEditor(jexcel.current.edition[0], false);\n                    }\n                    e.preventDefault();\n                } else if (e.which == 13) {\n                    // Enter\n                    if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                    } else if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'dropdown' ||\n                               jexcel.current.options.columns[jexcel.current.edition[2]].type == 'autocomplete') {\n                        // Do nothing\n                    } else {\n                        // Alt enter -> do not close editor\n                        if ((jexcel.current.options.wordWrap == true ||\n                             jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap == true ||\n                             jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length > 200) && e.altKey) {\n                            // Add new line to the editor\n                            var editorTextarea = jexcel.current.edition[0].children[0];\n                            var editorValue = jexcel.current.edition[0].children[0].value;\n                            var editorIndexOf = editorTextarea.selectionStart;\n                            editorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\n                            editorTextarea.value = editorValue;\n                            editorTextarea.focus();\n                            editorTextarea.selectionStart = editorIndexOf + 1;\n                            editorTextarea.selectionEnd = editorIndexOf + 1;\n                        } else {\n                            jexcel.current.edition[0].children[0].blur();\n                        }\n                    }\n                } else if (e.which == 9) {\n                    // Tab\n                    if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                    } else {\n                        jexcel.current.edition[0].children[0].blur();\n                    }\n                }\n            }\n    \n            if (! jexcel.current.edition && jexcel.current.selectedCell) {\r\n                // Which key\n                if (e.which == 37) {\n                    jexcel.current.left(e.shiftKey, e.ctrlKey);\n                    e.preventDefault();\n                } else if (e.which == 39) {\n                    jexcel.current.right(e.shiftKey, e.ctrlKey);\n                    e.preventDefault();\n                } else if (e.which == 38) {\n                    jexcel.current.up(e.shiftKey, e.ctrlKey);\n                    e.preventDefault();\n                } else if (e.which == 40) {\n                    jexcel.current.down(e.shiftKey, e.ctrlKey);\n                    e.preventDefault();\n                } else if (e.which == 36) {\n                    jexcel.current.first(e.shiftKey, e.ctrlKey);\n                    e.preventDefault();\n                } else if (e.which == 35) {\n                    jexcel.current.last(e.shiftKey, e.ctrlKey);\n                    e.preventDefault();\n                } else if (e.which == 32) {\n                    if (jexcel.current.options.editable == true) {\n                        jexcel.current.setCheckRadioValue();\n                    }\n                    e.preventDefault();\n                } else if (e.which == 46) {\n                    // Delete\n                    if (jexcel.current.options.editable == true) {\n                        if (jexcel.current.selectedRow) {\n                            if (jexcel.current.options.allowDeleteRow == true) {\n                                if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\n                                    jexcel.current.deleteRow();\n                                }\n                            }\n                        } else if (jexcel.current.selectedHeader) {\n                            if (jexcel.current.options.allowDeleteColumn == true) {\n                                if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\n                                    jexcel.current.deleteColumn();\n                                }\n                            }\n                        } else {\n                            // Change value\n                            jexcel.current.setValue(jexcel.current.highlighted, '');\n                        }\n                    }\n                } else if (e.which == 13) {\n                    // Move cursor\n                    if (e.shiftKey) {\n                        jexcel.current.up();\n                    } else {\n                        if (jexcel.current.options.allowInsertRow == true) {\n                            if (jexcel.current.options.allowManualInsertRow == true) {\n                                if (jexcel.current.selectedCell[1] == jexcel.current.options.data.length - 1) {\n                                    // New record in case selectedCell in the last row\n                                    jexcel.current.insertRow();\n                                }\n                            }\n                        }\n    \n                        jexcel.current.down();\n                    }\n                    e.preventDefault();\n                } else if (e.which == 9) {\n                    // Tab\n                    if (e.shiftKey) {\n                        jexcel.current.left();\n                    } else {\n                        if (jexcel.current.options.allowInsertColumn == true) {\n                            if (jexcel.current.options.allowManualInsertColumn == true) {\n                                if (jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1) {\n                                    // New record in case selectedCell in the last column\n                                    jexcel.current.insertColumn();\n                                }\n                            }\n                        }\n    \n                        jexcel.current.right();\n                    }\n                    e.preventDefault();\n                } else {\n                    if ((e.ctrlKey || e.metaKey) && ! e.shiftKey) {\n                        if (e.which == 65) {\n                            // Ctrl + A\n                            jexcel.current.selectAll();\n                            e.preventDefault();\n                        } else if (e.which == 83) {\n                            // Ctrl + S\n                            jexcel.current.download();\n                            e.preventDefault();\n                        } else if (e.which == 89) {\n                            // Ctrl + Y\n                            jexcel.current.redo();\n                            e.preventDefault();\n                        } else if (e.which == 90) {\n                            // Ctrl + Z\n                            jexcel.current.undo();\n                            e.preventDefault();\n                        } else if (e.which == 67) {\n                            // Ctrl + C\n                            jexcel.current.copy(true);\n                            e.preventDefault();\n                        } else if (e.which == 67) {\n                            // Ctrl + C\n                            jexcel.current.copy(true);\n                            e.preventDefault();\n                        } else if (e.which == 88) {\n                            // Ctrl + X\n                            if (jexcel.current.options.editable == true) {\n                                jexcel.cutControls();\n                            } else {\n                                jexcel.copyControls();\n                            }\n                            e.preventDefault();\n                        } else if (e.which == 86) {\n                            // Ctrl + V\n                            jexcel.pasteControls();\n                        }\n                    } else {\n                        if (jexcel.current.selectedCell) {\n                            if (jexcel.current.options.editable == true) {\n                                var rowId = jexcel.current.selectedCell[1];\n                                var columnId = jexcel.current.selectedCell[0];\n    \n                                // If is not readonly\n                                if (jexcel.current.options.columns[columnId].type != 'readonly') {\n                                    // Characters able to start a edition\n                                    if (e.keyCode == 32) {\n                                        // Space\n                                        if (jexcel.current.options.columns[columnId].type == 'checkbox' ||\n                                            jexcel.current.options.columns[columnId].type == 'radio') {\n                                            e.preventDefault();\n                                        } else {\n                                            // Start edition\n                                            jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                        }\n                                    } else if (e.keyCode == 113) {\n                                        // Start edition with current content F2\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], false);\n                                    } else if ((e.keyCode == 8) ||\n                                               (e.keyCode >= 48 && e.keyCode <= 57) ||\n                                               (e.keyCode >= 96 && e.keyCode <= 111) ||\n                                               (e.keyCode == 187) ||\n                                               (e.keyCode == 189) ||\n                                               ((String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && jexcel.validLetter(String.fromCharCode(e.keyCode)))) {\n                                        // Start edition\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\n                                        // Prevent entries in the calendar\n                                        if (jexcel.current.options.columns[columnId].type == 'calendar') {\n                                            e.preventDefault();\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            } else {\r\n                if (e.target.classList.contains('jexcel_search')) {\n                    if (jexcel.timeControl) {\n                        clearTimeout(jexcel.timeControl);\n                    }\n    \n                    jexcel.timeControl = setTimeout(function() {\n                        jexcel.current.search(e.target.value);\n                    }, 200);\n                }\n            }\n        }\n    }\n    \n    jexcel.isMouseAction = false;\n    \n    jexcel.mouseDownControls = function(e) {\n        e = e || window.event;\n        if (e.buttons) {\n            var mouseButton = e.buttons;\n        } else if (e.button) {\n            var mouseButton = e.button;\n        } else {\n            var mouseButton = e.which;\n        }\n\n        // Get elements\n        var jexcelTable = jexcel.getElement(e.target);\n\n        if (jexcelTable[0]) {\n            if (jexcel.current != jexcelTable[0].jexcel) {\n                if (jexcel.current) {\r\n                    if (jexcel.current.edition) {\r\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                    }\n                    jexcel.current.resetSelection();\n                }\n                jexcel.current = jexcelTable[0].jexcel;\n            }\n        } else {\n            if (jexcel.current) {\r\n                if (jexcel.current.edition) {\r\n                    jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                }\r\n                \n                jexcel.current.resetSelection(true);\n                jexcel.current = null;\n            }\n        }\n    \n        if (jexcel.current && mouseButton == 1) {\n            if (e.target.classList.contains('jexcel_selectall')) {\n                if (jexcel.current) {\n                    jexcel.current.selectAll();\n                }\n            } else if (e.target.classList.contains('jexcel_corner')) {\n                if (jexcel.current.options.editable == true) {\n                    jexcel.current.selectedCorner = true;\n                }\n            } else {\n                // Header found\n                if (jexcelTable[1] == 1) {\n                    var columnId = e.target.getAttribute('data-x');\n                    if (columnId) {\n                        // Update cursor\n                        var info = e.target.getBoundingClientRect();\n                        if (jexcel.current.options.columnResize == true && info.width - e.offsetX < 6) {\n                            // Resize helper\n                            jexcel.current.resizing = {\n                                mousePosition: e.pageX,\n                                column: columnId,\n                                width: info.width,\n                            };\n    \n                            // Border indication\n                            jexcel.current.headers[columnId].classList.add('resizing');\n                            for (var j = 0; j < jexcel.current.records.length; j++) {\n                                if (jexcel.current.records[j][columnId]) {\n                                    jexcel.current.records[j][columnId].classList.add('resizing');\n                                }\n                            }\n                        } else if (jexcel.current.options.columnDrag == true && info.height - e.offsetY < 6) {\n                            if (jexcel.current.isColMerged(columnId).length) {\n                                console.error('JEXCEL: This column is part of a merged cell.');\n                            } else {\n                                // Reset selection\n                                jexcel.current.resetSelection();\n                                // Drag helper\n                                jexcel.current.dragging = {\n                                    element: e.target,\n                                    column:columnId,\n                                    destination:columnId,\n                                };\n                                // Border indication\n                                jexcel.current.headers[columnId].classList.add('dragging');\n                                for (var j = 0; j < jexcel.current.records.length; j++) {\n                                    if (jexcel.current.records[j][columnId]) {\n                                        jexcel.current.records[j][columnId].classList.add('dragging');\n                                    }\n                                }\n                            }\n                        } else {\n                            if (jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\n                                var o = jexcel.current.selectedHeader;\n                                var d = columnId;\n                            } else {\n                                // Press to rename\n                                if (jexcel.current.selectedHeader == columnId && jexcel.current.options.allowRenameColumn == true) {\n                                    jexcel.timeControl = setTimeout(function() {\n                                        jexcel.current.setHeader(columnId);\n                                    }, 800);\n                                }\n    \n                                // Keep track of which header was selected first\n                                jexcel.current.selectedHeader = columnId;\n    \n                                // Update selection single column\n                                var o = columnId;\n                                var d = columnId;\n                            }\n    \n                            // Update selection\n                            jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                        }\n                    } else {\n                        if (e.target.parentNode.classList.contains('jexcel_nested')) {\r\n                            if (e.target.getAttribute('data-column')) {\n                                var column = e.target.getAttribute('data-column').split(',');\r\n                                var c1 = parseInt(column[0]);\r\n                                var c2 = parseInt(column[column.length-1]);\r\n                            } else {\r\n                                var c1 = 0;\r\n                                var c2 = jexcel.current.options.columns.length - 1;\r\n                            }\n                            jexcel.current.updateSelectionFromCoords(c1, 0, c2, jexcel.current.options.data.length - 1);\n                        }\n                    }\n                } else {\n                    jexcel.current.selectedHeader = false;\n                }\n    \n                // Body found\n                if (jexcelTable[1] == 2) {\n                    var rowId = e.target.getAttribute('data-y');\n                    \n                    if (e.target.classList.contains('jexcel_row')) {\n                        var info = e.target.getBoundingClientRect();\n                        if (jexcel.current.options.rowResize == true && info.height - e.offsetY < 6) {\n                            // Resize helper\n                            jexcel.current.resizing = {\n                                element: e.target.parentNode,\n                                mousePosition: e.pageY,\n                                row: rowId,\n                                height: info.height,\n                            };\n                            // Border indication\n                            e.target.parentNode.classList.add('resizing');\n                        } else if (jexcel.current.options.rowDrag == true && info.width - e.offsetX < 6) {\n                            if (jexcel.current.isRowMerged(rowId).length) {\n                                console.error('JEXCEL: This row is part of a merged cell');\n                            } else if (jexcel.current.options.search == true && jexcel.current.results) {\n                                console.error('JEXCEL: Please clear your search before perform this action');\n                            } else {\n                                // Reset selection\n                                jexcel.current.resetSelection();\n                                // Drag helper\n                                jexcel.current.dragging = {\n                                    element: e.target.parentNode,\n                                    row:rowId,\n                                    destination:rowId,\n                                };\n                                // Border indication\n                                e.target.parentNode.classList.add('dragging');\n                            }\n                        } else {\n                            if (jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\n                                var o = jexcel.current.selectedRow;\n                                var d = rowId;\n                            } else {\n                                // Keep track of which header was selected first\n                                jexcel.current.selectedRow = rowId;\n    \n                                // Update selection single column\n                                var o = rowId;\n                                var d = rowId;\n                            }\n    \n                            // Update selection\n                            jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                        }\n                    } else {\r\n                        // Jclose\n                        if (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\n                            jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                        } else {\n                            var getCellCoords = function(element) {\n                                var x = element.getAttribute('data-x');\n                                var y = element.getAttribute('data-y');\n                                if (x && y) {\n                                    return [x, y];\n                                } else {\n                                    if (element.parentNode) {\n                                        return getCellCoords(element.parentNode);\n                                    }\n                                }\n                            };\n\n                            var position = getCellCoords(e.target);\n                            if (position) {\r\n\n                                var columnId = position[0];\n                                var rowId = position[1];\n                                // Close edition\n                                if (jexcel.current.edition) {\n                                    if (jexcel.current.edition[2] != columnId || jexcel.current.edition[3] != rowId) {\n                                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\n                                    }\r\n                                }\r\n\n                                if (! jexcel.current.edition) {\n                                    // Update cell selection\n                                    if (e.shiftKey) {\n                                        jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                    } else {\n                                        jexcel.current.updateSelectionFromCoords(columnId, rowId);\n                                    }\n                                }\n\n                                // No full row selected\n                                jexcel.current.selectedHeader = null;\n                                jexcel.current.selectedRow = null;\n                            }\n                        }\n                    }\n                } else {\n                    jexcel.current.selectedRow = false;\n                }\n    \n                // Pagination\n                if (e.target.classList.contains('jexcel_page')) {\n                    if (e.target.innerText == '<') {\n                        jexcel.current.page(0);\n                    } else if (e.target.innerText == '>') {\n                        jexcel.current.page(e.target.getAttribute('title') - 1);\n                    } else {\n                        jexcel.current.page(e.target.innerText - 1);\n                    }\n                }\n            }\n    \n            if (jexcel.current.edition) {\n                jexcel.isMouseAction = false;\n            } else {\n                jexcel.isMouseAction = true;\n            }\n        } else {\n            jexcel.isMouseAction = false;\n        }\n    }\n    \n    jexcel.mouseUpControls = function(e) {\n        if (jexcel.current) {\n            // Update cell size\n            if (jexcel.current.resizing) {\n                // Columns to be updated\n                if (jexcel.current.resizing.column) {\r\n                    // New width\r\n                    var newWidth = jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute('width');\r\n                    // Columns\r\n                    var columns = jexcel.current.getSelectedColumns();\r\n                    if (columns.length > 1) {\r\n                        var currentWidth = [];\r\n                        for (var i = 0; i < columns.length; i++) {\r\n                            currentWidth.push(parseInt(jexcel.current.colgroup[columns[i]].getAttribute('width')));\r\n                        }\r\n                        // Previous width\r\n                        var index = columns.indexOf(parseInt(jexcel.current.resizing.column));\r\n                        currentWidth[index] = jexcel.current.resizing.width;\r\n                        jexcel.current.setWidth(columns, newWidth, currentWidth);\r\n                    } else {\r\n                        jexcel.current.setWidth(jexcel.current.resizing.column, newWidth, jexcel.current.resizing.width);\r\n                    }\r\n                    // Remove border\r\n                    jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\r\n                    for (var j = 0; j < jexcel.current.records.length; j++) {\r\n                        if (jexcel.current.records[j][jexcel.current.resizing.column]) {\r\n                            jexcel.current.records[j][jexcel.current.resizing.column].classList.remove('resizing');\r\n                        }\r\n                    }\n                } else {\n                    // Remove Class\n                    jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove('resizing');\n                    var newHeight = jexcel.current.rows[jexcel.current.resizing.row].getAttribute('height');\n                    jexcel.current.setHeight(jexcel.current.resizing.row, newHeight, jexcel.current.resizing.height);\n                    // Remove border\n                    jexcel.current.resizing.element.classList.remove('resizing');\n                }\n                // Reset resizing helper\n                jexcel.current.resizing = null;\n            } else if (jexcel.current.dragging) {\n                // Reset dragging helper\n                if (jexcel.current.dragging) {\n                    if (jexcel.current.dragging.column) {\n                        // Target\n                        var columnId = e.target.getAttribute('data-x');\n                        // Remove move style\n                        jexcel.current.headers[jexcel.current.dragging.column].classList.remove('dragging');\n                        for (var j = 0; j < jexcel.current.rows.length; j++) {\n                            if (jexcel.current.records[j][jexcel.current.dragging.column]) {\n                                jexcel.current.records[j][jexcel.current.dragging.column].classList.remove('dragging');\n                            }\n                        }\n                        for (var i = 0; i < jexcel.current.headers.length; i++) {\n                            jexcel.current.headers[i].classList.remove('dragging-left');\n                            jexcel.current.headers[i].classList.remove('dragging-right');\n                        }\n                        // Update position\n                        if (columnId) {\n                            if (jexcel.current.dragging.column != jexcel.current.dragging.destination) {\n                                jexcel.current.moveColumn(jexcel.current.dragging.column, jexcel.current.dragging.destination);\n                            }\n                        }\n                    } else {\r\n                        if (jexcel.current.dragging.element.nextSibling) {\r\n                            var position = parseInt(jexcel.current.dragging.element.nextSibling.getAttribute('data-y'));\r\n                            if (jexcel.current.dragging.row < position) {\r\n                                position -= 1;\r\n                            }\r\n                        } else {\r\n                            var position = parseInt(jexcel.current.dragging.element.previousSibling.getAttribute('data-y'));\r\n                        }\r\n                        if (jexcel.current.dragging.row != position) {\n                            jexcel.current.moveRow(jexcel.current.dragging.row, position, true);\n                        }\n                        jexcel.current.dragging.element.classList.remove('dragging');\n                    }\n                    jexcel.current.dragging = null;\n                }\n            } else {\n                // Close any corner selection\n                if (jexcel.current.selectedCorner) {\n                    jexcel.current.selectedCorner = false;\n    \n                    // Data to be copied\n                    if (jexcel.current.selection.length > 0) {\n                        // Copy data\n                        jexcel.current.copyData(jexcel.current.selection[0], jexcel.current.selection[jexcel.current.selection.length - 1]);\n    \n                        // Remove selection\n                        jexcel.current.removeCopySelection();\n                    }\n                }\n            }\n        }\n\n        // Clear any time control\n        if (jexcel.timeControl) {\n            clearTimeout(jexcel.timeControl);\n            jexcel.timeControl = null;\n        }\n    \n        // Mouse up\n        jexcel.isMouseAction = false;\n    }\n    \n    // Mouse move controls\n    jexcel.mouseMoveControls = function(e) {\n        e = e || window.event;\n        if (e.buttons) {\n            var mouseButton = e.buttons;\n        } else if (e.button) {\n            var mouseButton = e.button;\n        } else {\n            var mouseButton = e.which;\n        }\n    \n        if (! mouseButton) {\n            jexcel.isMouseAction = false;\n        }\n    \n        if (jexcel.current) {\n            if (jexcel.isMouseAction == true) {\n                // Resizing is ongoing\n                if (jexcel.current.resizing) {\n                    if (jexcel.current.resizing.column) {\n                        var width = e.pageX - jexcel.current.resizing.mousePosition;\n    \n                        if (jexcel.current.resizing.width + width > 0) {\n                            var tempWidth = jexcel.current.resizing.width + width;\n                            jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute('width', tempWidth);\n    \n                            jexcel.current.updateCornerPosition();\n                        }\n                    } else {\n                        var height = e.pageY - jexcel.current.resizing.mousePosition;\n    \n                        if (jexcel.current.resizing.height + height > 0) {\n                            var tempHeight = jexcel.current.resizing.height + height;\n                            jexcel.current.rows[jexcel.current.resizing.row].setAttribute('height', tempHeight);\n    \n                            jexcel.current.updateCornerPosition();\n                        }\n                    }\n                }\n            } else {\n                var x = e.target.getAttribute('data-x');\n                var y = e.target.getAttribute('data-y');\n                var rect = e.target.getBoundingClientRect();\n    \n                if (jexcel.current.cursor) {\n                    jexcel.current.cursor.style.cursor = '';\n                    jexcel.current.cursor = null;\n                }\n\n                if (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\n                    if (e.target.parentNode.parentNode.classList.contains('resizable')) {\n                        if (e.target && x && ! y && (rect.width - (e.clientX - rect.left) < 6)) {\n                            jexcel.current.cursor = e.target;\n                            jexcel.current.cursor.style.cursor = 'col-resize';\n                        } else if (e.target && ! x && y && (rect.height - (e.clientY - rect.top) < 6)) {\n                            jexcel.current.cursor = e.target;\n                            jexcel.current.cursor.style.cursor = 'row-resize';\n                        }\n                    }\n    \n                    if (e.target.parentNode.parentNode.classList.contains('draggable')) {\n                        if (e.target && ! x && y && (rect.width - (e.clientX - rect.left) < 6)) {\n                            jexcel.current.cursor = e.target;\n                            jexcel.current.cursor.style.cursor = 'move';\n                        } else if (e.target && x && ! y && (rect.height - (e.clientY - rect.top) < 6)) {\n                            jexcel.current.cursor = e.target;\n                            jexcel.current.cursor.style.cursor = 'move';\n                        }\n                    }\n                }\n            }\n        }\n    }\n    \n    jexcel.mouseOverControls = function(e) {\n        e = e || window.event;\n        if (e.buttons) {\n            var mouseButton = e.buttons;\n        } else if (e.button) {\n            var mouseButton = e.button;\n        } else {\n            var mouseButton = e.which;\n        }\n    \n        if (! mouseButton) {\n            jexcel.isMouseAction = false;\n        }\n    \n        if (jexcel.current && jexcel.isMouseAction == true) {\n            // Get elements\n            var jexcelTable = jexcel.getElement(e.target);\n    \n            if (jexcelTable[0]) {\n                // Avoid cross reference\n                if (jexcel.current != jexcelTable[0].jexcel) {\n                    if (jexcel.current) {\n                        return false;\n                    }\n                }\n    \n                var columnId = e.target.getAttribute('data-x');\n                var rowId = e.target.getAttribute('data-y');\n    \n                if (jexcel.current.dragging) {\n                    if (jexcel.current.dragging.column) {\n                        if (columnId) {\n                            if (jexcel.current.isColMerged(columnId).length) {\n                                console.error('JEXCEL: This column is part of a merged cell.');\n                            } else {\n                                for (var i = 0; i < jexcel.current.headers.length; i++) {\n                                    jexcel.current.headers[i].classList.remove('dragging-left');\n                                    jexcel.current.headers[i].classList.remove('dragging-right');\n                                }\n    \n                                if (jexcel.current.dragging.column == columnId) {\n                                    jexcel.current.dragging.destination = parseInt(columnId);\n                                } else {\n                                    if (e.target.clientWidth / 2 > e.offsetX) {\n                                        if (jexcel.current.dragging.column < columnId) {\n                                            jexcel.current.dragging.destination = parseInt(columnId) - 1;\n                                        } else {\n                                            jexcel.current.dragging.destination = parseInt(columnId);\n                                        }\n                                        jexcel.current.headers[columnId].classList.add('dragging-left');\n                                    } else {\n                                        if (jexcel.current.dragging.column < columnId) {\n                                            jexcel.current.dragging.destination = parseInt(columnId);\n                                        } else {\n                                            jexcel.current.dragging.destination = parseInt(columnId) + 1;\n                                        }\n                                        jexcel.current.headers[columnId].classList.add('dragging-right');\n                                    }\n                                }\n                            }\n                        }\n                    } else {\n                        if (rowId) {\n                            if (jexcel.current.isRowMerged(rowId).length) {\n                                console.error('JEXCEL: This row is part of a merged cell.');\n                            } else {\n                                var target = (e.target.clientHeight / 2 > e.offsetY) ? e.target.parentNode.nextSibling : e.target.parentNode;\n                                e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element, target);\n                            }\n                        }\n                    }\n                } else if (jexcel.current.resizing) {\n                } else {\n                    // Header found\n                    if (jexcelTable[1] == 1) {\n                        if (jexcel.current.selectedHeader) {\n                            var columnId = e.target.getAttribute('data-x');\n                            var o = jexcel.current.selectedHeader;\n                            var d = columnId;\n                            // Update selection\n                            jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\n                        }\n                    }\n    \n                    // Body found\n                    if (jexcelTable[1] == 2) {\n                        if (e.target.classList.contains('jexcel_row')) {\n                            if (jexcel.current.selectedRow) {\n                                var o = jexcel.current.selectedRow;\n                                var d = rowId;\n                                // Update selection\n                                jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\n                            }\n                        } else {\n                            // Do not select edtion is in progress\n                            if (! jexcel.current.edition) {\n                                if (columnId && rowId) {\n                                    if (jexcel.current.selectedCorner) {\n                                        jexcel.current.updateCopySelection(columnId, rowId);\n                                    } else {\n                                        if (jexcel.current.selectedCell) {\n                                            jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    \n        // Clear any time control\n        if (jexcel.timeControl) {\n            clearTimeout(jexcel.timeControl);\n            jexcel.timeControl = null;\n        }\n    }\n    \n    /**\n     * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\n     */\n    jexcel.doubleClickControls = function(e) {\n        // Jexcel is selected\n        if (jexcel.current) {\n            // Corner action\n            if (e.target.classList.contains('jexcel_corner')) {\n                // Any selected cells\n                if (jexcel.current.highlighted.length > 0) {\n                    // Copy from this\n                    var x1 = jexcel.current.highlighted[0].getAttribute('data-x');\n                    var y1 = parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1;\n                    // Until this\n                    var x2 = jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-x');\n                    var y2 = jexcel.current.records.length - 1\n                    // Execute copy\n                    jexcel.current.copyData(jexcel.current.records[y1][x1], jexcel.current.records[y2][x2]);\n                }\r\n            } else if (e.target.classList.contains('jexcel_column_filter')) {\r\n                // Column\r\n                var columnId = e.target.getAttribute('data-x');\r\n                // Open filter\r\n                jexcel.current.openFilter(columnId);\r\n                \r\n            } else {\n                // Get table\n                var jexcelTable = jexcel.getElement(e.target);\n    \n                // Double click over header\n                if (jexcelTable[1] == 1 && jexcel.current.options.columnSorting == true) {\n                    // Check valid column header coords\n                    var columnId = e.target.getAttribute('data-x');\n                    if (columnId) {\n                        jexcel.current.orderBy(columnId);\n                    }\n                }\n    \n                // Double click over body\n                if (jexcelTable[1] == 2 && jexcel.current.options.editable == true) {\n                    if (! jexcel.current.edition) {\n                        var getCellCoords = function(element) {\n                            if (element.parentNode) {\n                                var x = element.getAttribute('data-x');\n                                var y = element.getAttribute('data-y');\n                                if (x && y) {\n                                    return element;\n                                } else {\n                                    return getCellCoords(element.parentNode);\n                                }\n                            }\n                        }\n                        var cell = getCellCoords(e.target);\n                        if (cell && cell.classList.contains('highlight')) {\r\n                            jexcel.current.openEditor(cell);\r\n                        }\n                    }\n                }\n            }\n        }\n    }\n    \n    jexcel.copyControls = function(e) {\n        if (jexcel.current && jexcel.copyControls.enabled) {\n            if (! jexcel.current.edition) {\n                jexcel.current.copy(true);\n            }\n        }\n    }\n    \n    jexcel.cutControls = function(e) {\n        if (jexcel.current) {\n            if (! jexcel.current.edition) {\n                jexcel.current.copy(true);\n                if (jexcel.current.options.editable == true) {\n                    jexcel.current.setValue(jexcel.current.highlighted, '');\n                }\n            }\n        }\n    }\n    \n    jexcel.pasteControls = function(e) {\n        if (jexcel.current && jexcel.current.selectedCell) {\n            if (! jexcel.current.edition) {\n                if (jexcel.current.options.editable == true) {\n                    if (e && e.clipboardData) {\n                        jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\n                        e.preventDefault();\n                    } else if (window.clipboardData) {\n                        jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\n                    }\n                }\n            }\n        }\n    }\n    \n    jexcel.contextMenuControls = function(e) {\n        e = e || window.event;\n        if (\"buttons\" in e) {\n            var mouseButton = e.buttons;\n        } else {\n            var mouseButton = e.which || e.button;\n        }\n    \n        if (jexcel.current) {\n            if (jexcel.current.edition) {\n                e.preventDefault();\n            } else if (jexcel.current.options.contextMenu) {\n                jexcel.current.contextMenu.contextmenu.close();\n    \n                if (jexcel.current) {\n                    var x = e.target.getAttribute('data-x');\n                    var y = e.target.getAttribute('data-y');\n    \n                    if (x || y) {\n                        // Table found\n                        var items = jexcel.current.options.contextMenu(jexcel.current, x, y, e);\n                        // The id is depending on header and body\n                        jexcel.current.contextMenu.contextmenu.open(e, items);\n                        // Avoid the real one\n                        e.preventDefault();\n                    }\n                }\n            }\n        }\n    }\n\n    jexcel.touchStartControls = function(e) {\n        var jexcelTable = jexcel.getElement(e.target);\n    \n        if (jexcelTable[0]) {\n            if (jexcel.current != jexcelTable[0].jexcel) {\n                if (jexcel.current) {\n                    jexcel.current.resetSelection();\n                }\n                jexcel.current = jexcelTable[0].jexcel;\n            }\n        } else {\n            if (jexcel.current) {\n                jexcel.current.resetSelection();\n                jexcel.current = null;\n            }\n        }\n    \n        if (jexcel.current) {\n            if (! jexcel.current.edition) {\n                var columnId = e.target.getAttribute('data-x');\n                var rowId = e.target.getAttribute('data-y');\n    \n                if (columnId && rowId) {\n                    jexcel.current.updateSelectionFromCoords(columnId, rowId);\n    \n                    jexcel.timeControl = setTimeout(function() {\r\n                        // Keep temporary reference to the element\r\n                        if (jexcel.current.options.columns[columnId].type == 'color') {\r\n                            jexcel.tmpElement = null;\r\n                        } else {\r\n                            jexcel.tmpElement = e.target;\r\n                        }\r\n                        jexcel.current.openEditor(e.target, false, e);\n                    }, 500);\n                }\n            }\n        }\n    }\n    \n    jexcel.touchEndControls = function(e) {\r\n        // Clear any time control\n        if (jexcel.timeControl) {\n            clearTimeout(jexcel.timeControl);\n            jexcel.timeControl = null;\r\n            // Element\r\n            if (jexcel.tmpElement && jexcel.tmpElement.children[0].tagName == 'INPUT') {\r\n                jexcel.tmpElement.children[0].focus();\r\n            }\r\n            jexcel.tmpElement = null;\n        }\n    }\r\n    \r\n    /**\r\n     * Jexcel extensions\r\n     */\r\n    \r\n    jexcel.tabs = function(tabs, result) {\r\n        // Create tab container\r\n        if (! tabs.classList.contains('jexcel_tabs')) {\r\n            tabs.innerHTML = '';\r\n            tabs.classList.add('jexcel_tabs')\r\n            tabs.jexcel = [];\r\n\r\n            var div = document.createElement('div');\r\n            var headers = tabs.appendChild(div);\r\n            var div = document.createElement('div');\r\n            var content = tabs.appendChild(div);\r\n        } else {\r\n            var headers = tabs.children[0];\r\n            var content = tabs.children[1];\r\n        }\r\n\r\n        var spreadsheet = []\r\n        var link = [];\r\n        for (var i = 0; i < result.length; i++) {\r\n            // Spreadsheet container\r\n            spreadsheet[i] = document.createElement('div');\r\n            spreadsheet[i].classList.add('jexcel_tab');\r\n            var worksheet = jexcel(spreadsheet[i], result[i]);\r\n            content.appendChild(spreadsheet[i]);\r\n            tabs.jexcel.push(worksheet);\r\n\r\n            // Tab link\r\n            link[i] = document.createElement('div');\r\n            link[i].classList.add('jexcel_tab_link');\r\n            link[i].setAttribute('data-spreadsheet', tabs.jexcel.length-1);\r\n            link[i].innerHTML = result[i].sheetName;\r\n            link[i].onclick = function() {\r\n                for (var j = 0; j < headers.children.length; j++) {\r\n                    headers.children[j].classList.remove('selected');\r\n                    content.children[j].style.display = 'none';\r\n                }\r\n                var i = this.getAttribute('data-spreadsheet');\r\n                content.children[i].style.display = 'block';\r\n                headers.children[i].classList.add('selected')\r\n            }\r\n            headers.appendChild(link[i]);\r\n        }\r\n\r\n        // First tab\r\n        for (var j = 0; j < headers.children.length; j++) {\r\n            headers.children[j].classList.remove('selected');\r\n            content.children[j].style.display = 'none';\r\n        }\r\n        headers.children[headers.children.length - 1].classList.add('selected');\r\n        content.children[headers.children.length - 1].style.display = 'block';\r\n    }\r\n\r\n    // Compability to older versions\r\n    jexcel.createTabs = jexcel.tabs;\r\n\r\n    jexcel.fromSpreadsheet = function(file, __callback) {\r\n        var convert = function(workbook) {\r\n            var spreadsheets = [];\r\n            workbook.SheetNames.forEach(function(sheetName) {\r\n                var spreadsheet = {};\r\n                spreadsheet.rows = [];\r\n                spreadsheet.columns = [];\r\n                spreadsheet.data = [];\r\n                spreadsheet.style = {};\r\n                spreadsheet.sheetName = sheetName;\r\n    \r\n                // Column widths\r\n                var temp = workbook.Sheets[sheetName]['!cols'];\r\n                if (temp && temp.length) {\r\n                    for (var i = 0; i < temp.length; i++) {\r\n                        spreadsheet.columns[i] = {};\r\n                        if (temp[i] && temp[i].wpx) {\r\n                            spreadsheet.columns[i].width = temp[i].wpx + 'px';\r\n                        }\r\n                     }\r\n                }\r\n                // Rows heights\r\n                var temp = workbook.Sheets[sheetName]['!rows'];\r\n                if (temp && temp.length) {\r\n                    for (var i = 0; i < temp.length; i++) {\r\n                        if (temp[i] && temp[i].hpx) {\r\n                            spreadsheet.rows[i] = {};\r\n                            spreadsheet.rows[i].height = temp[i].hpx + 'px';\r\n                        }\r\n                    }\r\n                }\r\n                // Merge cells\r\n                var temp = workbook.Sheets[sheetName]['!merges'];\r\n                if (temp && temp.length > 0) {\r\n                    spreadsheet.mergeCells = [];\r\n                    for (var i = 0; i < temp.length; i++) {\r\n                        var x1 = temp[i].s.c;\r\n                        var y1 = temp[i].s.r;\r\n                        var x2 = temp[i].e.c;\r\n                        var y2 = temp[i].e.r;\r\n                        var key = jexcel.getColumnNameFromId([x1,y1]);\r\n                        spreadsheet.mergeCells[key] = [ x2-x1+1, y2-y1+1 ];\r\n                    }\r\n                }\r\n                // Data container\r\n                var max_x = 0;\r\n                var max_y = 0;\r\n                var temp = Object.keys(workbook.Sheets[sheetName]);\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i].substr(0,1) != '!') {\r\n                        var cell = workbook.Sheets[sheetName][temp[i]];\r\n                        var info = jexcel.getIdFromColumnName(temp[i], true);\r\n                        if (! spreadsheet.data[info[1]]) {\r\n                            spreadsheet.data[info[1]] = [];\r\n                        }\r\n                        spreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\r\n                        if (max_x < info[0]) {\r\n                            max_x = info[0];\r\n                        }\r\n                        if (max_y < info[1]) {\r\n                            max_y = info[1];\r\n                        }\r\n                        // Style\r\n                        if (cell.style && Object.keys(cell.style).length > 0) {\r\n                            spreadsheet.style[temp[i]] = cell.style;\r\n                        }\r\n                        if (cell.s && cell.s.fgColor) {\r\n                            if (spreadsheet.style[temp[i]]) {\r\n                                spreadsheet.style[temp[i]] += ';';\r\n                            }\r\n                            spreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\r\n                        }\r\n                    }\r\n                }\r\n                var numColumns = spreadsheet.columns;\r\n                for (var j = 0; j <= max_y; j++) {\r\n                    for (var i = 0; i <= max_x; i++) {\r\n                        if (! spreadsheet.data[j]) {\r\n                            spreadsheet.data[j] = [];\r\n                        }\r\n                        if (! spreadsheet.data[j][i]) {\r\n                            if (numColumns < i) {\r\n                                spreadsheet.data[j][i] = '';\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                spreadsheets.push(spreadsheet);\r\n            });\r\n    \r\n            return spreadsheets;\r\n        }\r\n    \r\n        var oReq;\r\n        oReq = new XMLHttpRequest();\r\n        oReq.open(\"GET\", file, true);\r\n    \r\n        if(typeof Uint8Array !== 'undefined') {\r\n            oReq.responseType = \"arraybuffer\";\r\n            oReq.onload = function(e) {\r\n                var arraybuffer = oReq.response;\r\n                var data = new Uint8Array(arraybuffer);\r\n                var wb = XLSX.read(data, {type:\"array\", cellFormula:true, cellStyles:true });\r\n                __callback(convert(wb))\r\n            };\r\n        } else {\r\n            oReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");  \r\n            oReq.onreadystatechange = function() { if(oReq.readyState == 4 && oReq.status == 200) {\r\n                var ff = convertResponseBodyToText(oReq.responseBody);\r\n                var wb = XLSX.read(ff, {type:\"binary\", cellFormula:true, cellStyles:true });\r\n                __callback(convert(wb))\r\n            }};\r\n        }\r\n    \r\n        oReq.send();\r\n    }\r\n    \r\n    /**\r\n     * Valid international letter\r\n     */\r\n    \r\n    jexcel.validLetter = function (text) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\r\n        return text.match(regex) ? 1 : 0;\r\n    }\r\n    \r\n    /**\r\n     * Helper injectArray\r\n     */\r\n    jexcel.injectArray = function(o, idx, arr) {\r\n        return o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n    }\r\n    \r\n    /**\r\n     * Get letter based on a number\r\n     * \r\n     * @param integer i\r\n     * @return string letter\r\n     */\r\n    jexcel.getColumnName = function(i) {\r\n        var letter = '';\r\n        if (i > 701) {\r\n            letter += String.fromCharCode(64 + parseInt(i / 676));\r\n            letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n        } else if (i > 25) {\r\n            letter += String.fromCharCode(64 + parseInt(i / 26));\r\n        }\r\n        letter += String.fromCharCode(65 + (i % 26));\r\n    \r\n        return letter;\r\n    }\r\n    \r\n    /**\r\n     * Convert excel like column to jexcel id\r\n     * \r\n     * @param string id\r\n     * @return string id\r\n     */\r\n    jexcel.getIdFromColumnName = function (id, arr) {\r\n        // Get the letters\r\n        var t = /^[a-zA-Z]+/.exec(id);\r\n    \r\n        if (t) {\r\n            // Base 26 calculation\r\n            var code = 0;\r\n            for (var i = 0; i < t[0].length; i++) {\r\n                code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n            }\r\n            code--;\r\n            // Make sure jexcel starts on zero\r\n            if (code < 0) {\r\n                code = 0;\r\n            }\r\n    \r\n            // Number\r\n            var number = parseInt(/[0-9]+$/.exec(id));\r\n            if (number > 0) {\r\n                number--;\r\n            }\r\n    \r\n            if (arr == true) {\r\n                id = [ code, number ];\r\n            } else {\r\n                id = code + '-' + number;\r\n            }\r\n        }\r\n    \r\n        return id;\r\n    }\r\n    \r\n    /**\r\n     * Convert jexcel id to excel like column name\r\n     * \r\n     * @param string id\r\n     * @return string id\r\n     */\r\n    jexcel.getColumnNameFromId = function (cellId) {\r\n        if (! Array.isArray(cellId)) {\r\n            cellId = cellId.split('-');\r\n        }\r\n    \r\n        return jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\r\n    }\r\n    \r\n    /**\r\n     * Verify element inside jexcel table\r\n     * \r\n     * @param string id\r\n     * @return string id\r\n     */\r\n    jexcel.getElement = function(element) {\r\n        var jexcelSection = 0;\r\n        var jexcelElement = 0;\r\n    \r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jexcel_container')) {\r\n                    jexcelElement = element;\r\n                }\r\n            }\r\n    \r\n            if (element.tagName == 'THEAD') {\r\n                jexcelSection = 1;\r\n            } else if (element.tagName == 'TBODY') {\r\n                jexcelSection = 2;\r\n            }\r\n    \r\n            if (element.parentNode) {\r\n                if (! jexcelElement) {\r\n                    path(element.parentNode);\r\n                }\r\n            }\r\n        }\r\n    \r\n        path(element);\r\n    \r\n        return [ jexcelElement, jexcelSection ];\r\n    }\r\n\r\n    jexcel.doubleDigitFormat = function(v) {\r\n        v = ''+v;\r\n        if (v.length == 1) {\r\n            v = '0'+v;\r\n        }\r\n        return v;\r\n    }\r\n\r\n    jexcel.createFromTable = function(el, options) {\r\n        if (el.tagName != 'TABLE') {\r\n            console.log('Element is not a table');\r\n        } else {\r\n            // Configuration\r\n            if (! options) {\r\n                options = {};\r\n            }\r\n            options.columns = [];\r\n            options.data = [];\r\n\r\n            // Colgroup\r\n            var colgroup = el.querySelectorAll('colgroup > col');\r\n            if (colgroup.length) {\r\n                // Get column width\r\n                for (var i = 0; i < colgroup.length; i++) {\r\n                    var width = colgroup[i].style.width;\r\n                    if (! width) {\r\n                        var width = colgroup[i].getAttribute('width');\r\n                    }\r\n                    // Set column width\r\n                    if (width) {\r\n                        if (! options.columns[i]) {\r\n                            options.columns[i] = {}\r\n                        }\r\n                        options.columns[i].width = width;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Parse header\r\n            var parseHeader = function(header) {\r\n                // Get width information\r\n                var info = header.getBoundingClientRect();\r\n                var width = info.width > 50 ? info.width : 50;\r\n\r\n                // Create column option\r\n                if (! options.columns[i]) {\r\n                    options.columns[i] = {};\r\n                } \r\n                if (header.getAttribute('data-celltype')) {\r\n                    options.columns[i].type = header.getAttribute('data-celltype');\r\n                } else {\r\n                    options.columns[i].type = 'text';\r\n                }\r\n                options.columns[i].width = width + 'px';\r\n                options.columns[i].title = header.innerText;\r\n                options.columns[i].align = header.style.textAlign || 'center';\r\n            }\r\n\r\n            // Headers\r\n            var headers = el.querySelectorAll('thead > tr');\r\n            if (headers.length) {\r\n                // Get the last row in the thead\r\n                headers = headers[headers.length-1].children;\r\n                // Go though the headers\r\n                for (var i = 0; i < headers.length; i++) {\r\n                    parseHeader(headers[i]);\r\n                }\r\n            }\r\n\r\n            // Content\r\n            var rowNumber = 0;\r\n            var mergeCells = {};\r\n            var rows = {};\r\n            var style = {};\r\n\r\n            var content = el.querySelectorAll('table > tr, tbody tr');\r\n            for (var j = 0; j < content.length; j++) {\r\n                options.data[rowNumber] = [];\r\n                if (options.parseTableFirstRowAsHeader == true && j == 0) {\r\n                    for (var i = 0; i < content[j].children.length; i++) {\r\n                        parseHeader(content[j].children[i]);\r\n                    }\r\n                } else {\r\n                    for (var i = 0; i < content[j].children.length; i++) {\r\n                        // WickedGrid formula compatibility\r\n                        var value = content[j].children[i].getAttribute('data-formula');\r\n                        if (value) {\r\n                            if (value.substr(0,1) != '=') {\r\n                                value = '=' + value;\r\n                            }\r\n                        } else {\r\n                            var value = content[j].children[i].innerText;\r\n                        }\r\n                        options.data[rowNumber].push(value);\r\n\r\n                        // Key\r\n                        var cellName = jexcel.getColumnNameFromId([ i, j ]);\r\n\r\n                        // Merged cells\r\n                        var mergedColspan = parseInt(content[j].children[i].getAttribute('colspan')) || 0;\r\n                        var mergedRowspan = parseInt(content[j].children[i].getAttribute('rowspan')) || 0;\r\n                        if (mergedColspan || mergedRowspan) {\r\n                            mergeCells[cellName] = [ mergedColspan || 1, mergedRowspan || 1 ];\r\n                        }\r\n\r\n                        // Avoid problems with hidden cells\r\n                        if (s = content[j].children[i].style && content[j].children[i].style.display == 'none') {\r\n                            content[j].children[i].style.display = '';\r\n                        }\r\n                        // Get style\r\n                        var s = content[j].children[i].getAttribute('style');\r\n                        if (s) {\r\n                            style[cellName] = s;\r\n                        }\r\n                        // Bold\r\n                        if (content[j].children[i].classList.contains('styleBold')) {\r\n                            if (style[cellName]) {\r\n                                style[cellName] += '; font-weight:bold;';\r\n                            } else {\r\n                                style[cellName] = 'font-weight:bold;';\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // Row Height\r\n                    if (content[j].style && content[j].style.height) {\r\n                        rows[j] = { height: content[j].style.height };\r\n                    }\r\n\r\n                    // Index\r\n                    rowNumber++;\r\n                }\r\n            }\r\n\r\n            // Style\r\n            if (Object.keys(style).length > 0) {\r\n                //options.style = style;\r\n            }\r\n            // Merged\r\n            if (Object.keys(mergeCells).length > 0) {\r\n                options.mergeCells = mergeCells;\r\n            }\r\n            // Row height\r\n            if (Object.keys(rows).length > 0) {\r\n                options.rows = rows;\r\n            }\r\n\r\n            // TODO: data-hiddencolumns=\"3,4\"\r\n            \r\n            // I guess in terms the better column type\r\n            if (options.parseTableAutoCellType == true) {\r\n                var pattern = [];\r\n                for (var i = 0; i < options.columns.length; i++) {\r\n                    var test = true;\r\n                    var testCalendar = true;\r\n                    pattern[i] = [];\r\n                    for (var j = 0; j < options.data.length; j++) {\r\n                        var value = options.data[j][i];\r\n                        if (! pattern[i][value]) {\r\n                            pattern[i][value] = 0;\r\n                        }\r\n                        pattern[i][value]++;\r\n                        if (value.length > 25) {\r\n                            test = false;\r\n                        }\r\n                        if (value.length == 10) {\r\n                            if (! (value.substr(4,1) == '-' && value.substr(7,1) == '-')) {\r\n                                testCalendar = false;\r\n                            }\r\n                        } else {\r\n                            testCalendar = false;\r\n                        }\r\n                    }\r\n\r\n                    var keys = Object.keys(pattern[i]).length;\r\n                    if (testCalendar) {\r\n                        options.columns[i].type = 'calendar';\r\n                    } else if (test == true && keys > 1 && keys <= parseInt(options.data.length * 0.1)) {\r\n                        options.columns[i].type = 'dropdown';\r\n                        options.columns[i].source = Object.keys(pattern[i]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return options;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Jquery Support\r\n     */\r\n    if (typeof(jQuery) != 'undefined') {\r\n        (function($){\r\n            $.fn.jexcel = function(method) {\r\n                var spreadsheetContainer = $(this).get(0);\r\n                if (! spreadsheetContainer.jexcel) {\r\n                    return jexcel($(this).get(0), arguments[0]);\r\n                } else {\r\n                    return spreadsheetContainer.jexcel[method].apply(this, Array.prototype.slice.call( arguments, 1 ));\r\n                }\r\n            };\r\n    \r\n        })(jQuery);\r\n    }\r\n    \r\n    \r\n    // Based on sutoiku work (https://github.com/sutoiku)\r\n    \r\n    var error = (function() {\r\n        var exports = {};\r\n    \r\n        exports.nil = new Error('#NULL!');\r\n        exports.div0 = new Error('#DIV/0!');\r\n        exports.value = new Error('#VALUE!');\r\n        exports.ref = new Error('#REF!');\r\n        exports.name = new Error('#NAME?');\r\n        exports.num = new Error('#NUM!');\r\n        exports.na = new Error('#N/A');\r\n        exports.error = new Error('#ERROR!');\r\n        exports.data = new Error('#GETTING_DATA');\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    var utils = (function() {\r\n        var exports = {};\r\n    \r\n        exports.flattenShallow = function(array) {\r\n            if (!array || !array.reduce) {\r\n                return array;\r\n            }\r\n    \r\n            return array.reduce(function(a, b) {\r\n                var aIsArray = Array.isArray(a);\r\n                var bIsArray = Array.isArray(b);\r\n    \r\n                if (aIsArray && bIsArray) {\r\n                    return a.concat(b);\r\n                }\r\n                if (aIsArray) {\r\n                    a.push(b);\r\n    \r\n                    return a;\r\n                }\r\n                if (bIsArray) {\r\n                    return [ a ].concat(b);\r\n                }\r\n    \r\n                return [ a, b ];\r\n            });\r\n        };\r\n    \r\n        exports.isFlat = function(array) {\r\n            if (!array) {\r\n                return false;\r\n            }\r\n    \r\n            for (var i = 0; i < array.length; ++i) {\r\n                if (Array.isArray(array[i])) {\r\n                    return false;\r\n                }\r\n            }\r\n    \r\n            return true;\r\n        };\r\n    \r\n        exports.flatten = function() {\r\n            var result = exports.argsToArray.apply(null, arguments);\r\n    \r\n            while (!exports.isFlat(result)) {\r\n                result = exports.flattenShallow(result);\r\n            }\r\n    \r\n            return result;\r\n        };\r\n    \r\n        exports.argsToArray = function(args) {\r\n            var result = [];\r\n    \r\n            exports.arrayEach(args, function(value) {\r\n                result.push(value);\r\n            });\r\n    \r\n            return result;\r\n        };\r\n    \r\n        exports.numbers = function() {\r\n            var possibleNumbers = this.flatten.apply(null, arguments);\r\n            return possibleNumbers.filter(function(el) {\r\n                return typeof el === 'number';\r\n            });\r\n        };\r\n    \r\n        exports.cleanFloat = function(number) {\r\n            var power = 1e14;\r\n            return Math.round(number * power) / power;\r\n        };\r\n    \r\n        exports.parseBool = function(bool) {\r\n            if (typeof bool === 'boolean') {\r\n                return bool;\r\n            }\r\n    \r\n            if (bool instanceof Error) {\r\n                return bool;\r\n            }\r\n    \r\n            if (typeof bool === 'number') {\r\n                return bool !== 0;\r\n            }\r\n    \r\n            if (typeof bool === 'string') {\r\n                var up = bool.toUpperCase();\r\n                if (up === 'TRUE') {\r\n                    return true;\r\n                }\r\n    \r\n                if (up === 'FALSE') {\r\n                    return false;\r\n                }\r\n            }\r\n    \r\n            if (bool instanceof Date && !isNaN(bool)) {\r\n                return true;\r\n            }\r\n    \r\n            return error.value;\r\n        };\r\n    \r\n        exports.parseNumber = function(string) {\r\n            if (string === undefined || string === '') {\r\n                return error.value;\r\n            }\r\n            if (!isNaN(string)) {\r\n                return parseFloat(string);\r\n            }\r\n    \r\n            return error.value;\r\n        };\r\n    \r\n        exports.parseNumberArray = function(arr) {\r\n            var len;\r\n    \r\n            if (!arr || (len = arr.length) === 0) {\r\n                return error.value;\r\n            }\r\n    \r\n            var parsed;\r\n    \r\n            while (len--) {\r\n                parsed = exports.parseNumber(arr[len]);\r\n                if (parsed === error.value) {\r\n                    return parsed;\r\n                }\r\n                arr[len] = parsed;\r\n            }\r\n    \r\n            return arr;\r\n        };\r\n    \r\n        exports.parseMatrix = function(matrix) {\r\n            var n;\r\n    \r\n            if (!matrix || (n = matrix.length) === 0) {\r\n                return error.value;\r\n            }\r\n            var pnarr;\r\n    \r\n            for (var i = 0; i < matrix.length; i++) {\r\n                pnarr = exports.parseNumberArray(matrix[i]);\r\n                matrix[i] = pnarr;\r\n    \r\n                if (pnarr instanceof Error) {\r\n                    return pnarr;\r\n                }\r\n            }\r\n    \r\n            return matrix;\r\n        };\r\n    \r\n        var d1900 = new Date(Date.UTC(1900, 0, 1));\r\n        exports.parseDate = function(date) {\r\n            if (!isNaN(date)) {\r\n                if (date instanceof Date) {\r\n                    return new Date(date);\r\n                }\r\n                var d = parseInt(date, 10);\r\n                if (d < 0) {\r\n                    return error.num;\r\n                }\r\n                if (d <= 60) {\r\n                    return new Date(d1900.getTime() + (d - 1) * 86400000);\r\n                }\r\n                return new Date(d1900.getTime() + (d - 2) * 86400000);\r\n            }\r\n            if (typeof date === 'string') {\r\n                date = new Date(date);\r\n                if (!isNaN(date)) {\r\n                    return date;\r\n                }\r\n            }\r\n            return error.value;\r\n        };\r\n    \r\n        exports.parseDateArray = function(arr) {\r\n            var len = arr.length;\r\n            var parsed;\r\n            while (len--) {\r\n                parsed = this.parseDate(arr[len]);\r\n                if (parsed === error.value) {\r\n                    return parsed;\r\n                }\r\n                arr[len] = parsed;\r\n            }\r\n            return arr;\r\n        };\r\n    \r\n        exports.anyIsError = function() {\r\n            var n = arguments.length;\r\n            while (n--) {\r\n                if (arguments[n] instanceof Error) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n    \r\n        exports.arrayValuesToNumbers = function(arr) {\r\n            var n = arr.length;\r\n            var el;\r\n            while (n--) {\r\n                el = arr[n];\r\n                if (typeof el === 'number') {\r\n                    continue;\r\n                }\r\n                if (el === true) {\r\n                    arr[n] = 1;\r\n                    continue;\r\n                }\r\n                if (el === false) {\r\n                    arr[n] = 0;\r\n                    continue;\r\n                }\r\n                if (typeof el === 'string') {\r\n                    var number = this.parseNumber(el);\r\n                    if (number instanceof Error) {\r\n                        arr[n] = 0;\r\n                    } else {\r\n                        arr[n] = number;\r\n                    }\r\n                }\r\n            }\r\n            return arr;\r\n        };\r\n    \r\n        exports.rest = function(array, idx) {\r\n            idx = idx || 1;\r\n            if (!array || typeof array.slice !== 'function') {\r\n                return array;\r\n            }\r\n            return array.slice(idx);\r\n        };\r\n    \r\n        exports.initial = function(array, idx) {\r\n            idx = idx || 1;\r\n            if (!array || typeof array.slice !== 'function') {\r\n                return array;\r\n            }\r\n            return array.slice(0, array.length - idx);\r\n        };\r\n    \r\n        exports.arrayEach = function(array, iteratee) {\r\n            var index = -1, length = array.length;\r\n    \r\n            while (++index < length) {\r\n                if (iteratee(array[index], index, array) === false) {\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            return array;\r\n        };\r\n    \r\n        exports.transpose = function(matrix) {\r\n            if (!matrix) {\r\n                return error.value;\r\n            }\r\n    \r\n            return matrix[0].map(function(col, i) {\r\n                return matrix.map(function(row) {\r\n                    return row[i];\r\n                });\r\n            });\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods = {};\r\n    \r\n    jexcel.methods.datetime = (function() {\r\n        var exports = {};\r\n    \r\n        var d1900 = new Date(1900, 0, 1);\r\n        var WEEK_STARTS = [\r\n            undefined,\r\n            0,\r\n            1,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            1,\r\n            2,\r\n            3,\r\n            4,\r\n            5,\r\n            6,\r\n            0\r\n        ];\r\n        var WEEK_TYPES = [\r\n            [],\r\n            [1, 2, 3, 4, 5, 6, 7],\r\n            [7, 1, 2, 3, 4, 5, 6],\r\n            [6, 0, 1, 2, 3, 4, 5],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [7, 1, 2, 3, 4, 5, 6],\r\n            [6, 7, 1, 2, 3, 4, 5],\r\n            [5, 6, 7, 1, 2, 3, 4],\r\n            [4, 5, 6, 7, 1, 2, 3],\r\n            [3, 4, 5, 6, 7, 1, 2],\r\n            [2, 3, 4, 5, 6, 7, 1],\r\n            [1, 2, 3, 4, 5, 6, 7]\r\n        ];\r\n        var WEEKEND_TYPES = [\r\n            [],\r\n            [6, 0],\r\n            [0, 1],\r\n            [1, 2],\r\n            [2, 3],\r\n            [3, 4],\r\n            [4, 5],\r\n            [5, 6],\r\n            undefined,\r\n            undefined,\r\n            undefined, [0, 0],\r\n            [1, 1],\r\n            [2, 2],\r\n            [3, 3],\r\n            [4, 4],\r\n            [5, 5],\r\n            [6, 6]\r\n        ];\r\n    \r\n        exports.DATE = function(year, month, day) {\r\n            year = utils.parseNumber(year);\r\n            month = utils.parseNumber(month);\r\n            day = utils.parseNumber(day);\r\n            if (utils.anyIsError(year, month, day)) {\r\n                return error.value;\r\n            }\r\n            if (year < 0 || month < 0 || day < 0) {\r\n                return error.num;\r\n            }\r\n            var date = new Date(year, month - 1, day);\r\n            return date;\r\n        };\r\n    \r\n        exports.DATEVALUE = function(date_text) {\r\n            if (typeof date_text !== 'string') {\r\n                return error.value;\r\n            }\r\n            var date = Date.parse(date_text);\r\n            if (isNaN(date)) {\r\n                return error.value;\r\n            }\r\n            if (date <= -2203891200000) {\r\n                return (date - d1900) / 86400000 + 1;\r\n            }\r\n            return (date - d1900) / 86400000 + 2;\r\n        };\r\n    \r\n        exports.DAY = function(serial_number) {\r\n            var date = utils.parseDate(serial_number);\r\n            if (date instanceof Error) {\r\n                return date;\r\n            }\r\n            return date.getDate();\r\n        };\r\n    \r\n        exports.DAYS = function(end_date, start_date) {\r\n            end_date = utils.parseDate(end_date);\r\n            start_date = utils.parseDate(start_date);\r\n            if (end_date instanceof Error) {\r\n                return end_date;\r\n            }\r\n            if (start_date instanceof Error) {\r\n                return start_date;\r\n            }\r\n            return serial(end_date) - serial(start_date);\r\n        };\r\n    \r\n        exports.DAYS360 = function(start_date, end_date, method) {\r\n        };\r\n    \r\n        exports.EDATE = function(start_date, months) {\r\n            start_date = utils.parseDate(start_date);\r\n            if (start_date instanceof Error) {\r\n                return start_date;\r\n            }\r\n            if (isNaN(months)) {\r\n                return error.value;\r\n            }\r\n            months = parseInt(months, 10);\r\n            start_date.setMonth(start_date.getMonth() + months);\r\n            return serial(start_date);\r\n        };\r\n    \r\n        exports.EOMONTH = function(start_date, months) {\r\n            start_date = utils.parseDate(start_date);\r\n            if (start_date instanceof Error) {\r\n                return start_date;\r\n            }\r\n            if (isNaN(months)) {\r\n                return error.value;\r\n            }\r\n            months = parseInt(months, 10);\r\n            return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\r\n        };\r\n    \r\n        exports.HOUR = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getHours();\r\n        };\r\n    \r\n        exports.INTERVAL = function(second) {\r\n            if (typeof second !== 'number' && typeof second !== 'string') {\r\n                return error.value;\r\n            } else {\r\n                second = parseInt(second, 10);\r\n            }\r\n    \r\n            var year  = Math.floor(second/946080000);\r\n            second    = second%946080000;\r\n            var month = Math.floor(second/2592000);\r\n            second    = second%2592000;\r\n            var day   = Math.floor(second/86400);\r\n            second    = second%86400;\r\n    \r\n            var hour  = Math.floor(second/3600);\r\n            second    = second%3600;\r\n            var min   = Math.floor(second/60);\r\n            second    = second%60;\r\n            var sec   = second;\r\n    \r\n            year  = (year  > 0) ? year  + 'Y' : '';\r\n            month = (month > 0) ? month + 'M' : '';\r\n            day   = (day   > 0) ? day   + 'D' : '';\r\n            hour  = (hour  > 0) ? hour  + 'H' : '';\r\n            min   = (min   > 0) ? min   + 'M' : '';\r\n            sec   = (sec   > 0) ? sec   + 'S' : '';\r\n    \r\n            return 'P' + year + month + day + 'T' + hour + min + sec;\r\n        };\r\n    \r\n        exports.ISOWEEKNUM = function(date) {\r\n            date = utils.parseDate(date);\r\n            if (date instanceof Error) {\r\n                return date;\r\n            }\r\n    \r\n            date.setHours(0, 0, 0);\r\n            date.setDate(date.getDate() + 4 - (date.getDay() || 7));\r\n            var yearStart = new Date(date.getFullYear(), 0, 1);\r\n            return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\r\n        };\r\n    \r\n        exports.MINUTE = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getMinutes();\r\n        };\r\n    \r\n        exports.MONTH = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getMonth() + 1;\r\n        };\r\n    \r\n        exports.NETWORKDAYS = function(start_date, end_date, holidays) {\r\n        };\r\n    \r\n        exports.NETWORKDAYS.INTL = function(start_date, end_date, weekend, holidays) {\r\n        };\r\n    \r\n        exports.NOW = function() {\r\n            return new Date();\r\n        };\r\n    \r\n        exports.SECOND = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getSeconds();\r\n        };\r\n    \r\n        exports.TIME = function(hour, minute, second) {\r\n            hour = utils.parseNumber(hour);\r\n            minute = utils.parseNumber(minute);\r\n            second = utils.parseNumber(second);\r\n            if (utils.anyIsError(hour, minute, second)) {\r\n                return error.value;\r\n            }\r\n            if (hour < 0 || minute < 0 || second < 0) {\r\n                return error.num;\r\n            }\r\n            return (3600 * hour + 60 * minute + second) / 86400;\r\n        };\r\n    \r\n        exports.TIMEVALUE = function(time_text) {\r\n            time_text = utils.parseDate(time_text);\r\n            if (time_text instanceof Error) {\r\n                return time_text;\r\n            }\r\n            return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;\r\n        };\r\n    \r\n        exports.TODAY = function() {\r\n            return new Date();\r\n        };\r\n    \r\n        exports.WEEKDAY = function(serial_number, return_type) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            if (return_type === undefined) {\r\n                return_type = 1;\r\n            }\r\n            var day = serial_number.getDay();\r\n            return WEEK_TYPES[return_type][day];\r\n        };\r\n    \r\n        exports.WEEKNUM = function(serial_number, return_type) {\r\n        };\r\n    \r\n        exports.WORKDAY = function(start_date, days, holidays) {\r\n        };\r\n    \r\n        exports.WORKDAY.INTL = function(start_date, days, weekend, holidays) {\r\n        };\r\n    \r\n        exports.YEAR = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getFullYear();\r\n        };\r\n    \r\n        function isLeapYear(year) {\r\n            return new Date(year, 1, 29).getMonth() === 1;\r\n        }\r\n    \r\n        exports.YEARFRAC = function(start_date, end_date, basis) {\r\n        };\r\n    \r\n        function serial(date) {\r\n            var addOn = (date > -2203891200000)?2:1;\r\n            return (date - d1900) / 86400000 + addOn;\r\n        }\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.database = (function() {\r\n        var exports = {};\r\n    \r\n        function compact(array) {\r\n            if (!array) {\r\n                return array;\r\n            }\r\n            var result = [];\r\n            for (var i = 0; i < array.length; ++i) {\r\n                if (!array[i]) {\r\n                    continue;\r\n                }\r\n                result.push(array[i]);\r\n            }\r\n            return result;\r\n        }\r\n    \r\n        exports.FINDFIELD = function(database, title) {\r\n            var index = null;\r\n            for (var i = 0; i < database.length; i++) {\r\n                if (database[i][0] === title) {\r\n                    index = i;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            // Return error if the input field title is incorrect\r\n            if (index == null) {\r\n                return error.value;\r\n            }\r\n            return index;\r\n        };\r\n    \r\n        function findResultIndex(database, criterias) {\r\n            var matches = {};\r\n            for (var i = 1; i < database[0].length; ++i) {\r\n                matches[i] = true;\r\n            }\r\n            var maxCriteriaLength = criterias[0].length;\r\n            for (i = 1; i < criterias.length; ++i) {\r\n                if (criterias[i].length > maxCriteriaLength) {\r\n                    maxCriteriaLength = criterias[i].length;\r\n                }\r\n            }\r\n    \r\n            for (var k = 1; k < database.length; ++k) {\r\n                for (var l = 1; l < database[k].length; ++l) {\r\n                    var currentCriteriaResult = false;\r\n                    var hasMatchingCriteria = false;\r\n                    for (var j = 0; j < criterias.length; ++j) {\r\n                        var criteria = criterias[j];\r\n                        if (criteria.length < maxCriteriaLength) {\r\n                            continue;\r\n                        }\r\n    \r\n                        var criteriaField = criteria[0];\r\n                        if (database[k][0] !== criteriaField) {\r\n                            continue;\r\n                        }\r\n                        hasMatchingCriteria = true;\r\n                        for (var p = 1; p < criteria.length; ++p) {\r\n                            currentCriteriaResult = currentCriteriaResult\r\n                                    || eval(database[k][l] + criteria[p]); // jshint\r\n                                                                            // ignore:line\r\n                        }\r\n                    }\r\n                    if (hasMatchingCriteria) {\r\n                        matches[l] = matches[l] && currentCriteriaResult;\r\n                    }\r\n                }\r\n            }\r\n    \r\n            var result = [];\r\n            for (var n = 0; n < database[0].length; ++n) {\r\n                if (matches[n]) {\r\n                    result.push(n - 1);\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n    \r\n        // Database functions\r\n        exports.DAVERAGE = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var sum = 0;\r\n            for (var i = 0; i < resultIndexes.length; i++) {\r\n                sum += targetFields[resultIndexes[i]];\r\n            }\r\n            return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length;\r\n        };\r\n    \r\n        exports.DCOUNT = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.DCOUNTA = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.DGET = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            // Return error if no record meets the criteria\r\n            if (resultIndexes.length === 0) {\r\n                return error.value;\r\n            }\r\n            // Returns the #NUM! error value because more than one record meets the\r\n            // criteria\r\n            if (resultIndexes.length > 1) {\r\n                return error.num;\r\n            }\r\n    \r\n            return targetFields[resultIndexes[0]];\r\n        };\r\n    \r\n        exports.DMAX = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var maxValue = targetFields[resultIndexes[0]];\r\n            for (var i = 1; i < resultIndexes.length; i++) {\r\n                if (maxValue < targetFields[resultIndexes[i]]) {\r\n                    maxValue = targetFields[resultIndexes[i]];\r\n                }\r\n            }\r\n            return maxValue;\r\n        };\r\n    \r\n        exports.DMIN = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var minValue = targetFields[resultIndexes[0]];\r\n            for (var i = 1; i < resultIndexes.length; i++) {\r\n                if (minValue > targetFields[resultIndexes[i]]) {\r\n                    minValue = targetFields[resultIndexes[i]];\r\n                }\r\n            }\r\n            return minValue;\r\n        };\r\n    \r\n        exports.DPRODUCT = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var targetValues = [];\r\n            for (var i = 0; i < resultIndexes.length; i++) {\r\n                targetValues[i] = targetFields[resultIndexes[i]];\r\n            }\r\n            targetValues = compact(targetValues);\r\n            var result = 1;\r\n            for (i = 0; i < targetValues.length; i++) {\r\n                result *= targetValues[i];\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.DSTDEV = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.DSTDEVP = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.DSUM = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.DVAR = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.DVARP = function(database, field, criteria) {\r\n        };\r\n    \r\n        exports.MATCH = function(lookupValue, lookupArray, matchType) {\r\n            if (!lookupValue && !lookupArray) {\r\n                return error.na;\r\n            }\r\n            if (arguments.length === 2) {\r\n                matchType = 1;\r\n            }\r\n            if (!(lookupArray instanceof Array)) {\r\n                return error.na;\r\n            }\r\n            if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\r\n                return error.na;\r\n            }\r\n    \r\n            var index;\r\n            var indexValue;\r\n    \r\n            for (var idx = 0; idx < lookupArray.length; idx++) {\r\n                if (matchType === 1) {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    } else if (lookupArray[idx] < lookupValue) {\r\n                        if (!indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        } else if (lookupArray[idx] > indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        }\r\n                    }\r\n                } else if (matchType === 0) {\r\n                    if (typeof lookupValue === 'string') {\r\n                        lookupValue = lookupValue.replace(/\\?/g, '.');\r\n                        if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\r\n                            return idx + 1;\r\n                        }\r\n                    } else {\r\n                        if (lookupArray[idx] === lookupValue) {\r\n                            return idx + 1;\r\n                        }\r\n                    }\r\n                } else if (matchType === -1) {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    } else if (lookupArray[idx] > lookupValue) {\r\n                        if (!indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        } else if (lookupArray[idx] < indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return index ? index : error.na;\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.engineering = (function() {\r\n        var exports = {};\r\n    \r\n        function isValidBinaryNumber(number) {\r\n            return (/^[01]{1,10}$/).test(number);\r\n        }\r\n    \r\n        exports.BESSELI = function(x, n) {\r\n        };\r\n    \r\n        exports.BESSELJ = function(x, n) {\r\n        };\r\n    \r\n        exports.BESSELK = function(x, n) {\r\n        };\r\n    \r\n        exports.BESSELY = function(x, n) {\r\n        };\r\n    \r\n        exports.BIN2DEC = function(number) {\r\n            // Return error if number is not binary or contains more than 10\r\n            // characters (10 digits)\r\n            if (!isValidBinaryNumber(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Convert binary number to decimal\r\n            var result = parseInt(number, 2);\r\n    \r\n            // Handle negative numbers\r\n            var stringified = number.toString();\r\n            if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n                return parseInt(stringified.substring(1), 2) - 512;\r\n            } else {\r\n                return result;\r\n            }\r\n        };\r\n    \r\n        exports.BIN2HEX = function(number, places) {\r\n            // Return error if number is not binary or contains more than 10\r\n            // characters (10 digits)\r\n            if (!isValidBinaryNumber(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character hexadecimal number if number\r\n            // is negative\r\n            var stringified = number.toString();\r\n            if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n                return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\r\n            }\r\n    \r\n            // Convert binary number to hexadecimal\r\n            var result = parseInt(number, 2).toString(16);\r\n    \r\n            // Return hexadecimal number using the minimum number of characters\r\n            // necessary if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.BIN2OCT = function(number, places) {\r\n            // Return error if number is not binary or contains more than 10\r\n            // characters (10 digits)\r\n            if (!isValidBinaryNumber(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            var stringified = number.toString();\r\n            if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n                return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\r\n            }\r\n    \r\n            // Convert binary number to octal\r\n            var result = parseInt(number, 2).toString(8);\r\n    \r\n            // Return octal number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.BITAND = function(number1, number2) {\r\n            // Return error if either number is a non-numeric value\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if either number is less than 0\r\n            if (number1 < 0 || number2 < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if either number is a non-integer\r\n            if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if either number is greater than (2^48)-1\r\n            if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return bitwise AND of two numbers\r\n            return number1 & number2;\r\n        };\r\n    \r\n        exports.BITLSHIFT = function(number, shift) {\r\n            number = utils.parseNumber(number);\r\n            shift = utils.parseNumber(shift);\r\n            if (utils.anyIsError(number, shift)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if number is less than 0\r\n            if (number < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if number is a non-integer\r\n            if (Math.floor(number) !== number) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if number is greater than (2^48)-1\r\n            if (number > 281474976710655) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if the absolute value of shift is greater than 53\r\n            if (Math.abs(shift) > 53) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return number shifted by shift bits to the left or to the right if\r\n            // shift is negative\r\n            return (shift >= 0) ? number << shift : number >> -shift;\r\n        };\r\n    \r\n        exports.BITOR = function(number1, number2) {\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if either number is less than 0\r\n            if (number1 < 0 || number2 < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if either number is a non-integer\r\n            if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if either number is greater than (2^48)-1\r\n            if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return bitwise OR of two numbers\r\n            return number1 | number2;\r\n        };\r\n    \r\n        exports.BITRSHIFT = function(number, shift) {\r\n            number = utils.parseNumber(number);\r\n            shift = utils.parseNumber(shift);\r\n            if (utils.anyIsError(number, shift)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if number is less than 0\r\n            if (number < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if number is a non-integer\r\n            if (Math.floor(number) !== number) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if number is greater than (2^48)-1\r\n            if (number > 281474976710655) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if the absolute value of shift is greater than 53\r\n            if (Math.abs(shift) > 53) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return number shifted by shift bits to the right or to the left if\r\n            // shift is negative\r\n            return (shift >= 0) ? number >> shift : number << -shift;\r\n        };\r\n    \r\n        exports.BITXOR = function(number1, number2) {\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if either number is less than 0\r\n            if (number1 < 0 || number2 < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if either number is a non-integer\r\n            if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if either number is greater than (2^48)-1\r\n            if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return bitwise XOR of two numbers\r\n            return number1 ^ number2;\r\n        };\r\n    \r\n        exports.COMPLEX = function(real, imaginary, suffix) {\r\n            real = utils.parseNumber(real);\r\n            imaginary = utils.parseNumber(imaginary);\r\n            if (utils.anyIsError(real, imaginary)) {\r\n                return real;\r\n            }\r\n    \r\n            // Set suffix\r\n            suffix = (suffix === undefined) ? 'i' : suffix;\r\n    \r\n            // Return error if suffix is neither \"i\" nor \"j\"\r\n            if (suffix !== 'i' && suffix !== 'j') {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return complex number\r\n            if (real === 0 && imaginary === 0) {\r\n                return 0;\r\n            } else if (real === 0) {\r\n                return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\r\n            } else if (imaginary === 0) {\r\n                return real.toString();\r\n            } else {\r\n                var sign = (imaginary > 0) ? '+' : '';\r\n                return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\r\n            }\r\n        };\r\n    \r\n        exports.CONVERT = function(number, from_unit, to_unit) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n    \r\n            // List of units supported by CONVERT and units defined by the\r\n            // International System of Units\r\n            // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion\r\n            // ratio]\r\n            var units = [\r\n                [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n                [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\r\n                [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\r\n                [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\r\n                [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n                [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\r\n                [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\r\n                [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\r\n                [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\r\n                [\"ngstrm\", \"\", [\"ang\"], \"length\", false, true, 1e-10],\r\n                [\"are\", \"ar\", null, \"area\", false, true, 100],\r\n                [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\r\n                [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\r\n                [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\r\n                [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\r\n                [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\r\n                [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\r\n                [\"byte\", \"byte\", null, \"information\", false, true, 8],\r\n                [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\r\n                [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\r\n                [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\r\n                [\"cubic ngstrm\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\r\n                [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\r\n                [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\r\n                [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\r\n                [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\r\n                [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\r\n                [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\r\n                [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\r\n                [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\r\n                [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\r\n                [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\r\n                [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\r\n                [\"degree\", \"\", null, \"angle\", false, false, 0.0174532925199433],\r\n                [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\r\n                [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\r\n                [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\r\n                [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\r\n                [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\r\n                [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\r\n                [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\r\n                [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\r\n                [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\r\n                [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\r\n                [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\r\n                [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\r\n                [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\r\n                [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\r\n                [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\r\n                [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\r\n                [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\r\n                [\"henry\", \"H\", null, \"inductance\", true, false, 1],\r\n                [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\r\n                [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\r\n                [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\r\n                [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\r\n                [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\r\n                [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\r\n                [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\r\n                [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\r\n                [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\r\n                [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\r\n                [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\r\n                [\"joule\", \"J\", null, \"energy\", true, true, 1],\r\n                [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\r\n                [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\r\n                [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\r\n                [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\r\n                [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\r\n                [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\r\n                [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\r\n                [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\r\n                [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\r\n                [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\r\n                [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\r\n                [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\r\n                [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\r\n                [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\r\n                [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\r\n                [\"metre\", \"m\", null, \"length\", true, true, 1],\r\n                [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\r\n                [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\r\n                [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\r\n                [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\r\n                [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\r\n                [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\r\n                [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\r\n                [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n                [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n                [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\r\n                [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\r\n                [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1852],\r\n                [\"newton\", \"N\", null, \"force\", true, true, 1],\r\n                [\"rsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\r\n                [\"ohm\", \"\", null, \"electric_resistance\", true, false, 1],\r\n                [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\r\n                [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\r\n                [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\r\n                [\"pferdestrke\", \"PS\", null, \"power\", false, true, 735.49875],\r\n                [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\r\n                [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\r\n                [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\r\n                [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\r\n                [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\r\n                [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\r\n                [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\r\n                [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\r\n                [\"radian\", \"rad\", null, \"angle\", true, false, 1],\r\n                [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\r\n                [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\r\n                [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\r\n                [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\r\n                [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\r\n                [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\r\n                [\"square ngstrm\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\r\n                [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\r\n                [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\r\n                [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\r\n                [\"square meter\", \"m?\", null, \"area\", true, true, 1],\r\n                [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\r\n                [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\r\n                [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\r\n                [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\r\n                [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\r\n                [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\r\n                [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\r\n                [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\r\n                [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\r\n                [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\r\n                [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\r\n                [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\r\n                [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\r\n                [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\r\n                [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\r\n                [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\r\n                [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\r\n                [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\r\n                [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\r\n                [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\r\n                [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\r\n                [\"volt\", \"V\", null, \"voltage\", true, false, 1],\r\n                [\"watt\", \"W\", null, \"power\", true, true, 1],\r\n                [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\r\n                [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\r\n                [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\r\n                [\"year\", \"yr\", null, \"time\", false, true, 31557600]\r\n            ];\r\n    \r\n            // Binary prefixes\r\n            // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived\r\n            // from]\r\n            var binary_prefixes = {\r\n                Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\r\n                Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\r\n                Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\r\n                Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\r\n                Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\r\n                Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\r\n                Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\r\n                ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\r\n            };\r\n    \r\n            // Unit prefixes\r\n            // [Name, Multiplier, Abbreviation]\r\n            var unit_prefixes = {\r\n                Y: [\"yotta\", 1e+24, \"Y\"],\r\n                Z: [\"zetta\", 1e+21, \"Z\"],\r\n                E: [\"exa\", 1e+18, \"E\"],\r\n                P: [\"peta\", 1e+15, \"P\"],\r\n                T: [\"tera\", 1e+12, \"T\"],\r\n                G: [\"giga\", 1e+09, \"G\"],\r\n                M: [\"mega\", 1e+06, \"M\"],\r\n                k: [\"kilo\", 1e+03, \"k\"],\r\n                h: [\"hecto\", 1e+02, \"h\"],\r\n                e: [\"dekao\", 1e+01, \"e\"],\r\n                d: [\"deci\", 1e-01, \"d\"],\r\n                c: [\"centi\", 1e-02, \"c\"],\r\n                m: [\"milli\", 1e-03, \"m\"],\r\n                u: [\"micro\", 1e-06, \"u\"],\r\n                n: [\"nano\", 1e-09, \"n\"],\r\n                p: [\"pico\", 1e-12, \"p\"],\r\n                f: [\"femto\", 1e-15, \"f\"],\r\n                a: [\"atto\", 1e-18, \"a\"],\r\n                z: [\"zepto\", 1e-21, \"z\"],\r\n                y: [\"yocto\", 1e-24, \"y\"]\r\n            };\r\n    \r\n            // Initialize units and multipliers\r\n            var from = null;\r\n            var to = null;\r\n            var base_from_unit = from_unit;\r\n            var base_to_unit = to_unit;\r\n            var from_multiplier = 1;\r\n            var to_multiplier = 1;\r\n            var alt;\r\n    \r\n            // Lookup from and to units\r\n            for (var i = 0; i < units.length; i++) {\r\n                alt = (units[i][2] === null) ? [] : units[i][2];\r\n                if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                  from = units[i];\r\n                }\r\n                if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                  to = units[i];\r\n                }\r\n            }\r\n    \r\n            // Lookup from prefix\r\n            if (from === null) {\r\n                var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\r\n                var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\r\n    \r\n                // Handle dekao unit prefix (only unit prefix with two characters)\r\n                if (from_unit.substring(0, 2) === 'da') {\r\n                  from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n                }\r\n    \r\n                // Handle binary prefixes first (so that 'Yi' is processed before\r\n                // 'Y')\r\n                if (from_binary_prefix) {\r\n                  from_multiplier = from_binary_prefix[2];\r\n                  base_from_unit = from_unit.substring(2);\r\n                } else if (from_unit_prefix) {\r\n                  from_multiplier = from_unit_prefix[1];\r\n                  base_from_unit = from_unit.substring(from_unit_prefix[2].length);\r\n                }\r\n    \r\n                // Lookup from unit\r\n                for (var j = 0; j < units.length; j++) {\r\n                  alt = (units[j][2] === null) ? [] : units[j][2];\r\n                  if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                      from = units[j];\r\n                  }\r\n                }\r\n            }\r\n    \r\n            // Lookup to prefix\r\n            if (to === null) {\r\n                var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\r\n                var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\r\n    \r\n                // Handle dekao unit prefix (only unit prefix with two characters)\r\n                if (to_unit.substring(0, 2) === 'da') {\r\n                  to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n                }\r\n    \r\n                // Handle binary prefixes first (so that 'Yi' is processed before\r\n                // 'Y')\r\n                if (to_binary_prefix) {\r\n                  to_multiplier = to_binary_prefix[2];\r\n                  base_to_unit = to_unit.substring(2);\r\n                } else if (to_unit_prefix) {\r\n                  to_multiplier = to_unit_prefix[1];\r\n                  base_to_unit = to_unit.substring(to_unit_prefix[2].length);\r\n                }\r\n    \r\n                // Lookup to unit\r\n                for (var k = 0; k < units.length; k++) {\r\n                  alt = (units[k][2] === null) ? [] : units[k][2];\r\n                  if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                      to = units[k];\r\n                  }\r\n                }\r\n            }\r\n    \r\n            // Return error if a unit does not exist\r\n            if (from === null || to === null) {\r\n                return error.na;\r\n            }\r\n    \r\n            // Return error if units represent different quantities\r\n            if (from[3] !== to[3]) {\r\n                return error.na;\r\n            }\r\n    \r\n            // Return converted number\r\n            return number * from[6] * from_multiplier / (to[6] * to_multiplier);\r\n        };\r\n    \r\n        exports.DEC2BIN = function(number, places) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n    \r\n            // Return error if number is not decimal, is lower than -512, or is\r\n            // greater than 511\r\n            if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character binary number if number is\r\n            // negative\r\n            if (number < 0) {\r\n                return '1' + REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\r\n            }\r\n    \r\n            // Convert decimal number to binary\r\n            var result = parseInt(number, 10).toString(2);\r\n    \r\n            // Return binary number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.DEC2HEX = function(number, places) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n    \r\n            // Return error if number is not decimal, is lower than -549755813888,\r\n            // or is greater than 549755813887\r\n            if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character hexadecimal number if number\r\n            // is negative\r\n            if (number < 0) {\r\n                return (1099511627776 + number).toString(16);\r\n            }\r\n    \r\n            // Convert decimal number to hexadecimal\r\n            var result = parseInt(number, 10).toString(16);\r\n    \r\n            // Return hexadecimal number using the minimum number of characters\r\n            // necessary if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.DEC2OCT = function(number, places) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n    \r\n            // Return error if number is not decimal, is lower than -549755813888,\r\n            // or is greater than 549755813887\r\n            if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            if (number < 0) {\r\n                return (1073741824 + number).toString(8);\r\n            }\r\n    \r\n            // Convert decimal number to octal\r\n            var result = parseInt(number, 10).toString(8);\r\n    \r\n            // Return octal number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.DELTA = function(number1, number2) {\r\n            // Set number2 to zero if undefined\r\n            number2 = (number2 === undefined) ? 0 : number2;\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return delta\r\n            return (number1 === number2) ? 1 : 0;\r\n        };\r\n    \r\n        exports.ERF = function(lower_bound, upper_bound) {\r\n        };\r\n    \r\n        exports.ERF.PRECISE = function() {\r\n        };\r\n    \r\n        exports.ERFC = function(x) {\r\n        };\r\n    \r\n        exports.ERFC.PRECISE = function() {\r\n        };\r\n    \r\n        exports.GESTEP = function(number, step) {\r\n            step = step || 0;\r\n            number = utils.parseNumber(number);\r\n            if (utils.anyIsError(step, number)) {\r\n                return number;\r\n            }\r\n    \r\n            // Return delta\r\n            return (number >= step) ? 1 : 0;\r\n        };\r\n    \r\n        exports.HEX2BIN = function(number, places) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Check if number is negative\r\n            var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\r\n    \r\n            // Convert hexadecimal number to decimal\r\n            var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\r\n    \r\n            // Return error if number is lower than -512 or greater than 511\r\n            if (decimal < -512 || decimal > 511) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character binary number if number is\r\n            // negative\r\n            if (negative) {\r\n                return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n            }\r\n    \r\n            // Convert decimal number to binary\r\n            var result = decimal.toString(2);\r\n    \r\n            // Return binary number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.HEX2DEC = function(number) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Convert hexadecimal number to decimal\r\n            var decimal = parseInt(number, 16);\r\n    \r\n            // Return decimal number\r\n            return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\r\n        };\r\n    \r\n        exports.HEX2OCT = function(number, places) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Convert hexadecimal number to decimal\r\n            var decimal = parseInt(number, 16);\r\n    \r\n            // Return error if number is positive and greater than 0x1fffffff\r\n            // (536870911)\r\n            if (decimal > 536870911 && decimal < 1098974756864) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            if (decimal >= 1098974756864) {\r\n                return (decimal - 1098437885952).toString(8);\r\n            }\r\n    \r\n            // Convert decimal number to octal\r\n            var result = decimal.toString(8);\r\n    \r\n            // Return octal number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.IMABS = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return absolute value of complex number\r\n            return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n        };\r\n    \r\n        exports.IMAGINARY = function(inumber) {\r\n            if (inumber === undefined || inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return 0 if inumber is equal to 0\r\n            if (inumber === 0 || inumber === '0') {\r\n                return 0;\r\n            }\r\n    \r\n            // Handle special cases\r\n            if (['i', 'j'].indexOf(inumber) >= 0) {\r\n                return 1;\r\n            }\r\n    \r\n            // Normalize imaginary coefficient\r\n            inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\r\n    \r\n            // Lookup sign\r\n            var plus = inumber.indexOf('+');\r\n            var minus = inumber.indexOf('-');\r\n            if (plus === 0) {\r\n                plus = inumber.indexOf('+', 1);\r\n            }\r\n    \r\n            if (minus === 0) {\r\n                minus = inumber.indexOf('-', 1);\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var last = inumber.substring(inumber.length - 1, inumber.length);\r\n            var unit = (last === 'i' || last === 'j');\r\n    \r\n            if (plus >= 0 || minus >= 0) {\r\n                // Return error if imaginary unit is neither i nor j\r\n                if (!unit) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Return imaginary coefficient of complex number\r\n                if (plus >= 0) {\r\n                  return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                      error.num :\r\n                      Number(inumber.substring(plus + 1, inumber.length - 1));\r\n                } else {\r\n                  return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                      error.num :\r\n                      -Number(inumber.substring(minus + 1, inumber.length - 1));\r\n                }\r\n            } else {\r\n                if (unit) {\r\n                  return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\r\n                } else {\r\n                  return (isNaN(inumber)) ? error.num : 0;\r\n                }\r\n            }\r\n        };\r\n    \r\n        exports.IMARGUMENT = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if inumber is equal to zero\r\n            if (x === 0 && y === 0) {\r\n                return error.div0;\r\n            }\r\n    \r\n            // Return PI/2 if x is equal to zero and y is positive\r\n            if (x === 0 && y > 0) {\r\n                return Math.PI / 2;\r\n            }\r\n    \r\n            // Return -PI/2 if x is equal to zero and y is negative\r\n            if (x === 0 && y < 0) {\r\n                return -Math.PI / 2;\r\n            }\r\n    \r\n            // Return zero if x is negative and y is equal to zero\r\n            if (y === 0 && x > 0) {\r\n                return 0;\r\n            }\r\n    \r\n            // Return zero if x is negative and y is equal to zero\r\n            if (y === 0 && x < 0) {\r\n                return -Math.PI;\r\n            }\r\n    \r\n            // Return argument of complex number\r\n            if (x > 0) {\r\n                return Math.atan(y / x);\r\n            } else if (x < 0 && y >= 0) {\r\n                return Math.atan(y / x) + Math.PI;\r\n            } else {\r\n                return Math.atan(y / x) - Math.PI;\r\n            }\r\n        };\r\n    \r\n        exports.IMCONJUGATE = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return conjugate of complex number\r\n            return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\r\n        };\r\n    \r\n        exports.IMCOS = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return cosine of complex number\r\n            return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n        };\r\n    \r\n        exports.IMCOSH = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return hyperbolic cosine of complex number\r\n            return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\r\n        };\r\n    \r\n        exports.IMCOT = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return cotangent of complex number\r\n            return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\r\n        };\r\n    \r\n        exports.IMDIV = function(inumber1, inumber2) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var a = exports.IMREAL(inumber1);\r\n            var b = exports.IMAGINARY(inumber1);\r\n            var c = exports.IMREAL(inumber2);\r\n            var d = exports.IMAGINARY(inumber2);\r\n    \r\n            if (utils.anyIsError(a, b, c, d)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit1 = inumber1.substring(inumber1.length - 1);\r\n            var unit2 = inumber2.substring(inumber2.length - 1);\r\n            var unit = 'i';\r\n            if (unit1 === 'j') {\r\n                unit = 'j';\r\n            } else if (unit2 === 'j') {\r\n                unit = 'j';\r\n            }\r\n    \r\n            // Return error if inumber2 is null\r\n            if (c === 0 && d === 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return exponential of complex number\r\n            var den = c * c + d * d;\r\n            return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\r\n        };\r\n    \r\n        exports.IMEXP = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return exponential of complex number\r\n            var e = Math.exp(x);\r\n            return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\r\n        };\r\n    \r\n        exports.IMLN = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\r\n        };\r\n    \r\n        exports.IMLOG10 = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\r\n        };\r\n    \r\n        exports.IMLOG2 = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\r\n        };\r\n    \r\n        exports.IMPOWER = function(inumber, number) {\r\n            number = utils.parseNumber(number);\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n            if (utils.anyIsError(number, x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Calculate power of modulus\r\n            var p = Math.pow(exports.IMABS(inumber), number);\r\n    \r\n            // Calculate argument\r\n            var t = exports.IMARGUMENT(inumber);\r\n    \r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\r\n        };\r\n    \r\n        exports.IMPRODUCT = function() {\r\n            // Initialize result\r\n            var result = arguments[0];\r\n    \r\n            // Loop on all numbers\r\n            for (var i = 1; i < arguments.length; i++) {\r\n                // Lookup coefficients of two complex numbers\r\n                var a = exports.IMREAL(result);\r\n                var b = exports.IMAGINARY(result);\r\n                var c = exports.IMREAL(arguments[i]);\r\n                var d = exports.IMAGINARY(arguments[i]);\r\n    \r\n                if (utils.anyIsError(a, b, c, d)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Complute product of two complex numbers\r\n                result = exports.COMPLEX(a * c - b * d, a * d + b * c);\r\n            }\r\n    \r\n            // Return product of complex numbers\r\n            return result;\r\n        };\r\n    \r\n        exports.IMREAL = function(inumber) {\r\n            if (inumber === undefined || inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return 0 if inumber is equal to 0\r\n            if (inumber === 0 || inumber === '0') {\r\n                return 0;\r\n            }\r\n    \r\n            // Handle special cases\r\n            if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\r\n                return 0;\r\n            }\r\n    \r\n            // Lookup sign\r\n            var plus = inumber.indexOf('+');\r\n            var minus = inumber.indexOf('-');\r\n            if (plus === 0) {\r\n                plus = inumber.indexOf('+', 1);\r\n            }\r\n            if (minus === 0) {\r\n                minus = inumber.indexOf('-', 1);\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var last = inumber.substring(inumber.length - 1, inumber.length);\r\n            var unit = (last === 'i' || last === 'j');\r\n    \r\n            if (plus >= 0 || minus >= 0) {\r\n                // Return error if imaginary unit is neither i nor j\r\n                if (!unit) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Return real coefficient of complex number\r\n                if (plus >= 0) {\r\n                  return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                      error.num :\r\n                      Number(inumber.substring(0, plus));\r\n                } else {\r\n                  return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                      error.num :\r\n                      Number(inumber.substring(0, minus));\r\n                }\r\n            } else {\r\n                if (unit) {\r\n                  return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\r\n                } else {\r\n                  return (isNaN(inumber)) ? error.num : inumber;\r\n                }\r\n            }\r\n        };\r\n    \r\n        exports.IMSEC = function(inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return secant of complex number\r\n            return exports.IMDIV('1', exports.IMCOS(inumber));\r\n        };\r\n    \r\n        exports.IMSECH = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return hyperbolic secant of complex number\r\n            return exports.IMDIV('1', exports.IMCOSH(inumber));\r\n        };\r\n    \r\n        exports.IMSIN = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return sine of complex number\r\n            return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n        };\r\n    \r\n        exports.IMSINH = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Return hyperbolic sine of complex number\r\n            return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\r\n        };\r\n    \r\n        exports.IMSQRT = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n    \r\n            // Calculate power of modulus\r\n            var s = Math.sqrt(exports.IMABS(inumber));\r\n    \r\n            // Calculate argument\r\n            var t = exports.IMARGUMENT(inumber);\r\n    \r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\r\n        };\r\n    \r\n        exports.IMCSC = function (inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return cosecant of complex number\r\n            return exports.IMDIV('1', exports.IMSIN(inumber));\r\n        };\r\n    \r\n        exports.IMCSCH = function (inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return hyperbolic cosecant of complex number\r\n            return exports.IMDIV('1', exports.IMSINH(inumber));\r\n        };\r\n    \r\n        exports.IMSUB = function(inumber1, inumber2) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var a = this.IMREAL(inumber1);\r\n            var b = this.IMAGINARY(inumber1);\r\n            var c = this.IMREAL(inumber2);\r\n            var d = this.IMAGINARY(inumber2);\r\n    \r\n            if (utils.anyIsError(a, b, c, d)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup imaginary unit\r\n            var unit1 = inumber1.substring(inumber1.length - 1);\r\n            var unit2 = inumber2.substring(inumber2.length - 1);\r\n            var unit = 'i';\r\n            if (unit1 === 'j') {\r\n                unit = 'j';\r\n            } else if (unit2 === 'j') {\r\n                unit = 'j';\r\n            }\r\n    \r\n            // Return _ of two complex numbers\r\n            return this.COMPLEX(a - c, b - d, unit);\r\n        };\r\n    \r\n        exports.IMSUM = function() {\r\n            var args = utils.flatten(arguments);\r\n    \r\n            // Initialize result\r\n            var result = args[0];\r\n    \r\n            // Loop on all numbers\r\n            for (var i = 1; i < args.length; i++) {\r\n                // Lookup coefficients of two complex numbers\r\n                var a = this.IMREAL(result);\r\n                var b = this.IMAGINARY(result);\r\n                var c = this.IMREAL(args[i]);\r\n                var d = this.IMAGINARY(args[i]);\r\n    \r\n                if (utils.anyIsError(a, b, c, d)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Complute product of two complex numbers\r\n                result = this.COMPLEX(a + c, b + d);\r\n            }\r\n    \r\n            // Return sum of complex numbers\r\n            return result;\r\n        };\r\n    \r\n        exports.IMTAN = function(inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n    \r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return tangent of complex number\r\n            return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));\r\n        };\r\n    \r\n        exports.OCT2BIN = function(number, places) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-7]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Check if number is negative\r\n            var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\r\n    \r\n            // Convert octal number to decimal\r\n            var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\r\n    \r\n            // Return error if number is lower than -512 or greater than 511\r\n            if (decimal < -512 || decimal > 511) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Ignore places and return a 10-character binary number if number is\r\n            // negative\r\n            if (negative) {\r\n                return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n            }\r\n    \r\n            // Convert decimal number to binary\r\n            var result = decimal.toString(2);\r\n    \r\n            // Return binary number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        exports.OCT2DEC = function(number) {\r\n            // Return error if number is not octal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-7]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Convert octal number to decimal\r\n            var decimal = parseInt(number, 8);\r\n    \r\n            // Return decimal number\r\n            return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\r\n        };\r\n    \r\n        exports.OCT2HEX = function(number, places) {\r\n            // Return error if number is not octal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-7]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Convert octal number to decimal\r\n            var decimal = parseInt(number, 8);\r\n    \r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            if (decimal >= 536870912) {\r\n                return 'ff' + (decimal + 3221225472).toString(16);\r\n            }\r\n    \r\n            // Convert decimal number to hexadecimal\r\n            var result = decimal.toString(16);\r\n    \r\n            // Return hexadecimal number using the minimum number of characters\r\n            // necessary if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                  return error.value;\r\n                }\r\n    \r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                  return error.num;\r\n                }\r\n    \r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n    \r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.financial = (function() {\r\n        var exports = {};\r\n    \r\n        function validDate(d) {\r\n            return d && d.getTime && !isNaN(d.getTime());\r\n        }\r\n    \r\n        function ensureDate(d) {\r\n            return (d instanceof Date)?d:new Date(d);\r\n        }\r\n    \r\n        exports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\r\n            // Return error if either date is invalid\r\n            issue        = ensureDate(issue);\r\n            first        = ensureDate(first);\r\n            settlement = ensureDate(settlement);\r\n            if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\r\n                return '#VALUE!';\r\n            }\r\n    \r\n            // Return error if either rate or par are lower than or equal to zero\r\n            if (rate <= 0 || par <= 0) {\r\n                return '#NUM!';\r\n            }\r\n    \r\n            // Return error if frequency is neither 1, 2, or 4\r\n            if ([1, 2, 4].indexOf(frequency) === -1) {\r\n                return '#NUM!';\r\n            }\r\n    \r\n            // Return error if basis is neither 0, 1, 2, 3, or 4\r\n            if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\r\n                return '#NUM!';\r\n            }\r\n    \r\n            // Return error if settlement is before or equal to issue\r\n            if (settlement <= issue) {\r\n                return '#NUM!';\r\n            }\r\n    \r\n            // Set default values\r\n            par   = par   || 0;\r\n            basis = basis || 0;\r\n    \r\n            // Compute accrued interest\r\n            return par * rate * YEARFRAC(issue, settlement, basis);\r\n        };\r\n    \r\n        exports.ACCRINTM = null;\r\n    \r\n        exports.AMORDEGRC = null;\r\n    \r\n        exports.AMORLINC = null;\r\n    \r\n        exports.COUPDAYBS = null;\r\n    \r\n        exports.COUPDAYS = null;\r\n    \r\n        exports.COUPDAYSNC = null;\r\n    \r\n        exports.COUPNCD = null;\r\n    \r\n        exports.COUPNUM = null;\r\n    \r\n        exports.COUPPCD = null;\r\n    \r\n        exports.CUMIPMT = function(rate, periods, value, start, end, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n            // Credits: Hannes Stiebitzhofer for the translations of function and\r\n                // variable names\r\n            // Requires exports.FV() and exports.PMT() from exports.js\r\n                // [http://stoic.com/exports/]\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            value = utils.parseNumber(value);\r\n            if (utils.anyIsError(rate, periods, value)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if either rate, periods, or value are lower than or\r\n                // equal to zero\r\n            if (rate <= 0 || periods <= 0 || value <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if start < 1, end < 1, or start > end\r\n            if (start < 1 || end < 1 || start > end) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if type is neither 0 nor 1\r\n            if (type !== 0 && type !== 1) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Compute cumulative interest\r\n            var payment = exports.PMT(rate, periods, value, 0, type);\r\n            var interest = 0;\r\n    \r\n            if (start === 1) {\r\n                if (type === 0) {\r\n                    interest = -value;\r\n                    start++;\r\n                }\r\n            }\r\n    \r\n            for (var i = start; i <= end; i++) {\r\n                if (type === 1) {\r\n                    interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\r\n                } else {\r\n                    interest += exports.FV(rate, i - 1, payment, value, 0);\r\n                }\r\n            }\r\n            interest *= rate;\r\n    \r\n            // Return cumulative interest\r\n            return interest;\r\n        };\r\n    \r\n        exports.CUMPRINC = function(rate, periods, value, start, end, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n            // Credits: Hannes Stiebitzhofer for the translations of function and\r\n                // variable names\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            value = utils.parseNumber(value);\r\n            if (utils.anyIsError(rate, periods, value)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if either rate, periods, or value are lower than or\r\n                // equal to zero\r\n            if (rate <= 0 || periods <= 0 || value <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if start < 1, end < 1, or start > end\r\n            if (start < 1 || end < 1 || start > end) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if type is neither 0 nor 1\r\n            if (type !== 0 && type !== 1) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Compute cumulative principal\r\n            var payment = exports.PMT(rate, periods, value, 0, type);\r\n            var principal = 0;\r\n            if (start === 1) {\r\n                if (type === 0) {\r\n                    principal = payment + value * rate;\r\n                } else {\r\n                    principal = payment;\r\n                }\r\n                start++;\r\n            }\r\n            for (var i = start; i <= end; i++) {\r\n                if (type > 0) {\r\n                    principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\r\n                } else {\r\n                    principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\r\n                }\r\n            }\r\n    \r\n            // Return cumulative principal\r\n            return principal;\r\n        };\r\n    \r\n        exports.DB = function(cost, salvage, life, period, month) {\r\n            // Initialize month\r\n            month = (month === undefined) ? 12 : month;\r\n    \r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            period = utils.parseNumber(period);\r\n            month = utils.parseNumber(month);\r\n            if (utils.anyIsError(cost, salvage, life, period, month)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if any of the parameters is negative\r\n            if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if month is not an integer between 1 and 12\r\n            if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if period is greater than life\r\n            if (period > life) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return 0 (zero) if salvage is greater than or equal to cost\r\n            if (salvage >= cost) {\r\n                return 0;\r\n            }\r\n    \r\n            // Rate is rounded to three decimals places\r\n            var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\r\n    \r\n            // Compute initial depreciation\r\n            var initial = cost * rate * month / 12;\r\n    \r\n            // Compute total depreciation\r\n            var total = initial;\r\n            var current = 0;\r\n            var ceiling = (period === life) ? life - 1 : period;\r\n            for (var i = 2; i <= ceiling; i++) {\r\n                current = (cost - total) * rate;\r\n                total += current;\r\n            }\r\n    \r\n            // Depreciation for the first and last periods are special cases\r\n            if (period === 1) {\r\n                // First period\r\n                return initial;\r\n            } else if (period === life) {\r\n                // Last period\r\n                return (cost - total) * rate;\r\n            } else {\r\n                return current;\r\n            }\r\n        };\r\n    \r\n        exports.DDB = function(cost, salvage, life, period, factor) {\r\n            // Initialize factor\r\n            factor = (factor === undefined) ? 2 : factor;\r\n    \r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            period = utils.parseNumber(period);\r\n            factor = utils.parseNumber(factor);\r\n            if (utils.anyIsError(cost, salvage, life, period, factor)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if any of the parameters is negative or if factor is\r\n                // null\r\n            if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if period is greater than life\r\n            if (period > life) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return 0 (zero) if salvage is greater than or equal to cost\r\n            if (salvage >= cost) {\r\n                return 0;\r\n            }\r\n    \r\n            // Compute depreciation\r\n            var total = 0;\r\n            var current = 0;\r\n            for (var i = 1; i <= period; i++) {\r\n                current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\r\n                total += current;\r\n            }\r\n    \r\n            // Return depreciation\r\n            return current;\r\n        };\r\n    \r\n        exports.DISC = null;\r\n    \r\n        exports.DOLLARDE = function(dollar, fraction) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            dollar = utils.parseNumber(dollar);\r\n            fraction = utils.parseNumber(fraction);\r\n            if (utils.anyIsError(dollar, fraction)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if fraction is negative\r\n            if (fraction < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if fraction is greater than or equal to 0 and less than\r\n                // 1\r\n            if (fraction >= 0 && fraction < 1) {\r\n                return error.div0;\r\n            }\r\n    \r\n            // Truncate fraction if it is not an integer\r\n            fraction = parseInt(fraction, 10);\r\n    \r\n            // Compute integer part\r\n            var result = parseInt(dollar, 10);\r\n    \r\n            // Add decimal part\r\n            result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\r\n    \r\n            // Round result\r\n            var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\r\n            result = Math.round(result * power) / power;\r\n    \r\n            // Return converted dollar price\r\n            return result;\r\n        };\r\n    \r\n        exports.DOLLARFR = function(dollar, fraction) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            dollar = utils.parseNumber(dollar);\r\n            fraction = utils.parseNumber(fraction);\r\n            if (utils.anyIsError(dollar, fraction)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if fraction is negative\r\n            if (fraction < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if fraction is greater than or equal to 0 and less than\r\n                // 1\r\n            if (fraction >= 0 && fraction < 1) {\r\n                return error.div0;\r\n            }\r\n    \r\n            // Truncate fraction if it is not an integer\r\n            fraction = parseInt(fraction, 10);\r\n    \r\n            // Compute integer part\r\n            var result = parseInt(dollar, 10);\r\n    \r\n            // Add decimal part\r\n            result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\r\n    \r\n            // Return converted dollar price\r\n            return result;\r\n        };\r\n    \r\n        exports.DURATION = null;\r\n    \r\n        exports.EFFECT = function(rate, periods) {\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            if (utils.anyIsError(rate, periods)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if rate <=0 or periods < 1\r\n            if (rate <= 0 || periods < 1) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Truncate periods if it is not an integer\r\n            periods = parseInt(periods, 10);\r\n    \r\n            // Return effective annual interest rate\r\n            return Math.pow(1 + rate / periods, periods) - 1;\r\n        };\r\n    \r\n        exports.FV = function(rate, periods, payment, value, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            value = value || 0;\r\n            type = type || 0;\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            payment = utils.parseNumber(payment);\r\n            value = utils.parseNumber(value);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, payment, value, type)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return future value\r\n            var result;\r\n            if (rate === 0) {\r\n                result = value + payment * periods;\r\n            } else {\r\n                var term = Math.pow(1 + rate, periods);\r\n                if (type === 1) {\r\n                    result = value * term + payment * (1 + rate) * (term - 1) / rate;\r\n                } else {\r\n                    result = value * term + payment * (term - 1) / rate;\r\n                }\r\n            }\r\n            return -result;\r\n        };\r\n    \r\n        exports.FVSCHEDULE = function(principal, schedule) {\r\n            principal = utils.parseNumber(principal);\r\n            schedule = utils.parseNumberArray(utils.flatten(schedule));\r\n            if (utils.anyIsError(principal, schedule)) {\r\n                return error.value;\r\n            }\r\n    \r\n            var n = schedule.length;\r\n            var future = principal;\r\n    \r\n            // Apply all interests in schedule\r\n            for (var i = 0; i < n; i++) {\r\n                // Apply scheduled interest\r\n                future *= 1 + schedule[i];\r\n            }\r\n    \r\n            // Return future value\r\n            return future;\r\n        };\r\n    \r\n        exports.INTRATE = null;\r\n    \r\n        exports.IPMT = function(rate, period, periods, present, future, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            future = future || 0;\r\n            type = type || 0;\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            period = utils.parseNumber(period);\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, period, periods, present, future, type)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Compute payment\r\n            var payment = exports.PMT(rate, periods, present, future, type);\r\n    \r\n            // Compute interest\r\n            var interest;\r\n            if (period === 1) {\r\n                if (type === 1) {\r\n                    interest = 0;\r\n                } else {\r\n                    interest = -present;\r\n                }\r\n            } else {\r\n                if (type === 1) {\r\n                    interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\r\n                } else {\r\n                    interest = exports.FV(rate, period - 1, payment, present, 0);\r\n                }\r\n            }\r\n    \r\n            // Return interest\r\n            return interest * rate;\r\n        };\r\n    \r\n        exports.IRR = function(values, guess) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            guess = guess || 0;\r\n    \r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            guess = utils.parseNumber(guess);\r\n            if (utils.anyIsError(values, guess)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Calculates the resulting amount\r\n            var irrResult = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = values[0];\r\n                for (var i = 1; i < values.length; i++) {\r\n                    result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\r\n                }\r\n                return result;\r\n            };\r\n    \r\n            // Calculates the first derivation\r\n            var irrResultDeriv = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = 0;\r\n                for (var i = 1; i < values.length; i++) {\r\n                    var frac = (dates[i] - dates[0]) / 365;\r\n                    result -= frac * values[i] / Math.pow(r, frac + 1);\r\n                }\r\n                return result;\r\n            };\r\n    \r\n            // Initialize dates and check that values contains at least one positive\r\n                // value and one negative value\r\n            var dates = [];\r\n            var positive = false;\r\n            var negative = false;\r\n            for (var i = 0; i < values.length; i++) {\r\n                dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\r\n                if (values[i] > 0) {\r\n                    positive = true;\r\n                }\r\n                if (values[i] < 0) {\r\n                    negative = true;\r\n                }\r\n            }\r\n    \r\n            // Return error if values does not contain at least one positive value\r\n                // and one negative value\r\n            if (!positive || !negative) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Initialize guess and resultRate\r\n            guess = (guess === undefined) ? 0.1 : guess;\r\n            var resultRate = guess;\r\n    \r\n            // Set maximum epsilon for end of iteration\r\n            var epsMax = 1e-10;\r\n    \r\n            // Implement Newton's method\r\n            var newRate, epsRate, resultValue;\r\n            var contLoop = true;\r\n            do {\r\n                resultValue = irrResult(values, dates, resultRate);\r\n                newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n                epsRate = Math.abs(newRate - resultRate);\r\n                resultRate = newRate;\r\n                contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n            } while (contLoop);\r\n    \r\n            // Return internal rate of return\r\n            return resultRate;\r\n        };\r\n    \r\n        exports.ISPMT = function(rate, period, periods, value) {\r\n            rate = utils.parseNumber(rate);\r\n            period = utils.parseNumber(period);\r\n            periods = utils.parseNumber(periods);\r\n            value = utils.parseNumber(value);\r\n            if (utils.anyIsError(rate, period, periods, value)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return interest\r\n            return value * rate * (period / periods - 1);\r\n        };\r\n    \r\n        exports.MDURATION = null;\r\n    \r\n        exports.MIRR = function(values, finance_rate, reinvest_rate) {\r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            finance_rate = utils.parseNumber(finance_rate);\r\n            reinvest_rate = utils.parseNumber(reinvest_rate);\r\n            if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Initialize number of values\r\n            var n = values.length;\r\n    \r\n            // Lookup payments (negative values) and incomes (positive values)\r\n            var payments = [];\r\n            var incomes = [];\r\n            for (var i = 0; i < n; i++) {\r\n                if (values[i] < 0) {\r\n                    payments.push(values[i]);\r\n                } else {\r\n                    incomes.push(values[i]);\r\n                }\r\n            }\r\n    \r\n            // Return modified internal rate of return\r\n            var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\r\n            var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\r\n            return Math.pow(num / den, 1 / (n - 1)) - 1;\r\n        };\r\n    \r\n        exports.NOMINAL = function(rate, periods) {\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            if (utils.anyIsError(rate, periods)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if rate <=0 or periods < 1\r\n            if (rate <= 0 || periods < 1) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Truncate periods if it is not an integer\r\n            periods = parseInt(periods, 10);\r\n    \r\n            // Return nominal annual interest rate\r\n            return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\r\n        };\r\n    \r\n        exports.NPER = function(rate, payment, present, future, type) {\r\n            type = (type === undefined) ? 0 : type;\r\n            future = (future === undefined) ? 0 : future;\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            payment = utils.parseNumber(payment);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, payment, present, future, type)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return number of periods\r\n            var num = payment * (1 + rate * type) - future * rate;\r\n            var den = (present * rate + payment * (1 + rate * type));\r\n            return Math.log(num / den) / Math.log(1 + rate);\r\n        };\r\n    \r\n        exports.NPV = function() {\r\n            var args = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (args instanceof Error) {\r\n                return args;\r\n            }\r\n    \r\n            // Lookup rate\r\n            var rate = args[0];\r\n    \r\n            // Initialize net present value\r\n            var value = 0;\r\n    \r\n            // Loop on all values\r\n            for (var j = 1; j < args.length; j++) {\r\n                value += args[j] / Math.pow(1 + rate, j);\r\n            }\r\n    \r\n            // Return net present value\r\n            return value;\r\n        };\r\n    \r\n        exports.ODDFPRICE = null;\r\n    \r\n        exports.ODDFYIELD = null;\r\n    \r\n        exports.ODDLPRICE = null;\r\n    \r\n        exports.ODDLYIELD = null;\r\n    \r\n        exports.PDURATION = function(rate, present, future) {\r\n            rate = utils.parseNumber(rate);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            if (utils.anyIsError(rate, present, future)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if rate <=0\r\n            if (rate <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return number of periods\r\n            return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\r\n        };\r\n    \r\n        exports.PMT = function(rate, periods, present, future, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            future = future || 0;\r\n            type = type || 0;\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, present, future, type)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return payment\r\n            var result;\r\n            if (rate === 0) {\r\n                result = (present + future) / periods;\r\n            } else {\r\n                var term = Math.pow(1 + rate, periods);\r\n                if (type === 1) {\r\n                    result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\r\n                } else {\r\n                    result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\r\n                }\r\n            }\r\n            return -result;\r\n        };\r\n    \r\n        exports.PPMT = function(rate, period, periods, present, future, type) {\r\n            future = future || 0;\r\n            type = type || 0;\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, present, future, type)) {\r\n                return error.value;\r\n            }\r\n    \r\n            return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\r\n        };\r\n    \r\n        exports.PRICE = null;\r\n    \r\n        exports.PRICEDISC = null;\r\n    \r\n        exports.PRICEMAT = null;\r\n    \r\n        exports.PV = function(rate, periods, payment, future, type) {\r\n            future = future || 0;\r\n            type = type || 0;\r\n    \r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            payment = utils.parseNumber(payment);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, payment, future, type)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return present value\r\n            if (rate === 0) {\r\n                return -payment * periods - future;\r\n            } else {\r\n                return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\r\n            }\r\n        };\r\n    \r\n        exports.RATE = function(periods, payment, present, future, type, guess) {\r\n            // Credits: rabugento\r\n    \r\n            guess = (guess === undefined) ? 0.01 : guess;\r\n            future = (future === undefined) ? 0 : future;\r\n            type = (type === undefined) ? 0 : type;\r\n    \r\n            periods = utils.parseNumber(periods);\r\n            payment = utils.parseNumber(payment);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            guess = utils.parseNumber(guess);\r\n            if (utils.anyIsError(periods, payment, present, future, type, guess)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Set maximum epsilon for end of iteration\r\n            var epsMax = 1e-6;\r\n    \r\n            // Set maximum number of iterations\r\n            var iterMax = 100;\r\n            var iter = 0;\r\n            var close = false;\r\n            var rate = guess;\r\n    \r\n            while (iter < iterMax && !close) {\r\n                var t1 = Math.pow(rate + 1, periods);\r\n                var t2 = Math.pow(rate + 1, periods - 1);\r\n    \r\n                var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\r\n                var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\r\n                var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\r\n    \r\n                var newRate = rate - f1 / (f2 + f3);\r\n    \r\n                if (Math.abs(newRate - rate) < epsMax) close = true;\r\n                iter++\r\n                rate = newRate;\r\n            }\r\n    \r\n            if (!close) return Number.NaN + rate;\r\n            return rate;\r\n        };\r\n    \r\n        // TODO\r\n        exports.RECEIVED = null;\r\n    \r\n        exports.RRI = function(periods, present, future) {\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            if (utils.anyIsError(periods, present, future)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if periods or present is equal to 0 (zero)\r\n            if (periods === 0 || present === 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return equivalent interest rate\r\n            return Math.pow(future / present, 1 / periods) - 1;\r\n        };\r\n    \r\n        exports.SLN = function(cost, salvage, life) {\r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            if (utils.anyIsError(cost, salvage, life)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if life equal to 0 (zero)\r\n            if (life === 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return straight-line depreciation\r\n            return (cost - salvage) / life;\r\n        };\r\n    \r\n        exports.SYD = function(cost, salvage, life, period) {\r\n            // Return error if any of the parameters is not a number\r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            period = utils.parseNumber(period);\r\n            if (utils.anyIsError(cost, salvage, life, period)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if life equal to 0 (zero)\r\n            if (life === 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if period is lower than 1 or greater than life\r\n            if (period < 1 || period > life) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Truncate period if it is not an integer\r\n            period = parseInt(period, 10);\r\n    \r\n            // Return straight-line depreciation\r\n            return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\r\n        };\r\n    \r\n        exports.TBILLEQ = function(settlement, maturity, discount) {\r\n            settlement = utils.parseDate(settlement);\r\n            maturity = utils.parseDate(maturity);\r\n            discount = utils.parseNumber(discount);\r\n            if (utils.anyIsError(settlement, maturity, discount)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if discount is lower than or equal to zero\r\n            if (discount <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if settlement is greater than maturity\r\n            if (settlement > maturity) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if maturity is more than one year after settlement\r\n            if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return bond-equivalent yield\r\n            return (365 * discount) / (360 - discount * DAYS360(settlement, maturity, false));\r\n        };\r\n    \r\n        exports.TBILLPRICE = function(settlement, maturity, discount) {\r\n            settlement = utils.parseDate(settlement);\r\n            maturity = utils.parseDate(maturity);\r\n            discount = utils.parseNumber(discount);\r\n            if (utils.anyIsError(settlement, maturity, discount)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if discount is lower than or equal to zero\r\n            if (discount <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if settlement is greater than maturity\r\n            if (settlement > maturity) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if maturity is more than one year after settlement\r\n            if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return bond-equivalent yield\r\n            return 100 * (1 - discount * DAYS360(settlement, maturity, false) / 360);\r\n        };\r\n    \r\n        exports.TBILLYIELD = function(settlement, maturity, price) {\r\n            settlement = utils.parseDate(settlement);\r\n            maturity = utils.parseDate(maturity);\r\n            price = utils.parseNumber(price);\r\n            if (utils.anyIsError(settlement, maturity, price)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Return error if price is lower than or equal to zero\r\n            if (price <= 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if settlement is greater than maturity\r\n            if (settlement > maturity) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return error if maturity is more than one year after settlement\r\n            if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Return bond-equivalent yield\r\n            return (100 - price) * 360 / (price * DAYS360(settlement, maturity, false));\r\n        };\r\n    \r\n        exports.VDB = null;\r\n    \r\n        exports.XIRR = function(values, dates, guess) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n    \r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            dates = utils.parseDateArray(utils.flatten(dates));\r\n            guess = utils.parseNumber(guess);\r\n            if (utils.anyIsError(values, dates, guess)) {\r\n                return error.value;\r\n            }\r\n    \r\n            // Calculates the resulting amount\r\n            var irrResult = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = values[0];\r\n                for (var i = 1; i < values.length; i++) {\r\n                    result += values[i] / Math.pow(r, DAYS(dates[i], dates[0]) / 365);\r\n                }\r\n                return result;\r\n            };\r\n    \r\n            // Calculates the first derivation\r\n            var irrResultDeriv = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = 0;\r\n                for (var i = 1; i < values.length; i++) {\r\n                    var frac = DAYS(dates[i], dates[0]) / 365;\r\n                    result -= frac * values[i] / Math.pow(r, frac + 1);\r\n                }\r\n                return result;\r\n            };\r\n    \r\n            // Check that values contains at least one positive value and one\r\n                // negative value\r\n            var positive = false;\r\n            var negative = false;\r\n            for (var i = 0; i < values.length; i++) {\r\n                if (values[i] > 0) {\r\n                    positive = true;\r\n                }\r\n                if (values[i] < 0) {\r\n                    negative = true;\r\n                }\r\n            }\r\n    \r\n            // Return error if values does not contain at least one positive value\r\n                // and one negative value\r\n            if (!positive || !negative) {\r\n                return error.num;\r\n            }\r\n    \r\n            // Initialize guess and resultRate\r\n            guess = guess || 0.1;\r\n            var resultRate = guess;\r\n    \r\n            // Set maximum epsilon for end of iteration\r\n            var epsMax = 1e-10;\r\n    \r\n            // Implement Newton's method\r\n            var newRate, epsRate, resultValue;\r\n            var contLoop = true;\r\n            do {\r\n                resultValue = irrResult(values, dates, resultRate);\r\n                newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n                epsRate = Math.abs(newRate - resultRate);\r\n                resultRate = newRate;\r\n                contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n            } while (contLoop);\r\n    \r\n            // Return internal rate of return\r\n            return resultRate;\r\n        };\r\n    \r\n        exports.XNPV = function(rate, values, dates) {\r\n            rate = utils.parseNumber(rate);\r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            dates = utils.parseDateArray(utils.flatten(dates));\r\n            if (utils.anyIsError(rate, values, dates)) {\r\n                return error.value;\r\n            }\r\n    \r\n            var result = 0;\r\n            for (var i = 0; i < values.length; i++) {\r\n                result += values[i] / Math.pow(1 + rate, DAYS(dates[i], dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.YIELD = null;\r\n    \r\n        exports.YIELDDISC = null;\r\n    \r\n        exports.YIELDMAT = null;\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.information = (function() {\r\n        var exports = {};\r\n        exports.CELL = null;\r\n    \r\n        exports.ERROR = {};\r\n        exports.ERROR.TYPE = function(error_val) {\r\n            switch (error_val) {\r\n                case error.nil: return 1;\r\n                case error.div0: return 2;\r\n                case error.value: return 3;\r\n                case error.ref: return 4;\r\n                case error.name: return 5;\r\n                case error.num: return 6;\r\n                case error.na: return 7;\r\n                case error.data: return 8;\r\n            }\r\n            return error.na;\r\n        };\r\n    \r\n        exports.INFO = null;\r\n    \r\n        exports.ISBLANK = function(value) {\r\n            return value === null;\r\n        };\r\n    \r\n        exports.ISBINARY = function (number) {\r\n            return (/^[01]{1,10}$/).test(number);\r\n        };\r\n    \r\n        exports.ISERR = function(value) {\r\n            return ([error.value, error.ref, error.div0, error.num, error.name, error.nil]).indexOf(value) >= 0 ||\r\n                (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\r\n        };\r\n    \r\n        exports.ISERROR = function(value) {\r\n            return exports.ISERR(value) || value === error.na;\r\n        };\r\n    \r\n        exports.ISEVEN = function(number) {\r\n            return (Math.floor(Math.abs(number)) & 1) ? false : true;\r\n        };\r\n    \r\n        // TODO\r\n        exports.ISFORMULA = null;\r\n    \r\n        exports.ISLOGICAL = function(value) {\r\n            return value === true || value === false;\r\n        };\r\n    \r\n        exports.ISNA = function(value) {\r\n            return value === error.na;\r\n        };\r\n    \r\n        exports.ISNONTEXT = function(value) {\r\n            return typeof(value) !== 'string';\r\n        };\r\n    \r\n        exports.ISNUMBER = function(value) {\r\n            return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\r\n        };\r\n    \r\n        exports.ISODD = function(number) {\r\n            return (Math.floor(Math.abs(number)) & 1) ? true : false;\r\n        };\r\n    \r\n        exports.ISREF = null;\r\n    \r\n        exports.ISTEXT = function(value) {\r\n            return typeof(value) === 'string';\r\n        };\r\n    \r\n        exports.N = function(value) {\r\n            if (this.ISNUMBER(value)) {\r\n                return value;\r\n            }\r\n            if (value instanceof Date) {\r\n                return value.getTime();\r\n            }\r\n            if (value === true) {\r\n                return 1;\r\n            }\r\n            if (value === false) {\r\n                return 0;\r\n            }\r\n            if (this.ISERROR(value)) {\r\n                return value;\r\n            }\r\n            return 0;\r\n        };\r\n    \r\n        exports.NA = function() {\r\n            return error.na;\r\n        };\r\n    \r\n        exports.SHEET = null;\r\n    \r\n        exports.SHEETS = null;\r\n    \r\n        exports.TYPE = function(value) {\r\n            if (this.ISNUMBER(value)) {\r\n                return 1;\r\n            }\r\n            if (this.ISTEXT(value)) {\r\n                return 2;\r\n            }\r\n            if (this.ISLOGICAL(value)) {\r\n                return 4;\r\n            }\r\n            if (this.ISERROR(value)) {\r\n                return 16;\r\n            }\r\n            if (Array.isArray(value)) {\r\n                return 64;\r\n            }\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.logical = (function() {\r\n        var exports = {};\r\n    \r\n        exports.AND = function() {\r\n            var args = utils.flatten(arguments);\r\n            var result = true;\r\n            for (var i = 0; i < args.length; i++) {\r\n                if (!args[i]) {\r\n                    result = false;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.CHOOSE = function() {\r\n            if (arguments.length < 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            var index = arguments[0];\r\n            if (index < 1 || index > 254) {\r\n                return error.value;\r\n            }\r\n    \r\n            if (arguments.length < index + 1) {\r\n                return error.value;\r\n            }\r\n    \r\n            return arguments[index];\r\n        };\r\n    \r\n        exports.FALSE = function() {\r\n            return false;\r\n        };\r\n    \r\n        exports.IF = function(test, then_value, otherwise_value) {\r\n            return test ? then_value : otherwise_value;\r\n        };\r\n    \r\n        exports.IFERROR = function(value, valueIfError) {\r\n            if (ISERROR(value)) {\r\n                return valueIfError;\r\n            }\r\n            return value;\r\n        };\r\n    \r\n        exports.IFNA = function(value, value_if_na) {\r\n            return value === error.na ? value_if_na : value;\r\n        };\r\n    \r\n        exports.NOT = function(logical) {\r\n            return !logical;\r\n        };\r\n    \r\n        exports.OR = function() {\r\n            var args = utils.flatten(arguments);\r\n            var result = false;\r\n            for (var i = 0; i < args.length; i++) {\r\n                if (args[i]) {\r\n                    result = true;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.TRUE = function() {\r\n            return true;\r\n        };\r\n    \r\n        exports.XOR = function() {\r\n            var args = utils.flatten(arguments);\r\n            var result = 0;\r\n            for (var i = 0; i < args.length; i++) {\r\n                if (args[i]) {\r\n                    result++;\r\n                }\r\n            }\r\n            return (Math.floor(Math.abs(result)) & 1) ? true : false;\r\n        };\r\n    \r\n        exports.SWITCH = function() {\r\n            var result;\r\n            if (arguments.length > 0)  {\r\n                var targetValue = arguments[0];\r\n                var argc = arguments.length - 1;\r\n                var switchCount = Math.floor(argc / 2);\r\n                var switchSatisfied = false;\r\n                var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\r\n    \r\n                if (switchCount) {\r\n                    for (var index = 0; index < switchCount; index++) {\r\n                        if (targetValue === arguments[index * 2 + 1]) {\r\n                          result = arguments[index * 2 + 2];\r\n                          switchSatisfied = true;\r\n                          break;\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                if (!switchSatisfied && defaultClause) {\r\n                    result = defaultClause;\r\n                }\r\n            }\r\n    \r\n            return result;\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.math = (function() {\r\n        var exports = {};\r\n    \r\n        exports.ABS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.abs(utils.parseNumber(number));\r\n        };\r\n    \r\n        exports.ACOS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.acos(number);\r\n        };\r\n    \r\n        exports.ACOSH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number + Math.sqrt(number * number - 1));\r\n        };\r\n    \r\n        exports.ACOT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.atan(1 / number);\r\n        };\r\n    \r\n        exports.ACOTH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 0.5 * Math.log((number + 1) / (number - 1));\r\n        };\r\n    \r\n        exports.AGGREGATE = null\r\n    \r\n        exports.ARABIC = function(text) {\r\n            // Credits: Rafa? Kukawski\r\n            if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\r\n                return error.value;\r\n            }\r\n            var r = 0;\r\n            text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function(i) {\r\n                r += {\r\n                    M: 1000,\r\n                    CM: 900,\r\n                    D: 500,\r\n                    CD: 400,\r\n                    C: 100,\r\n                    XC: 90,\r\n                    L: 50,\r\n                    XL: 40,\r\n                    X: 10,\r\n                    IX: 9,\r\n                    V: 5,\r\n                    IV: 4,\r\n                    I: 1\r\n                }[i];\r\n            });\r\n            return r;\r\n        };\r\n    \r\n        exports.ASIN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.asin(number);\r\n        };\r\n    \r\n        exports.ASINH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number + Math.sqrt(number * number + 1));\r\n        };\r\n    \r\n        exports.ATAN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.atan(number);\r\n        };\r\n    \r\n        exports.ATAN2 = function(number_x, number_y) {\r\n            number_x = utils.parseNumber(number_x);\r\n            number_y = utils.parseNumber(number_y);\r\n            if (utils.anyIsError(number_x, number_y)) {\r\n                return error.value;\r\n            }\r\n            return Math.atan2(number_x, number_y);\r\n        };\r\n    \r\n        exports.ATANH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log((1 + number) / (1 - number)) / 2;\r\n        };\r\n    \r\n        exports.BASE = function(number, radix, min_length) {\r\n            min_length = min_length || 0;\r\n    \r\n            number = utils.parseNumber(number);\r\n            radix = utils.parseNumber(radix);\r\n            min_length = utils.parseNumber(min_length);\r\n            if (utils.anyIsError(number, radix, min_length)) {\r\n                return error.value;\r\n            }\r\n            min_length = (min_length === undefined) ? 0 : min_length;\r\n            var result = number.toString(radix);\r\n            return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\r\n        };\r\n    \r\n        exports.CEILING = function(number, significance, mode) {\r\n            significance = (significance === undefined) ? 1 : significance;\r\n            mode = (mode === undefined) ? 0 : mode;\r\n    \r\n            number = utils.parseNumber(number);\r\n            significance = utils.parseNumber(significance);\r\n            mode = utils.parseNumber(mode);\r\n            if (utils.anyIsError(number, significance, mode)) {\r\n                return error.value;\r\n            }\r\n            if (significance === 0) {\r\n                return 0;\r\n            }\r\n    \r\n            significance = Math.abs(significance);\r\n            if (number >= 0) {\r\n                return Math.ceil(number / significance) * significance;\r\n            } else {\r\n                if (mode === 0) {\r\n                    return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n                } else {\r\n                    return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n                }\r\n            }\r\n        };\r\n    \r\n        exports.CEILING.MATH = exports.CEILING;\r\n    \r\n        exports.CEILING.PRECISE = exports.CEILING;\r\n    \r\n        exports.COMBIN = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\r\n        };\r\n    \r\n        exports.COMBINA = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\r\n        };\r\n    \r\n        exports.COS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.cos(number);\r\n        };\r\n    \r\n        exports.COSH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return (Math.exp(number) + Math.exp(-number)) / 2;\r\n        };\r\n    \r\n        exports.COT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 1 / Math.tan(number);\r\n        };\r\n    \r\n        exports.COTH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var e2 = Math.exp(2 * number);\r\n            return (e2 + 1) / (e2 - 1);\r\n        };\r\n    \r\n        exports.CSC = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 1 / Math.sin(number);\r\n        };\r\n    \r\n        exports.CSCH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 2 / (Math.exp(number) - Math.exp(-number));\r\n        };\r\n    \r\n        exports.DECIMAL = function(number, radix) {\r\n            if (arguments.length < 1) {\r\n                return error.value;\r\n            }\r\n    \r\n    \r\n            return parseInt(number, radix);\r\n        };\r\n    \r\n        exports.DEGREES = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return number * 180 / Math.PI;\r\n        };\r\n    \r\n        exports.EVEN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return exports.CEILING(number, -2, -1);\r\n        };\r\n    \r\n        exports.EXP = Math.exp;\r\n    \r\n        var MEMOIZED_FACT = [];\r\n        exports.FACT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var n = Math.floor(number);\r\n            if (n === 0 || n === 1) {\r\n                return 1;\r\n            } else if (MEMOIZED_FACT[n] > 0) {\r\n                return MEMOIZED_FACT[n];\r\n            } else {\r\n                MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\r\n                return MEMOIZED_FACT[n];\r\n            }\r\n        };\r\n    \r\n        exports.FACTDOUBLE = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var n = Math.floor(number);\r\n            if (n <= 0) {\r\n                return 1;\r\n            } else {\r\n                return n * exports.FACTDOUBLE(n - 2);\r\n            }\r\n        };\r\n    \r\n        exports.FLOOR = function(number, significance, mode) {\r\n            significance = (significance === undefined) ? 1 : significance;\r\n            mode = (mode === undefined) ? 0 : mode;\r\n    \r\n            number = utils.parseNumber(number);\r\n            significance = utils.parseNumber(significance);\r\n            mode = utils.parseNumber(mode);\r\n            if (utils.anyIsError(number, significance, mode)) {\r\n                return error.value;\r\n            }\r\n            if (significance === 0) {\r\n                return 0;\r\n            }\r\n    \r\n            significance = Math.abs(significance);\r\n            if (number >= 0) {\r\n                return Math.floor(number / significance) * significance;\r\n            } else {\r\n                if (mode === 0) {\r\n                    return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n                } else {\r\n                    return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n                }\r\n            }\r\n        };\r\n    \r\n        exports.FLOOR.MATH = exports.FLOOR;\r\n    \r\n        exports.GCD = null;\r\n    \r\n        exports.INT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.floor(number);\r\n        };\r\n    \r\n        exports.LCM = function() {\r\n            // Credits: Jonas Raoni Soares Silva\r\n            var o = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (o instanceof Error) {\r\n                return o;\r\n            }\r\n            for (var i, j, n, d, r = 1;\r\n                (n = o.pop()) !== undefined;) {\r\n                while (n > 1) {\r\n                    if (n % 2) {\r\n                        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\r\n                          //empty\r\n                        }\r\n                        d = (i <= j) ? i : n;\r\n                    } else {\r\n                        d = 2;\r\n                    }\r\n                    for (n /= d, r *= d, i = o.length; i;\r\n                        (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\r\n                        //empty\r\n                    }\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n    \r\n        exports.LN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number);\r\n        };\r\n    \r\n        exports.LOG = function(number, base) {\r\n            number = utils.parseNumber(number);\r\n            base = (base === undefined) ? 10 : utils.parseNumber(base);\r\n    \r\n            if (utils.anyIsError(number, base)) {\r\n                return error.value;\r\n            }\r\n    \r\n            return Math.log(number) / Math.log(base);\r\n        };\r\n    \r\n        exports.LOG10 = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number) / Math.log(10);\r\n        };\r\n    \r\n        exports.MDETERM = null;\r\n    \r\n        exports.MINVERSE = null;\r\n    \r\n        exports.MMULT = null;\r\n    \r\n        exports.MOD = function(dividend, divisor) {\r\n            dividend = utils.parseNumber(dividend);\r\n            divisor = utils.parseNumber(divisor);\r\n            if (utils.anyIsError(dividend, divisor)) {\r\n                return error.value;\r\n            }\r\n            if (divisor === 0) {\r\n                return error.div0;\r\n            }\r\n            var modulus = Math.abs(dividend % divisor);\r\n            return (divisor > 0) ? modulus : -modulus;\r\n        };\r\n    \r\n        exports.MROUND = function(number, multiple) {\r\n            number = utils.parseNumber(number);\r\n            multiple = utils.parseNumber(multiple);\r\n            if (utils.anyIsError(number, multiple)) {\r\n                return error.value;\r\n            }\r\n            if (number * multiple < 0) {\r\n                return error.num;\r\n            }\r\n    \r\n            return Math.round(number / multiple) * multiple;\r\n        };\r\n    \r\n        exports.MULTINOMIAL = function() {\r\n            var args = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (args instanceof Error) {\r\n                return args;\r\n            }\r\n            var sum = 0;\r\n            var divisor = 1;\r\n            for (var i = 0; i < args.length; i++) {\r\n                sum += args[i];\r\n                divisor *= exports.FACT(args[i]);\r\n            }\r\n            return exports.FACT(sum) / divisor;\r\n        };\r\n    \r\n        exports.MUNIT = null;\r\n    \r\n        exports.ODD = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var temp = Math.ceil(Math.abs(number));\r\n            temp = (temp & 1) ? temp : temp + 1;\r\n            return (number > 0) ? temp : -temp;\r\n        };\r\n    \r\n        exports.PI = function() {\r\n            return Math.PI;\r\n        };\r\n    \r\n        exports.POWER = function(number, power) {\r\n            number = utils.parseNumber(number);\r\n            power = utils.parseNumber(power);\r\n            if (utils.anyIsError(number, power)) {\r\n                return error.value;\r\n            }\r\n            var result = Math.pow(number, power);\r\n            if (isNaN(result)) {\r\n                return error.num;\r\n            }\r\n    \r\n            return result;\r\n        };\r\n    \r\n        exports.PRODUCT = function() {\r\n            var args = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (args instanceof Error) {\r\n                return args;\r\n            }\r\n            var result = 1;\r\n            for (var i = 0; i < args.length; i++) {\r\n                result *= args[i];\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.QUOTIENT = function(numerator, denominator) {\r\n            numerator = utils.parseNumber(numerator);\r\n            denominator = utils.parseNumber(denominator);\r\n            if (utils.anyIsError(numerator, denominator)) {\r\n                return error.value;\r\n            }\r\n            return parseInt(numerator / denominator, 10);\r\n        };\r\n    \r\n        exports.RADIANS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return number * Math.PI / 180;\r\n        };\r\n    \r\n        exports.RAND = function() {\r\n            return Math.random();\r\n        };\r\n    \r\n        exports.RANDBETWEEN = function(bottom, top) {\r\n            bottom = utils.parseNumber(bottom);\r\n            top = utils.parseNumber(top);\r\n            if (utils.anyIsError(bottom, top)) {\r\n                return error.value;\r\n            }\r\n            // Creative Commons Attribution 3.0 License\r\n            // Copyright (c) 2012 eqcode\r\n            return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\r\n        };\r\n    \r\n        exports.ROMAN = null;\r\n    \r\n        exports.ROUND = function(number, digits) {\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\r\n        };\r\n    \r\n        exports.ROUNDDOWN = function(number, digits) {\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            var sign = (number > 0) ? 1 : -1;\r\n            return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n        };\r\n    \r\n        exports.ROUNDUP = function(number, digits) {\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            var sign = (number > 0) ? 1 : -1;\r\n            return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n        };\r\n    \r\n        exports.SEC = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 1 / Math.cos(number);\r\n        };\r\n    \r\n        exports.SECH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 2 / (Math.exp(number) + Math.exp(-number));\r\n        };\r\n    \r\n        exports.SERIESSUM = function(x, n, m, coefficients) {\r\n            x = utils.parseNumber(x);\r\n            n = utils.parseNumber(n);\r\n            m = utils.parseNumber(m);\r\n            coefficients = utils.parseNumberArray(coefficients);\r\n            if (utils.anyIsError(x, n, m, coefficients)) {\r\n                return error.value;\r\n            }\r\n            var result = coefficients[0] * Math.pow(x, n);\r\n            for (var i = 1; i < coefficients.length; i++) {\r\n                result += coefficients[i] * Math.pow(x, n + i * m);\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SIGN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            if (number < 0) {\r\n                return -1;\r\n            } else if (number === 0) {\r\n                return 0;\r\n            } else {\r\n                return 1;\r\n            }\r\n        };\r\n    \r\n        exports.SIN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.sin(number);\r\n        };\r\n    \r\n        exports.SINH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return (Math.exp(number) - Math.exp(-number)) / 2;\r\n        };\r\n    \r\n        exports.SQRT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            if (number < 0) {\r\n                return error.num;\r\n            }\r\n            return Math.sqrt(number);\r\n        };\r\n    \r\n        exports.SQRTPI = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.sqrt(number * Math.PI);\r\n        };\r\n    \r\n        exports.SUBTOTAL = null;\r\n    \r\n        exports.ADD = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            return num1 + num2;\r\n        };\r\n    \r\n        exports.MINUS = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            return num1 - num2;\r\n        };\r\n    \r\n        exports.DIVIDE = function (dividend, divisor) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            dividend = utils.parseNumber(dividend);\r\n            divisor = utils.parseNumber(divisor);\r\n            if (utils.anyIsError(dividend, divisor)) {\r\n                return error.value;\r\n            }\r\n    \r\n            if (divisor === 0) {\r\n                return error.div0;\r\n            }\r\n    \r\n            return dividend / divisor;\r\n        };\r\n    \r\n        exports.MULTIPLY = function (factor1, factor2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            factor1 = utils.parseNumber(factor1);\r\n            factor2 = utils.parseNumber(factor2);\r\n            if (utils.anyIsError(factor1, factor2)) {\r\n                return error.value;\r\n            }\r\n    \r\n            return factor1 * factor2;\r\n        };\r\n    \r\n        exports.GTE = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.error;\r\n            }\r\n    \r\n            return num1 >= num2;\r\n        };\r\n    \r\n        exports.LT = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.error;\r\n            }\r\n    \r\n            return num1 < num2;\r\n        };\r\n    \r\n        exports.LTE = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.error;\r\n            }\r\n    \r\n            return num1 <= num2;\r\n        };\r\n    \r\n        exports.EQ = function (value1, value2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            return value1 === value2;\r\n        };\r\n    \r\n        exports.NE = function (value1, value2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            return value1 !== value2;\r\n        };\r\n    \r\n        exports.POW = function (base, exponent) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n    \r\n            base = utils.parseNumber(base);\r\n            exponent = utils.parseNumber(exponent);\r\n            if (utils.anyIsError(base, exponent)) {\r\n                return error.error;\r\n            }\r\n    \r\n            return exports.POWER(base, exponent);\r\n        };\r\n    \r\n        exports.SUM = function() {\r\n            var result = 0;\r\n            var argsKeys = Object.keys(arguments);\r\n            for (var i = 0; i < argsKeys.length; ++i) {\r\n                var elt = arguments[argsKeys[i]];\r\n                if (typeof elt === 'number') {\r\n                    result += elt;\r\n                } else if (typeof elt === 'string') {\r\n                    var parsed = parseFloat(elt);\r\n                    !isNaN(parsed) && (result += parsed);\r\n                } else if (Array.isArray(elt)) {\r\n                    result += exports.SUM.apply(null, elt);\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SUMIF = function(range, criteria) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            var result = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SUMIFS = function() {\r\n            var args = utils.argsToArray(arguments);\r\n            var range = utils.parseNumberArray(utils.flatten(args.shift()));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            var criteria = args;\r\n    \r\n            var n_range_elements = range.length;\r\n            var n_criterias = criteria.length;\r\n    \r\n            var result = 0;\r\n            for (var i = 0; i < n_range_elements; i++) {\r\n                var el = range[i];\r\n                var condition = '';\r\n                for (var c = 0; c < n_criterias; c++) {\r\n                    condition += el + criteria[c];\r\n                    if (c !== n_criterias - 1) {\r\n                        condition += '&&';\r\n                    }\r\n                }\r\n                if (eval(condition)) { // jshint ignore:line\r\n                    result += el;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SUMPRODUCT = null;\r\n    \r\n        exports.SUMSQ = function() {\r\n            var numbers = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (numbers instanceof Error) {\r\n                return numbers;\r\n            }\r\n            var result = 0;\r\n            var length = numbers.length;\r\n            for (var i = 0; i < length; i++) {\r\n                result += (ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SUMX2MY2 = function(array_x, array_y) {\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            if (utils.anyIsError(array_x, array_y)) {\r\n                return error.value;\r\n            }\r\n            var result = 0;\r\n            for (var i = 0; i < array_x.length; i++) {\r\n                result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SUMX2PY2 = function(array_x, array_y) {\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            if (utils.anyIsError(array_x, array_y)) {\r\n                return error.value;\r\n            }\r\n            var result = 0;\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            for (var i = 0; i < array_x.length; i++) {\r\n                result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.SUMXMY2 = function(array_x, array_y) {\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            if (utils.anyIsError(array_x, array_y)) {\r\n                return error.value;\r\n            }\r\n            var result = 0;\r\n            array_x = utils.flatten(array_x);\r\n            array_y = utils.flatten(array_y);\r\n            for (var i = 0; i < array_x.length; i++) {\r\n                result += Math.pow(array_x[i] - array_y[i], 2);\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.TAN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.tan(number);\r\n        };\r\n    \r\n        exports.TANH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var e2 = Math.exp(2 * number);\r\n            return (e2 - 1) / (e2 + 1);\r\n        };\r\n    \r\n        exports.TRUNC = function(number, digits) {\r\n            digits = (digits === undefined) ? 0 : digits;\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            var sign = (number > 0) ? 1 : -1;\r\n            return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.misc = (function() {\r\n        var exports = {};\r\n    \r\n        exports.UNIQUE = function () {\r\n            var result = [];\r\n            for (var i = 0; i < arguments.length; ++i) {\r\n                var hasElement = false;\r\n                var element = arguments[i];\r\n    \r\n                // Check if we've already seen this element.\r\n                for (var j = 0; j < result.length; ++j) {\r\n                    hasElement = result[j] === element;\r\n                    if (hasElement) { break; }\r\n                }\r\n    \r\n                // If we did not find it, add it to the result.\r\n                if (!hasElement) {\r\n                    result.push(element);\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.FLATTEN = utils.flatten;\r\n    \r\n        exports.ARGS2ARRAY = function () {\r\n            return Array.prototype.slice.call(arguments, 0);\r\n        };\r\n    \r\n        exports.REFERENCE = function (context, reference) {\r\n            try {\r\n                var path = reference.split('.');\r\n                var result = context;\r\n                for (var i = 0; i < path.length; ++i) {\r\n                    var step = path[i];\r\n                    if (step[step.length - 1] === ']') {\r\n                        var opening = step.indexOf('[');\r\n                        var index = step.substring(opening + 1, step.length - 1);\r\n                        result = result[step.substring(0, opening)][index];\r\n                    } else {\r\n                        result = result[step];\r\n                    }\r\n                }\r\n                return result;\r\n            } catch (error) {}\r\n        };\r\n    \r\n        exports.JOIN = function (array, separator) {\r\n            return array.join(separator);\r\n        };\r\n    \r\n        exports.NUMBERS = function () {\r\n            var possibleNumbers = utils.flatten(arguments);\r\n            return possibleNumbers.filter(function (el) {\r\n                return typeof el === 'number';\r\n            });\r\n        };\r\n    \r\n        exports.NUMERAL = null;\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.text = (function() {\r\n        var exports = {};\r\n    \r\n        exports.ASC = null;\r\n    \r\n        exports.BAHTTEXT = null;\r\n    \r\n        exports.CHAR = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return String.fromCharCode(number);\r\n        };\r\n    \r\n        exports.CLEAN = function(text) {\r\n            text = text || '';\r\n            var re = /[\\0-\\x1F]/g;\r\n            return text.replace(re, \"\");\r\n        };\r\n    \r\n        exports.CODE = function(text) {\r\n            text = text || '';\r\n            return text.charCodeAt(0);\r\n        };\r\n    \r\n        exports.CONCATENATE = function() {\r\n            var args = utils.flatten(arguments);\r\n    \r\n            var trueFound = 0;\r\n            while ((trueFound = args.indexOf(true)) > -1) {\r\n                args[trueFound] = 'TRUE';\r\n            }\r\n    \r\n            var falseFound = 0;\r\n            while ((falseFound = args.indexOf(false)) > -1) {\r\n                args[falseFound] = 'FALSE';\r\n            }\r\n    \r\n            return args.join('');\r\n        };\r\n    \r\n        exports.DBCS = null;\r\n    \r\n        exports.DOLLAR = null;\r\n    \r\n        exports.EXACT = function(text1, text2) {\r\n            return text1 === text2;\r\n        };\r\n    \r\n        exports.FIND = function(find_text, within_text, position) {\r\n            position = (position === undefined) ? 0 : position;\r\n            return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\r\n        };\r\n    \r\n        exports.FIXED = null;\r\n    \r\n        exports.HTML2TEXT = function (value) {\r\n            var result = '';\r\n    \r\n            if (value) {\r\n                if (value instanceof Array) {\r\n                    value.forEach(function (line) {\r\n                        if (result !== '') {\r\n                          result += '\\n';\r\n                        }\r\n                        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\r\n                    });\r\n                } else {\r\n                    result = value.replace(/<(?:.|\\n)*?>/gm, '');\r\n                }\r\n            }\r\n    \r\n            return result;\r\n        };\r\n    \r\n        exports.LEFT = function(text, number) {\r\n            number = (number === undefined) ? 1 : number;\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error || typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text ? text.substring(0, number) : null;\r\n        };\r\n    \r\n        exports.LEN = function(text) {\r\n            if (arguments.length === 0) {\r\n                return error.error;\r\n            }\r\n    \r\n            if (typeof text === 'string') {\r\n                return text ? text.length : 0;\r\n            }\r\n    \r\n            if (text.length) {\r\n                return text.length;\r\n            }\r\n    \r\n            return error.value;\r\n        };\r\n    \r\n        exports.LOWER = function(text) {\r\n            if (typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text ? text.toLowerCase() : text;\r\n        };\r\n    \r\n        exports.MID = function(text, start, number) {\r\n            start = utils.parseNumber(start);\r\n            number = utils.parseNumber(number);\r\n            if (utils.anyIsError(start, number) || typeof text !== 'string') {\r\n                return number;\r\n            }\r\n    \r\n            var begin = start - 1;\r\n            var end = begin + number;\r\n    \r\n            return text.substring(begin, end);\r\n        };\r\n    \r\n        exports.NUMBERVALUE = null;\r\n    \r\n        exports.PRONETIC = null;\r\n    \r\n        exports.PROPER = function(text) {\r\n            if (text === undefined || text.length === 0) {\r\n                return error.value;\r\n            }\r\n            if (text === true) {\r\n                text = 'TRUE';\r\n            }\r\n            if (text === false) {\r\n                text = 'FALSE';\r\n            }\r\n            if (isNaN(text) && typeof text === 'number') {\r\n                return error.value;\r\n            }\r\n            if (typeof text === 'number') {\r\n                text = '' + text;\r\n            }\r\n    \r\n            return text.replace(/\\w\\S*/g, function(txt) {\r\n                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n            });\r\n        };\r\n    \r\n        exports.REGEXEXTRACT = function (text, regular_expression) {\r\n            var match = text.match(new RegExp(regular_expression));\r\n            return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\r\n        };\r\n    \r\n        exports.REGEXMATCH = function (text, regular_expression, full) {\r\n            var match = text.match(new RegExp(regular_expression));\r\n            return full ? match : !!match;\r\n        };\r\n    \r\n        exports.REGEXREPLACE = function (text, regular_expression, replacement) {\r\n            return text.replace(new RegExp(regular_expression), replacement);\r\n        };\r\n    \r\n        exports.REPLACE = function(text, position, length, new_text) {\r\n            position = utils.parseNumber(position);\r\n            length = utils.parseNumber(length);\r\n            if (utils.anyIsError(position, length) ||\r\n                typeof text !== 'string' ||\r\n                typeof new_text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\r\n        };\r\n    \r\n        exports.REPT = function(text, number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return new Array(number + 1).join(text);\r\n        };\r\n    \r\n        exports.RIGHT = function(text, number) {\r\n            number = (number === undefined) ? 1 : number;\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return text ? text.substring(text.length - number) : null;\r\n        };\r\n    \r\n        exports.SEARCH = function(find_text, within_text, position) {\r\n            var foundAt;\r\n            if (typeof find_text !== 'string' || typeof within_text !== 'string') {\r\n                return error.value;\r\n            }\r\n            position = (position === undefined) ? 0 : position;\r\n            foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\r\n            return (foundAt === 0)?error.value:foundAt;\r\n        };\r\n    \r\n        exports.SPLIT = function (text, separator) {\r\n            return text.split(separator);\r\n        };\r\n    \r\n        exports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\r\n            if (!text || !old_text || !new_text) {\r\n                return text;\r\n            } else if (occurrence === undefined) {\r\n                return text.replace(new RegExp(old_text, 'g'), new_text);\r\n            } else {\r\n                var index = 0;\r\n                var i = 0;\r\n                while (text.indexOf(old_text, index) > 0) {\r\n                    index = text.indexOf(old_text, index + 1);\r\n                    i++;\r\n                    if (i === occurrence) {\r\n                        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    \r\n        exports.T = function(value) {\r\n            return (typeof value === \"string\") ? value : '';\r\n        };\r\n    \r\n        exports.TEXT = null;\r\n    \r\n        exports.TRIM = function(text) {\r\n            if (typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text.replace(/ +/g, ' ').trim();\r\n        };\r\n    \r\n        exports.UNICHAR = exports.CHAR;\r\n    \r\n        exports.UNICODE = exports.CODE;\r\n    \r\n        exports.UPPER = function(text) {\r\n            if (typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text.toUpperCase();\r\n        };\r\n    \r\n        exports.VALUE = null;\r\n    \r\n        return exports;\r\n    })();\r\n    \r\n    jexcel.methods.stats = (function() {\r\n        var exports = {};\r\n    \r\n        var SQRT2PI = 2.5066282746310002;\r\n    \r\n        exports.AVEDEV = null;\r\n    \r\n        exports.AVERAGE = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            var n = range.length;\r\n            var sum = 0;\r\n            var count = 0;\r\n            for (var i = 0; i < n; i++) {\r\n                sum += range[i];\r\n                count += 1;\r\n            }\r\n            return sum / count;\r\n        };\r\n    \r\n        exports.AVERAGEA = function() {\r\n            var range = utils.flatten(arguments);\r\n            var n = range.length;\r\n            var sum = 0;\r\n            var count = 0;\r\n            for (var i = 0; i < n; i++) {\r\n                var el = range[i];\r\n                if (typeof el === 'number') {\r\n                    sum += el;\r\n                }\r\n                if (el === true) {\r\n                    sum++;\r\n                }\r\n                if (el !== null) {\r\n                    count++;\r\n                }\r\n            }\r\n            return sum / count;\r\n        };\r\n    \r\n        exports.AVERAGEIF = function(range, criteria, average_range) {\r\n            average_range = average_range || range;\r\n            range = utils.flatten(range);\r\n            average_range = utils.parseNumberArray(utils.flatten(average_range));\r\n            if (average_range instanceof Error) {\r\n                return average_range;\r\n            }\r\n            var average_count = 0;\r\n            var result = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                    result += average_range[i];\r\n                    average_count++;\r\n                }\r\n            }\r\n            return result / average_count;\r\n        };\r\n    \r\n        exports.AVERAGEIFS = null;\r\n    \r\n        exports.COUNT = function() {\r\n            return utils.numbers(utils.flatten(arguments)).length;\r\n        };\r\n    \r\n        exports.COUNTA = function() {\r\n            var range = utils.flatten(arguments);\r\n            return range.length - exports.COUNTBLANK(range);\r\n        };\r\n    \r\n        exports.COUNTIN = function (range, value) {\r\n            var result = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                if (range[i] === value) {\r\n                    result++;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.COUNTBLANK = function() {\r\n            var range = utils.flatten(arguments);\r\n            var blanks = 0;\r\n            var element;\r\n            for (var i = 0; i < range.length; i++) {\r\n                element = range[i];\r\n                if (element === null || element === '') {\r\n                    blanks++;\r\n                }\r\n            }\r\n            return blanks;\r\n        };\r\n    \r\n        exports.COUNTIF = function(range, criteria) {\r\n            range = utils.flatten(range);\r\n            if (!/[<>=!]/.test(criteria)) {\r\n                criteria = '==\"' + criteria + '\"';\r\n            }\r\n            var matches = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                if (typeof range[i] !== 'string') {\r\n                    if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                        matches++;\r\n                    }\r\n                } else {\r\n                    if (eval('\"' + range[i] + '\"' + criteria)) { // jshint ignore:line\r\n                        matches++;\r\n                    }\r\n                }\r\n            }\r\n            return matches;\r\n        };\r\n    \r\n        exports.COUNTIFS = function() {\r\n            var args = utils.argsToArray(arguments);\r\n            var results = new Array(utils.flatten(args[0]).length);\r\n            for (var i = 0; i < results.length; i++) {\r\n                results[i] = true;\r\n            }\r\n            for (i = 0; i < args.length; i += 2) {\r\n                var range = utils.flatten(args[i]);\r\n                var criteria = args[i + 1];\r\n                if (!/[<>=!]/.test(criteria)) {\r\n                    criteria = '==\"' + criteria + '\"';\r\n                }\r\n                for (var j = 0; j < range.length; j++) {\r\n                    if (typeof range[j] !== 'string') {\r\n                        results[j] = results[j] && eval(range[j] + criteria); // jshint ignore:line\r\n                    } else {\r\n                        results[j] = results[j] && eval('\"' + range[j] + '\"' + criteria); // jshint ignore:line\r\n                    }\r\n                }\r\n            }\r\n            var result = 0;\r\n            for (i = 0; i < results.length; i++) {\r\n                if (results[i]) {\r\n                    result++;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.COUNTUNIQUE = function () {\r\n            return UNIQUE.apply(null, utils.flatten(arguments)).length;\r\n        };\r\n    \r\n        exports.FISHER = function(x) {\r\n            x = utils.parseNumber(x);\r\n            if (x instanceof Error) {\r\n                return x;\r\n            }\r\n            return Math.log((1 + x) / (1 - x)) / 2;\r\n        };\r\n    \r\n        exports.FISHERINV = function(y) {\r\n            y = utils.parseNumber(y);\r\n            if (y instanceof Error) {\r\n                return y;\r\n            }\r\n            var e2y = Math.exp(2 * y);\r\n            return (e2y - 1) / (e2y + 1);\r\n        };\r\n    \r\n        exports.FREQUENCY = function(data, bins) {\r\n            data = utils.parseNumberArray(utils.flatten(data));\r\n            bins = utils.parseNumberArray(utils.flatten(bins));\r\n            if (utils.anyIsError(data, bins)) {\r\n                return error.value;\r\n            }\r\n            var n = data.length;\r\n            var b = bins.length;\r\n            var r = [];\r\n            for (var i = 0; i <= b; i++) {\r\n                r[i] = 0;\r\n                for (var j = 0; j < n; j++) {\r\n                    if (i === 0) {\r\n                        if (data[j] <= bins[0]) {\r\n                            r[0] += 1;\r\n                        }\r\n                    } else if (i < b) {\r\n                        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\r\n                            r[i] += 1;\r\n                        }\r\n                    } else if (i === b) {\r\n                        if (data[j] > bins[b - 1]) {\r\n                            r[b] += 1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n    \r\n        exports.LARGE = function(range, k) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(range, k)) {\r\n                return range;\r\n            }\r\n            return range.sort(function(a, b) {\r\n                return b - a;\r\n            })[k - 1];\r\n        };\r\n    \r\n        exports.MAX = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n        };\r\n    \r\n        exports.MAXA = function() {\r\n            var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n        };\r\n    \r\n        exports.MIN = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n        };\r\n    \r\n        exports.MINA = function() {\r\n            var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n        };\r\n    \r\n        exports.MODE = {};\r\n    \r\n        exports.MODE.MULT = function() {\r\n            // Credits: Ronan\r\n            var range = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            var n = range.length;\r\n            var count = {};\r\n            var maxItems = [];\r\n            var max = 0;\r\n            var currentItem;\r\n    \r\n            for (var i = 0; i < n; i++) {\r\n                currentItem = range[i];\r\n                count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\r\n                if (count[currentItem] > max) {\r\n                    max = count[currentItem];\r\n                    maxItems = [];\r\n                }\r\n                if (count[currentItem] === max) {\r\n                    maxItems[maxItems.length] = currentItem;\r\n                }\r\n            }\r\n            return maxItems;\r\n        };\r\n    \r\n        exports.MODE.SNGL = function() {\r\n            var range = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            return exports.MODE.MULT(range).sort(function(a, b) {\r\n                return a - b;\r\n            })[0];\r\n        };\r\n    \r\n        exports.PERCENTILE = {};\r\n    \r\n        exports.PERCENTILE.EXC = function(array, k) {\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(array, k)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                {\r\n                    return a - b;\r\n                }\r\n            });\r\n            var n = array.length;\r\n            if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\r\n                return error.num;\r\n            }\r\n            var l = k * (n + 1) - 1;\r\n            var fl = Math.floor(l);\r\n            return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n        };\r\n    \r\n        exports.PERCENTILE.INC = function(array, k) {\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(array, k)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var n = array.length;\r\n            var l = k * (n - 1);\r\n            var fl = Math.floor(l);\r\n            return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n        };\r\n    \r\n        exports.PERCENTRANK = {};\r\n    \r\n        exports.PERCENTRANK.EXC = function(array, x, significance) {\r\n            significance = (significance === undefined) ? 3 : significance;\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            x = utils.parseNumber(x);\r\n            significance = utils.parseNumber(significance);\r\n            if (utils.anyIsError(array, x, significance)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var uniques = UNIQUE.apply(null, array);\r\n            var n = array.length;\r\n            var m = uniques.length;\r\n            var power = Math.pow(10, significance);\r\n            var result = 0;\r\n            var match = false;\r\n            var i = 0;\r\n            while (!match && i < m) {\r\n                if (x === uniques[i]) {\r\n                    result = (array.indexOf(uniques[i]) + 1) / (n + 1);\r\n                    match = true;\r\n                } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                    result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\r\n                    match = true;\r\n                }\r\n                i++;\r\n            }\r\n            return Math.floor(result * power) / power;\r\n        };\r\n    \r\n        exports.PERCENTRANK.INC = function(array, x, significance) {\r\n            significance = (significance === undefined) ? 3 : significance;\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            x = utils.parseNumber(x);\r\n            significance = utils.parseNumber(significance);\r\n            if (utils.anyIsError(array, x, significance)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var uniques = UNIQUE.apply(null, array);\r\n            var n = array.length;\r\n            var m = uniques.length;\r\n            var power = Math.pow(10, significance);\r\n            var result = 0;\r\n            var match = false;\r\n            var i = 0;\r\n            while (!match && i < m) {\r\n                if (x === uniques[i]) {\r\n                    result = array.indexOf(uniques[i]) / (n - 1);\r\n                    match = true;\r\n                } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                    result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\r\n                    match = true;\r\n                }\r\n                i++;\r\n            }\r\n            return Math.floor(result * power) / power;\r\n        };\r\n    \r\n        exports.PERMUT = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return FACT(number) / FACT(number - number_chosen);\r\n        };\r\n    \r\n        exports.PERMUTATIONA = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return Math.pow(number, number_chosen);\r\n        };\r\n    \r\n        exports.PHI = function(x) {\r\n            x = utils.parseNumber(x);\r\n            if (x instanceof Error) {\r\n                return error.value;\r\n            }\r\n            return Math.exp(-0.5 * x * x) / SQRT2PI;\r\n        };\r\n    \r\n        exports.PROB = function(range, probability, lower, upper) {\r\n            if (lower === undefined) {\r\n                return 0;\r\n            }\r\n            upper = (upper === undefined) ? lower : upper;\r\n    \r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            probability = utils.parseNumberArray(utils.flatten(probability));\r\n            lower = utils.parseNumber(lower);\r\n            upper = utils.parseNumber(upper);\r\n            if (utils.anyIsError(range, probability, lower, upper)) {\r\n                return error.value;\r\n            }\r\n    \r\n            if (lower === upper) {\r\n                return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\r\n            }\r\n    \r\n            var sorted = range.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var n = sorted.length;\r\n            var result = 0;\r\n            for (var i = 0; i < n; i++) {\r\n                if (sorted[i] >= lower && sorted[i] <= upper) {\r\n                    result += probability[range.indexOf(sorted[i])];\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n    \r\n        exports.QUARTILE = {};\r\n    \r\n        exports.QUARTILE.EXC = function(range, quart) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            quart = utils.parseNumber(quart);\r\n            if (utils.anyIsError(range, quart)) {\r\n                return error.value;\r\n            }\r\n            switch (quart) {\r\n                case 1:\r\n                    return exports.PERCENTILE.EXC(range, 0.25);\r\n                case 2:\r\n                    return exports.PERCENTILE.EXC(range, 0.5);\r\n                case 3:\r\n                    return exports.PERCENTILE.EXC(range, 0.75);\r\n                default:\r\n                    return error.num;\r\n            }\r\n        };\r\n    \r\n        exports.QUARTILE.INC = function(range, quart) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            quart = utils.parseNumber(quart);\r\n            if (utils.anyIsError(range, quart)) {\r\n                return error.value;\r\n            }\r\n            switch (quart) {\r\n                case 1:\r\n                    return exports.PERCENTILE.INC(range, 0.25);\r\n                case 2:\r\n                    return exports.PERCENTILE.INC(range, 0.5);\r\n                case 3:\r\n                    return exports.PERCENTILE.INC(range, 0.75);\r\n                default:\r\n                    return error.num;\r\n            }\r\n        };\r\n    \r\n        exports.RANK = {};\r\n    \r\n        exports.RANK.AVG = function(number, range, order) {\r\n            number = utils.parseNumber(number);\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            if (utils.anyIsError(number, range)) {\r\n                return error.value;\r\n            }\r\n            range = utils.flatten(range);\r\n            order = order || false;\r\n            var sort = (order) ? function(a, b) {\r\n                return a - b;\r\n            } : function(a, b) {\r\n                return b - a;\r\n            };\r\n            range = range.sort(sort);\r\n    \r\n            var length = range.length;\r\n            var count = 0;\r\n            for (var i = 0; i < length; i++) {\r\n                if (range[i] === number) {\r\n                    count++;\r\n                }\r\n            }\r\n    \r\n            return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\r\n        };\r\n    \r\n        exports.RANK.EQ = function(number, range, order) {\r\n            number = utils.parseNumber(number);\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            if (utils.anyIsError(number, range)) {\r\n                return error.value;\r\n            }\r\n            order = order || false;\r\n            var sort = (order) ? function(a, b) {\r\n                return a - b;\r\n            } : function(a, b) {\r\n                return b - a;\r\n            };\r\n            range = range.sort(sort);\r\n            return range.indexOf(number) + 1;\r\n        };\r\n    \r\n        exports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\r\n            data_x = utils.parseNumberArray(utils.flatten(data_x));\r\n            data_y = utils.parseNumberArray(utils.flatten(data_y));\r\n            if (utils.anyIsError(data_x, data_y)) {\r\n                return error.value;\r\n            }\r\n            return Math.pow(exports.PEARSON(data_x, data_y), 2);\r\n        };\r\n    \r\n        exports.SMALL = function(range, k) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(range, k)) {\r\n                return range;\r\n            }\r\n            return range.sort(function(a, b) {\r\n                return a - b;\r\n            })[k - 1];\r\n        };\r\n    \r\n        exports.STANDARDIZE = function(x, mean, sd) {\r\n            x = utils.parseNumber(x);\r\n            mean = utils.parseNumber(mean);\r\n            sd = utils.parseNumber(sd);\r\n            if (utils.anyIsError(x, mean, sd)) {\r\n                return error.value;\r\n            }\r\n            return (x - mean) / sd;\r\n        };\r\n    \r\n        exports.STDEV = {};\r\n    \r\n        exports.STDEV.P = function() {\r\n            var v = exports.VAR.P.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n    \r\n        exports.STDEV.S = function() {\r\n            var v = exports.VAR.S.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n    \r\n        exports.STDEVA = function() {\r\n            var v = exports.VARA.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n    \r\n        exports.STDEVPA = function() {\r\n            var v = exports.VARPA.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n    \r\n        exports.VAR = {};\r\n    \r\n        exports.VAR.P = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var mean = exports.AVERAGE(range);\r\n            for (var i = 0; i < n; i++) {\r\n                sigma += Math.pow(range[i] - mean, 2);\r\n            }\r\n            return sigma / n;\r\n        };\r\n    \r\n        exports.VAR.S = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var mean = exports.AVERAGE(range);\r\n            for (var i = 0; i < n; i++) {\r\n                sigma += Math.pow(range[i] - mean, 2);\r\n            }\r\n            return sigma / (n - 1);\r\n        };\r\n    \r\n        exports.VARA = function() {\r\n            var range = utils.flatten(arguments);\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var count = 0;\r\n            var mean = exports.AVERAGEA(range);\r\n            for (var i = 0; i < n; i++) {\r\n                var el = range[i];\r\n                if (typeof el === 'number') {\r\n                    sigma += Math.pow(el - mean, 2);\r\n                } else if (el === true) {\r\n                    sigma += Math.pow(1 - mean, 2);\r\n                } else {\r\n                    sigma += Math.pow(0 - mean, 2);\r\n                }\r\n    \r\n                if (el !== null) {\r\n                    count++;\r\n                }\r\n            }\r\n            return sigma / (count - 1);\r\n        };\r\n    \r\n        exports.VARPA = function() {\r\n            var range = utils.flatten(arguments);\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var count = 0;\r\n            var mean = exports.AVERAGEA(range);\r\n            for (var i = 0; i < n; i++) {\r\n                var el = range[i];\r\n                if (typeof el === 'number') {\r\n                    sigma += Math.pow(el - mean, 2);\r\n                } else if (el === true) {\r\n                    sigma += Math.pow(1 - mean, 2);\r\n                } else {\r\n                    sigma += Math.pow(0 - mean, 2);\r\n                }\r\n    \r\n                if (el !== null) {\r\n                    count++;\r\n                }\r\n            }\r\n            return sigma / count;\r\n        };\r\n    \r\n        exports.WEIBULL = {};\r\n    \r\n        exports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\r\n            x = utils.parseNumber(x);\r\n            alpha = utils.parseNumber(alpha);\r\n            beta = utils.parseNumber(beta);\r\n            if (utils.anyIsError(x, alpha, beta)) {\r\n                return error.value;\r\n            }\r\n            return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\r\n        };\r\n    \r\n        exports.Z = {};\r\n    \r\n        exports.Z.TEST = function(range, x, sd) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            x = utils.parseNumber(x);\r\n            if (utils.anyIsError(range, x)) {\r\n                return error.value;\r\n            }\r\n    \r\n            sd = sd || exports.STDEV.S(range);\r\n            var n = range.length;\r\n            return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\r\n        };\r\n    \r\n        return exports;\r\n    })();\r\n\r\n    jexcel.methods.utils = (function() {\r\n        var exports = {};\r\n\r\n        exports.PROGRESS = function(p, c) {\r\n            var color = c ? c : 'red';\r\n            var value = p ? p : '0';\r\n\r\n            return '<div style=\"width:' + value + '%;height:4px;background-color:' + color + ';margin-top:1px;\"></div>';\r\n        };\r\n\r\n        exports.RATING = function(v) {\r\n            var html = '<div class=\"jrating\">';\r\n            for (var i = 0; i < 5; i++) {\r\n                if (i < v) {\r\n                    html += '<div class=\"jrating-selected\"></div>';\r\n                } else {\r\n                    html += '<div></div>';\r\n                }\r\n            }\r\n            html += '</div>';\r\n            return html;\r\n        }\r\n\r\n        return exports;\r\n    })();\r\n\r\n    for (var i = 0; i < Object.keys(jexcel.methods).length; i++) {\r\n        var methods = jexcel.methods[Object.keys(jexcel.methods)[i]];\r\n        for (var j = 0; j < Object.keys(methods).length; j++) {\r\n            if (typeof(methods[Object.keys(methods)[j]]) == 'function') {\r\n                window[Object.keys(methods)[j]] = methods[Object.keys(methods)[j]];\r\n            } else {\r\n                window[Object.keys(methods)[j]] = function() {\r\n                    return Object.keys(methods)[j] + 'Not implemented';\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return jexcel;\r\n})));","var classof = require('./classof-raw');\nvar regexpExec = require('./regexp-exec');\n\n// `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n\n  if (classof(R) !== 'RegExp') {\n    throw TypeError('RegExp#exec called on incompatible receiver');\n  }\n\n  return regexpExec.call(R, S);\n};\n\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hoja\"},[_c('Navbar'),_c('div',{staticClass:\"container-fluid\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"column\"}),_c('div',{staticClass:\"col-sm-12 col-md-8\"},[_c('h1',{staticClass:\"tituloHoja\"},[_vm._v(_vm._s(_vm.hoja.titulo))]),_c('br'),_vm._v(\" \"),_c('br'),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"column\"},[_c('button',{staticClass:\"hvr-grow-shadow btn success block\",on:{\"click\":_vm.actualizar}},[_vm._v(\"Guardar cambios\")])]),_c('div',{staticClass:\"column\"},[_c('button',{staticClass:\"hvr-grow-shadow btn danger block\",on:{\"click\":_vm.eliminar}},[_vm._v(\"Eliminar\")])])]),_c('br'),_c('div',{staticClass:\"row fj-center\"},[_c('div',{staticClass:\"col-4 col-md-3\"},[_c('button',{staticClass:\"hvr-grow-shadow btn info block rounded\",on:{\"click\":_vm.mas}},[_vm._v(\"+\")])]),_c('div',{staticClass:\"col-4 col-md-3\"},[_c('button',{staticClass:\"hvr-grow-shadow btn primary block rounded\",on:{\"click\":_vm.menos}},[_vm._v(\"-\")])])]),_c('br'),_vm._v(\" \"),_c('br'),_c('div',{attrs:{\"id\":\"spreadsheet\"}})]),_c('div',{staticClass:\"column\"})])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"hoja\">\r\n\r\n\r\n    <Navbar />\r\n\r\n    <div class=\"container-fluid\">\r\n\r\n      <div class=\"row\">\r\n\r\n        <div class=\"column\"></div>\r\n\r\n        <div class=\"col-sm-12 col-md-8\">\r\n\r\n\r\n          <h1 class=\"tituloHoja\">{{hoja.titulo}}</h1> \r\n\r\n          <br> <br>\r\n\r\n          <div class=\"row\">\r\n\r\n\r\n            <div class=\"column\">\r\n\r\n              <button v-on:click=\"actualizar\" class=\"hvr-grow-shadow btn success block\">Guardar cambios</button>\r\n\r\n            </div>\r\n\r\n\r\n            <div class=\"column\">\r\n\r\n              <button v-on:click=\"eliminar\" class=\"hvr-grow-shadow btn danger block\">Eliminar</button>\r\n\r\n            </div>\r\n            \r\n          </div>\r\n\r\n\r\n          <br>\r\n\r\n\r\n          <div class=\"row fj-center\">\r\n\r\n            <div class=\"col-4 col-md-3\">\r\n\r\n              <button v-on:click=\"mas\" class=\"hvr-grow-shadow btn info block rounded\">+</button>\r\n              \r\n            </div>\r\n\r\n            <div class=\"col-4 col-md-3\">\r\n\r\n              <button v-on:click=\"menos\" class=\"hvr-grow-shadow btn primary block rounded\">-</button>\r\n              \r\n            </div>\r\n            \r\n          </div>\r\n\r\n          <br> <br>\r\n\r\n          <div id=\"spreadsheet\"></div>\r\n          \r\n\r\n        </div>\r\n\r\n        <div class=\"column\"></div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport Navbar from '@/components/Navbar.vue'\r\nimport jexcel from 'jexcel';\r\n\r\nexport default {\r\n  name: 'Hoja',\r\n\r\n  data(){\r\n\r\n    return{\r\n\r\n      columnsExcel: null,\r\n\r\n      hoja: {},\r\n\r\n      id: null,\r\n\r\n      filas: [\r\n\r\n          [],\r\n\r\n      ],\r\n\r\n    }\r\n  },\r\n\r\n  components: {\r\n    Navbar,\r\n  },\r\n\r\n  mounted: function () {\r\n\r\n      this.id = this.$route.params.id;\r\n\r\n\r\n\r\n      let id = this.id;\r\n\r\n      fetch('https://excel-back.herokuapp.com/polls/getHoja/',{\r\n        method: 'POST',\r\n        headers: new Headers({}),\r\n        body: JSON.stringify({id: id}),\r\n      })\r\n      .then(response => response.json())\r\n      .then((data) => {\r\n\r\n        this.hoja = data.Hoja[0].fields;\r\n\r\n\r\n\r\n\r\n        let columnas = this.hoja.columnas;\r\n\r\n        let columnasParse = JSON.parse(columnas.replace(/'/g, '\"'))\r\n\r\n        let i;\r\n\r\n        let columnsExcel = [];\r\n\r\n        for (i = 0; i < columnasParse.length; i++) {\r\n\r\n          let tipo = columnasParse[i].tipo;\r\n\r\n          let titulo = columnasParse[i].nombre;\r\n\r\n          if(tipo==\"numeric\"){\r\n\r\n            columnsExcel.push({type: tipo, title: titulo, width: 90, mask:\"$ #.##,00\", decimal:\",\"});\r\n\r\n          }else if(tipo==\"color\"){\r\n\r\n            columnsExcel.push({type: tipo, title: titulo, width: 90, render:'square'});\r\n\r\n          }else{\r\n\r\n            columnsExcel.push({type: tipo, title: titulo, width: 90});\r\n\r\n          }\r\n\r\n        }\r\n\r\n        this.columnsExcel = columnsExcel;\r\n\r\n\r\n\r\n\r\n\r\n\r\n        if(this.hoja.celdas==\"[]\"){\r\n\r\n          this.filas[0] = this.filaNula()\r\n\r\n        }else{\r\n\r\n          let celdas = this.hoja.celdas;\r\n\r\n          this.filas = JSON.parse(celdas.replace(/'/g, '\"').replace(/T/g, 't').replace(/F/g, 'f'))\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n        this.excel();\r\n\r\n      })\r\n\r\n\r\n  },\r\n\r\n  methods: {\r\n\r\n    eliminar(){\r\n\r\n      let id = this.id;\r\n\r\n      fetch('https://excel-back.herokuapp.com/polls/borrar/',{\r\n        method: 'POST',\r\n        headers: new Headers({}),\r\n        body: JSON.stringify({id: id}),\r\n      })\r\n      .then(response => response.text())\r\n      .then((data) => {\r\n\r\n\r\n        this.$router.push({ path: `/verHojas/` })\r\n\r\n\r\n      });\r\n\r\n    },\r\n\r\n    actualizar(){\r\n\r\n\r\n      let id = this.id;\r\n\r\n      let filas = this.filas;\r\n\r\n      fetch('https://excel-back.herokuapp.com/polls/actualizar/',{\r\n        method: 'POST',\r\n        headers: new Headers({}),\r\n        body: JSON.stringify({id: id, filas: filas}),\r\n      })\r\n      .then(response => response.text())\r\n      .then((data) => {\r\n\r\n\r\n      });\r\n\r\n\r\n\r\n\r\n    },\r\n\r\n    filaNula(){\r\n\r\n      let filaNula = [];\r\n\r\n      let i;\r\n\r\n      for (i = 0; i < this.columnsExcel.length; i++) {\r\n\r\n          let nulo;\r\n\r\n          switch (this.columnsExcel[i].type) {\r\n              case 'color':\r\n                  nulo = '#eb34ae'\r\n                  break;\r\n              case 'text':\r\n                  nulo = ''\r\n                  break;\r\n              case 'calendar':\r\n                  nulo = '2020-02-12'\r\n                  break;\r\n              case 'checkbox':\r\n                  nulo = true\r\n                  break;\r\n              case 'numeric':\r\n                  nulo = '$ 1.000,00'\r\n                  break;\r\n          }\r\n\r\n          filaNula.push(nulo)\r\n\r\n      }\r\n\r\n\r\n      return filaNula;\r\n\r\n\r\n    },\r\n\r\n    excel(){\r\n\r\n      document.getElementById('spreadsheet').innerHTML = \"\";\r\n\r\n      jexcel(document.getElementById('spreadsheet'), {\r\n          data: this.filas,\r\n          columns: this.columnsExcel,\r\n      });\r\n\r\n    },\r\n\r\n    mas(){\r\n\r\n      this.filas.push(this.filaNula());\r\n\r\n      this.excel();\r\n\r\n    },\r\n\r\n    menos(){\r\n\r\n      this.filas.pop();\r\n\r\n      this.excel();\r\n\r\n    },\r\n\r\n  },\r\n\r\n}\r\n\r\n\r\n</script>\r\n\r\n\r\n\r\n<style>\r\n\r\n  .hoja{\r\n    position: relative;\r\n  }\r\n\r\n  .tituloHoja{\r\n    color: white;\r\n    margin-top: 10px;\r\n  }\r\n\r\n  .hvr-grow-shadow {\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    -webkit-transform: perspective(1px) translateZ(0);\r\n    transform: perspective(1px) translateZ(0);\r\n    box-shadow: 0 0 1px rgba(0, 0, 0, 0);\r\n    -webkit-transition-duration: 0.3s;\r\n    transition-duration: 0.3s;\r\n    -webkit-transition-property: box-shadow, transform;\r\n    transition-property: box-shadow, transform;\r\n  }\r\n  .hvr-grow-shadow:hover, .hvr-grow-shadow:focus, .hvr-grow-shadow:active {\r\n    box-shadow: 0 10px 10px -10px rgba(0, 0, 0, 0.5);\r\n    -webkit-transform: scale(1.1);\r\n    transform: scale(1.1);\r\n  }\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Hoja.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Hoja.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Hoja.vue?vue&type=template&id=0970b5e6&\"\nimport script from \"./Hoja.vue?vue&type=script&lang=js&\"\nexport * from \"./Hoja.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Hoja.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', 2, function (REPLACE, nativeReplace, maybeCallNative, reason) {\n  var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = reason.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE;\n  var REPLACE_KEEPS_$0 = reason.REPLACE_KEEPS_$0;\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return replacer !== undefined\n        ? replacer.call(searchValue, O, replaceValue)\n        : nativeReplace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      if (\n        (!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE && REPLACE_KEEPS_$0) ||\n        (typeof replaceValue === 'string' && replaceValue.indexOf(UNSAFE_SUBSTITUTE) === -1)\n      ) {\n        var res = maybeCallNative(nativeReplace, regexp, this, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        results.push(result);\n        if (!global) break;\n\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n  // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return nativeReplace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Hoja.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Hoja.vue?vue&type=style&index=0&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=style&index=0&lang=css&\"","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","\r\n/**\r\n * (c) jSuites Javascript Web Components (v2.8)\r\n *\r\n * Author: Paul Hodel <paul.hodel@gmail.com>\r\n * Website: https://bossanova.uk/jsuites/\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\n    var obj = {}\n\n    obj.init = function() {\n        // Find root element\n        var app = document.querySelector('.japp');\n\n        // Root element\n        if (app) {\n            obj.el = app;\n        } else {\n            obj.el = document.body;\n        }\n\n        // Loading modules\n        var modules = document.querySelectorAll('[data-autoload]');\n        for (var i = 0; i < modules.length; i++) {\n            var m = modules[i].getAttribute('data-autoload');\n            if (typeof(window[m]) == 'function') {\n                window[m](modules[i]);\n            }\n        }\n    }\n\n    obj.guid = function() {\n        var guid = '';\n        for (var i = 0; i < 32; i++) {\n            guid += Math.floor(Math.random()*0xF).toString(0xF);\n        }\n        return guid;\n    }\n\n    obj.getWindowWidth = function() {\n        var w = window,\n        d = document,\n        e = d.documentElement,\n        g = d.getElementsByTagName('body')[0],\n        x = w.innerWidth || e.clientWidth || g.clientWidth;\n        return x;\n    }\n\n    obj.getWindowHeight = function() {\n        var w = window,\n        d = document,\n        e = d.documentElement,\n        g = d.getElementsByTagName('body')[0],\n        y = w.innerHeight|| e.clientHeight|| g.clientHeight;\n        return  y;\n    }\n\n    obj.getPosition = function(e) {\n        if (e.changedTouches && e.changedTouches[0]) {\n            var x = e.changedTouches[0].pageX;\n            var y = e.changedTouches[0].pageY;\n        } else {\n            var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\n            var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\n        }\n\n        return [ x, y ];\n    }\n\n    obj.click = function(el) {\n        if (el.click) {\n            el.click();\n        } else {\n            var evt = new MouseEvent('click', {\n                bubbles: true,\n                cancelable: true,\n                view: window\n            });\n            el.dispatchEvent(evt);\n        }\n    }\n\n    obj.getElement = function(element, className) {\n        var foundElement = false;\n\n        function path (element) {\n            if (element.className) {\n                if (element.classList.contains(className)) {\n                    foundElement = element;\n                }\n            }\n\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n\n        path(element);\n\n        return foundElement;\n    }\n\n    obj.getLinkElement = function(element) {\n        var targetElement = false;\n\n        function path (element) {\n            if ((element.tagName == 'A' || element.tagName == 'DIV') && element.getAttribute('data-href')) {\n                targetElement = element;\n            }\n\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n\n        path(element);\n\n        return targetElement;\n    }\n\n    obj.getFormElements = function(formObject) {\n        var ret = {};\n\n        if (formObject) {\n            var elements = formObject.querySelectorAll(\"input, select, textarea\");\n        } else {\n            var elements = document.querySelectorAll(\"input, select, textarea\");\n        }\n\n        for (var i = 0; i < elements.length; i++) {\n            var element = elements[i];\n            var name = element.name;\n            var value = element.value;\n\n            if (name) {\n                ret[name] = value;\n            }\n        }\n\n        return ret;\n    }\n\n    obj.exists = function(url, __callback) {\n        var http = new XMLHttpRequest();\n        http.open('HEAD', url, false);\n        http.send();\n        if (http.status) {\n            __callback(http.status);\n        }\n    }\n\n    obj.getFiles = function(element) {\n        if (! element) {\n            console.error('No element defined in the arguments of your method');\n        }\n\n        // Get attachments\n        var files = element.querySelectorAll('.jfile');\n\n        if (files.length > 0) {\n            var data = [];\n            for (var i = 0; i < files.length; i++) {\n                var file = {};\n\n                var src = files[i].getAttribute('src');\n\n                if (files[i].classList.contains('jremove')) {\n                    file.remove = 1;\n                } else {\n                    if (src.substr(0,4) == 'data') {\n                        file.content = src.substr(src.indexOf(',') + 1);\n                        file.extension = files[i].getAttribute('data-extension');\n                    } else {\n                        file.file = src;\n                        file.extension = files[i].getAttribute('data-extension');\n                        if (! file.extension) {\n                            file.extension =  src.substr(src.lastIndexOf('.') + 1);\n                        }\n                        if (jSuites.files[file.file]) {\n                            file.content = jSuites.files[file.file];\n                        }\n                    }\n\n                    // Optional file information\n                    if (files[i].getAttribute('data-name')) {\n                        file.name = files[i].getAttribute('data-name');\n                    }\n\n                    if (files[i].getAttribute('data-file')) {\n                        file.file = files[i].getAttribute('data-file');\n                    }\n\n                    if (files[i].getAttribute('data-size')) {\n                        file.size = files[i].getAttribute('data-size');\n                    }\n\n                    if (files[i].getAttribute('data-date')) {\n                        file.date = files[i].getAttribute('data-date');\n                    }\n\n                    if (files[i].getAttribute('data-cover')) {\n                        file.cover = files[i].getAttribute('data-cover');\n                    }\n                }\n\n                // TODO SMALL thumbs?\n\n                data[i] = file;\n            }\n\n            return data;\n        }\n    }\n\n    obj.ajax = function(options) {\n        if (! options.data) {\n            options.data = {};\n        }\n\n        if (options.type) {\n            options.method = options.type;\n        }\n\n        if (options.data) {\n            var data = [];\n            var keys = Object.keys(options.data);\n\n            if (keys.length) {\n                for (var i = 0; i < keys.length; i++) {\n                    if (typeof(options.data[keys[i]]) == 'object') {\n                        var o = options.data[keys[i]];\n                        for (var j = 0; j < o.length; j++) {\n                            if (typeof(o[j]) == 'string') {\n                                data.push(keys[i] + '[' + j + ']=' + encodeURIComponent(o[j]));\n                            } else {\n                                var prop = Object.keys(o[j]);\n                                for (var z = 0; z < prop.length; z++) {\n                                    data.push(keys[i] + '[' + j + '][' + prop[z] + ']=' + encodeURIComponent(o[j][prop[z]]));\n                                }\n                            }\n                        }\n                    } else {\n                        data.push(keys[i] + '=' + encodeURIComponent(options.data[keys[i]]));\n                    }\n                }\n            }\n\n            if (options.method == 'GET' && data.length > 0) {\n                if (options.url.indexOf('?') < 0) {\n                    options.url += '?';\n                }\n                options.url += data.join('&');\n            }\n        }\n\n        var httpRequest = new XMLHttpRequest();\n        httpRequest.open(options.method, options.url, true);\n        httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n        if (options.method == 'POST') {\n            httpRequest.setRequestHeader('Accept', 'application/json');\n            httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n        } else {\n            if (options.dataType == 'json') {\n                httpRequest.setRequestHeader('Content-Type', 'text/json');\n            }\n        }\n\n        // No cache\n        if (options.cache != true) {\n            httpRequest.setRequestHeader('pragma', 'no-cache');\n            httpRequest.setRequestHeader('cache-control', 'no-cache');\n        }\n\n        // Authentication\n        if (options.withCredentials == true) {\n            httpRequest.withCredentials = true\n        }\n\n        // Before send\n        if (typeof(options.beforeSend) == 'function') {\n            options.beforeSend(httpRequest);\n        }\n\n        httpRequest.onload = function() {\n            if (httpRequest.status === 200) {\n                if (options.dataType == 'json') {\n                    try {\n                        var result = JSON.parse(httpRequest.responseText);\n\n                        if (options.success && typeof(options.success) == 'function') {\n                            options.success(result);\n                        }\n                    } catch(err) {\n                        if (options.error && typeof(options.error) == 'function') {\n                            options.error(result);\n                        }\n                    }\n                } else {\n                    var result = httpRequest.responseText;\n\n                    if (options.success && typeof(options.success) == 'function') {\n                        options.success(result);\n                    }\n                }\n            } else {\n                if (options.error && typeof(options.error) == 'function') {\n                    options.error(httpRequest.responseText);\n                }\n            }\n\n            // Global complete method\n            if (obj.ajax.requests && obj.ajax.requests.length) {\n                // Get index of this request in the container\n                var index = obj.ajax.requests.indexOf(httpRequest)\n                // Remove from the ajax requests container\n                obj.ajax.requests.splice(index, 1);\n                // Last one?\n                if (! obj.ajax.requests.length) {\n                    if (options.complete && typeof(options.complete) == 'function') {\n                        options.complete(result);\n                    }\n                }\n            }\n        }\n\n        if (data) {\n            httpRequest.send(data.join('&'));\n        } else {\n            httpRequest.send();\n        }\n\n        obj.ajax.requests.push(httpRequest);\n\n        return httpRequest;\n    }\n\n    obj.ajax.requests = [];\n\n    obj.slideLeft = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-left-in');\n            setTimeout(function() {\n                element.classList.remove('slide-left-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-left-out');\n            setTimeout(function() {\n                element.classList.remove('slide-left-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideRight = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-right-in');\n            setTimeout(function() {\n                element.classList.remove('slide-right-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-right-out');\n            setTimeout(function() {\n                element.classList.remove('slide-right-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideTop = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-top-in');\n            setTimeout(function() {\n                element.classList.remove('slide-top-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-top-out');\n            setTimeout(function() {\n                element.classList.remove('slide-top-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        }\n    }\n\n    obj.slideBottom = function(element, direction, done) {\n        if (direction == true) {\n            element.classList.add('slide-bottom-in');\n            setTimeout(function() {\n                element.classList.remove('slide-bottom-in');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 400);\n        } else {\n            element.classList.add('slide-bottom-out');\n            setTimeout(function() {\n                element.classList.remove('slide-bottom-out');\n                if (typeof(done) == 'function') {\n                    done();\n                }\n            }, 100);\n        }\n    }\n\n    obj.fadeIn = function(element, done) {\n        element.classList.add('fade-in');\n        setTimeout(function() {\n            element.classList.remove('fade-in');\n            if (typeof(done) == 'function') {\n                done();\n            }\n        }, 2000);\n    }\n\n    obj.fadeOut = function(element, done) {\n        element.classList.add('fade-out');\n        setTimeout(function() {\n            element.classList.remove('fade-out');\n            if (typeof(done) == 'function') {\n                done();\n            }\n        }, 1000);\n    }\n\n    obj.keyDownControls = function(e) {\n        if (e.which == 27) {\n            var nodes = document.querySelectorAll('.jslider');\n            if (nodes.length > 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                    nodes[i].slider.close();\n                }\n            }\n\n            if (document.querySelector('.jdialog')) {\n                jSuites.dialog.close();\n            }\n        } else if (e.which == 13) {\n            if (document.querySelector('.jdialog')) {\n                if (typeof(jSuites.dialog.options.onconfirm) == 'function') {\n                    jSuites.dialog.options.onconfirm();\n                }\n                jSuites.dialog.close();\n            }\n        }\n\n        // Verify mask\n        if (jSuites.mask) {\n            jSuites.mask.apply(e);\n        }\n    }\n\n    var actionUpControl = function(e) {\n        var element = null;\n        if (element = jSuites.getLinkElement(e.target)) {\n            var link = element.getAttribute('data-href');\n            if (link == '#back') {\n                window.history.back();\n            } else if (link == '#panel') {\n                jSuites.panel();\n            } else {\n                jSuites.pages(link);\n            }\n        }\n    }\n\n    var controlSwipeLeft = function(e) {\n        var element = jSuites.getElement(e.target, 'option');\n\n        if (element && element.querySelector('.option-actions')) {\n            element.scrollTo({\n                left: 100,\n                behavior: 'smooth'\n            });\n        } else {\n            var element = jSuites.getElement(e.target, 'jcalendar');\n            if (element && jSuites.calendar.current) {\n                jSuites.calendar.current.prev();\n            } else {\n                if (jSuites.panel) {\n                    var element = jSuites.panel.get();\n                    if (element) {\n                        if (element.style.display != 'none') {\n                            jSuites.panel.close();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    var controlSwipeRight = function(e) {\n        var element = jSuites.getElement(e.target, 'option');\n        if (element && element.querySelector('.option-actions')) {\n            element.scrollTo({\n                left: 0,\n                behavior: 'smooth'\n            });\n        } else {\n            var element = jSuites.getElement(e.target, 'jcalendar');\n            if (element && jSuites.calendar.current) {\n                jSuites.calendar.current.next();\n            } else {\n                if (jSuites.panel) {\n                    var element = jSuites.panel.get();\n                    if (element) {\n                        if (element.style.display == 'none') {\n                            jSuites.panel();\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    var actionOverControl = function(e) {\n        // Tooltip\n        if (jSuites.tooltip) {\n            jSuites.tooltip(e);\n        }\n    }\n\n    var actionOutControl = function(e) {\n        // Tooltip\n        if (jSuites.tooltip) {\n            jSuites.tooltip.hide();\n        }\n    }\n\n    // Create page container\n    document.addEventListener('swipeleft', controlSwipeLeft);\n    document.addEventListener('swiperight', controlSwipeRight);\n    document.addEventListener('keydown', obj.keyDownControls);\n\n    if ('ontouchend' in document.documentElement === true) {\n        document.addEventListener('touchend', actionUpControl);\n    } else {\n        document.addEventListener('mouseup', actionUpControl);\n    }\n\n    // Onmouseover\n    document.addEventListener('mouseover', actionOverControl);\n    document.addEventListener('mouseout', actionOutControl);\n    document.addEventListener('DOMContentLoaded', function() {\n        obj.init();\n    });\n\n    // Pop state control\n    window.onpopstate = function(e) {\n        if (e.state && e.state.route) {\n            if (jSuites.pages.get(e.state.route)) {\n                jSuites.pages(e.state.route, { ignoreHistory:true });\n            }\n        }\n    }\n\n    return obj;\n}();\n\njSuites.files = [];\r\n\r\njSuites.calendar = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Global container\n    if (! jSuites.calendar.current) {\n        jSuites.calendar.current = null;\n    }\n\n    // Default configuration\n    var defaults = {\n        // Data\n        data: null,\n        // Inline or not\n        type: null,\n        // Restrictions\n        validRange: null,\n        // Starting weekday - 0 for sunday, 6 for saturday\n        startingDay: null, \n        // Date format\n        format: 'DD/MM/YYYY',\n        // Allow keyboard date entry\n        readonly: true,\n        // Today is default\n        today: false,\n        // Show timepicker\n        time: false,\n        // Show the reset button\n        resetButton: true,\n        // Placeholder\n        placeholder: '',\n        // Translations can be done here\n        months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n        weekdays: ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\n        weekdays_short: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\n        // Value\n        value: null,\n        // Events\n        onclose: null,\n        onchange: null,\n        // Fullscreen (this is automatic set for screensize < 800)\n        fullscreen: false,\n        // Internal mode controller\n        mode: null,\n        position: null,\n        // Create the calendar closed as default\n        opened: false,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Value\n    if (! obj.options.value) {\n        if (el.tagName == 'INPUT' && el.value) {\n            obj.options.value = el.value;\n        }\n    }\n\n    // Make sure use upper case in the format\n    obj.options.format = obj.options.format.toUpperCase();\n\n    if (obj.options.value) {\n        var date = obj.options.value.split(' ');\n        var time = date[1];\n        var date = date[0].split('-');\n        var y = parseInt(date[0]);\n        var m = parseInt(date[1]);\n        var d = parseInt(date[2]);\n\n        if (time) {\n            var time = time.split(':');\n            var h = parseInt(time[0]);\n            var i = parseInt(time[1]);\n        } else {\n            var h = 0;\n            var i = 0;\n        }\n    } else {\n        var date = new Date();\n        var y = date.getFullYear();\n        var m = date.getMonth() + 1;\n        var d = date.getDate();\n        var h = date.getHours();\n        var i = date.getMinutes();\n    }\n\n    // Current value\n    obj.date = [ y, m, d, h, i, 0 ];\n\n    // Two digits\n    var two = function(value) {\n        value = '' + value;\n        if (value.length == 1) {\n            value = '0' + value;\n        }\n        return value;\n    }\n\n    // Calendar elements\n    var calendarReset = document.createElement('div');\n    calendarReset.className = 'jcalendar-reset';\n    calendarReset.innerHTML = 'Reset';\n\n    var calendarConfirm = document.createElement('div');\n    calendarConfirm.className = 'jcalendar-confirm';\n    calendarConfirm.innerHTML = 'Done';\n\n    var calendarControls = document.createElement('div');\n    calendarControls.className = 'jcalendar-controls'\n    if (obj.options.resetButton) {\n        calendarControls.appendChild(calendarReset);\n    }\n    calendarControls.appendChild(calendarConfirm);\n\n    var calendarContainer = document.createElement('div');\n    calendarContainer.className = 'jcalendar-container';\n\n    var calendarContent = document.createElement('div');\n    calendarContent.className = 'jcalendar-content';\n    calendarContent.appendChild(calendarControls);\n    calendarContainer.appendChild(calendarContent);\n\n    // Table container\n    var calendarTableContainer = document.createElement('div');\n    calendarTableContainer.className = 'jcalendar-table';\n    calendarContent.appendChild(calendarTableContainer);\n\n    // Main element\n    if (el.tagName == 'INPUT') {\n        var calendar = document.createElement('div');\n    } else {\n        var calendar = el;\n    }\n    calendar.className = 'jcalendar';\n    calendar.appendChild(calendarContainer);\n\n    // Previous button\n    var calendarHeaderPrev = document.createElement('td');\n    calendarHeaderPrev.setAttribute('colspan', '2');\n    calendarHeaderPrev.className = 'jcalendar-prev';\n\n    // Header with year and month\n    var calendarLabelYear = document.createElement('span');\n    calendarLabelYear.className = 'jcalendar-year';\n\n    var calendarLabelMonth = document.createElement('span');\n    calendarLabelMonth.className = 'jcalendar-month';\n\n    var calendarHeaderTitle = document.createElement('td');\n    calendarHeaderTitle.className = 'jcalendar-header';\n    calendarHeaderTitle.setAttribute('colspan', '3');\n    calendarHeaderTitle.appendChild(calendarLabelMonth);\n    calendarHeaderTitle.appendChild(calendarLabelYear);\n\n    var calendarHeaderNext = document.createElement('td');\n    calendarHeaderNext.setAttribute('colspan', '2');\n    calendarHeaderNext.className = 'jcalendar-next';\n\n    var calendarHeaderRow = document.createElement('tr');\n    calendarHeaderRow.appendChild(calendarHeaderPrev);\n    calendarHeaderRow.appendChild(calendarHeaderTitle);\n    calendarHeaderRow.appendChild(calendarHeaderNext);\n\n    var calendarHeader = document.createElement('thead');\n    calendarHeader.appendChild(calendarHeaderRow);\n\n    var calendarBody = document.createElement('tbody');\n    var calendarFooter = document.createElement('tfoot');\n\n    // Calendar table\n    var calendarTable = document.createElement('table');\n    calendarTable.setAttribute('cellpadding', '0');\n    calendarTable.setAttribute('cellspacing', '0');\n    calendarTable.appendChild(calendarHeader);\n    calendarTable.appendChild(calendarBody);\n    calendarTable.appendChild(calendarFooter);\n    calendarTableContainer.appendChild(calendarTable);\n\n    var calendarSelectHour = document.createElement('select');\n    calendarSelectHour.className = 'jcalendar-select';\n    calendarSelectHour.onchange = function() {\n        obj.date[3] = this.value; \n    }\n\n    for (var i = 0; i < 24; i++) {\n        var element = document.createElement('option');\n        element.value = i;\n        element.innerHTML = two(i);\n        calendarSelectHour.appendChild(element);\n    }\n\n    var calendarSelectMin = document.createElement('select');\n    calendarSelectMin.className = 'jcalendar-select';\n    calendarSelectMin.onchange = function() {\n        obj.date[4] = this.value; \n    }\n\n    for (var i = 0; i < 60; i++) {\n        var element = document.createElement('option');\n        element.value = i;\n        element.innerHTML = two(i);\n        calendarSelectMin.appendChild(element);\n    }\n\n    // Footer controls\n    var calendarControlsFooter = document.createElement('div');\n    calendarControlsFooter.className = 'jcalendar-controls';\n\n    var calendarControlsTime = document.createElement('div');\n    calendarControlsTime.className = 'jcalendar-time';\n    calendarControlsTime.style.maxWidth = '140px';\n    calendarControlsTime.appendChild(calendarSelectHour);\n    calendarControlsTime.appendChild(calendarSelectMin);\n\n    var calendarControlsUpdateButton = document.createElement('input');\n    calendarControlsUpdateButton.setAttribute('type', 'button');\n    calendarControlsUpdateButton.className = 'jcalendar-update';\n    calendarControlsUpdateButton.value = 'Update';\n\n    var calendarControlsUpdate = document.createElement('div');\n    calendarControlsUpdate.style.flexGrow = '10';\n    calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\n    calendarControlsFooter.appendChild(calendarControlsTime);\n    calendarControlsFooter.appendChild(calendarControlsUpdate);\n    calendarContent.appendChild(calendarControlsFooter);\n\n    var calendarBackdrop = document.createElement('div');\n    calendarBackdrop.className = 'jcalendar-backdrop';\n    calendar.appendChild(calendarBackdrop);\n\n    // Update actions button\n    var updateActions = function() {\n        var currentDay = calendar.querySelector('.jcalendar-selected');\n\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\n            calendarSelectHour.setAttribute('disabled', 'disabled');\n            calendarSelectMin.setAttribute('disabled', 'disabled');\n        } else {\n            calendarControlsUpdateButton.removeAttribute('disabled');\n            calendarSelectHour.removeAttribute('disabled');\n            calendarSelectMin.removeAttribute('disabled');\n        }\n    }\n\n    // Methods\n    obj.open = function (value) {\n        if (! calendar.classList.contains('jcalendar-focus')) {\n            if (jSuites.calendar.current) {\n                jSuites.calendar.current.close();\n            }\n            // Current\n            jSuites.calendar.current = obj;\n            // Show calendar\n            calendar.classList.add('jcalendar-focus');\n            // Get days\n            obj.getDays();\n            // Hour\n            if (obj.options.time) {\n                calendarSelectHour.value = obj.date[3];\n                calendarSelectMin.value = obj.date[4];\n            }\n\n            // Get the position of the corner helper\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\n                // Full\n                calendar.classList.add('jcalendar-fullsize');\n                // Animation\n                jSuites.slideBottom(calendarContent, 1);\n            } else {\n                const rect = el.getBoundingClientRect();\n                const rectContent = calendarContent.getBoundingClientRect();\n\n                if (obj.options.position) {\n                    calendarContainer.style.position = 'fixed';\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\n                    } else {\n                        calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\n                    }\n                    calendarContainer.style.left = rect.left + 'px';\n                } else {\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\n                        calendarContainer.style.bottom = (1 * rect.height + rectContent.height + 2) + 'px';\n                    } else {\n                        calendarContainer.style.top = 2 + 'px'; \n                    }\n                }\n            }\n        }\n    }\n\n    obj.close = function (ignoreEvents, update) {\n        if (jSuites.calendar.current) {\n            // Current\n            jSuites.calendar.current = null;\n\n            if (update !== false) {\n                var element = calendar.querySelector('.jcalendar-selected');\n\n                if (typeof(update) == 'string') {\n                    var value = update;\n                } else if (element && element.classList.contains('jcalendar-disabled')) {\n                    var value = obj.options.value\n                } else {\n                    var value = obj.getValue();\n                }\n\n                obj.setValue(value);\n            }\n\n            // Events\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n\n            // Hide\n            calendar.classList.remove('jcalendar-focus');\n        }\n\n        return obj.options.value;\n    }\n\n    obj.prev = function() {\n        // Check if the visualization is the days picker or years picker\n        if (obj.options.mode == 'years') {\n            obj.date[0] = obj.date[0] - 12;\n\n            // Update picker table of days\n            obj.getYears();\n        } else {\n            // Go to the previous month\n            if (obj.date[1] < 2) {\n                obj.date[0] = obj.date[0] - 1;\n                obj.date[1] = 12;\n            } else {\n                obj.date[1] = obj.date[1] - 1;\n            }\n\n            // Update picker table of days\n            obj.getDays();\n        }\n    }\n\n    obj.next = function() {\n        // Check if the visualization is the days picker or years picker\n        if (obj.options.mode == 'years') {\n            obj.date[0] = parseInt(obj.date[0]) + 12;\n\n            // Update picker table of days\n            obj.getYears();\n        } else {\n            // Go to the previous month\n            if (obj.date[1] > 11) {\n                obj.date[0] = parseInt(obj.date[0]) + 1;\n                obj.date[1] = 1;\n            } else {\n                obj.date[1] = parseInt(obj.date[1]) + 1;\n            }\n\n            // Update picker table of days\n            obj.getDays();\n        }\n    }\n\n    obj.setValue = function(val) {\n        if (! val) {\n            val = '' + val;\n        }\n        // Values\n        var newValue = val;\n        var oldValue = obj.options.value;\n        // Set label\n        var value = obj.setLabel(newValue, obj.options.format);\n        var date = newValue.split(' ');\n        if (! date[1]) {\n            date[1] = '00:00:00';\n        }\n        var time = date[1].split(':')\n        var date = date[0].split('-');\n        var y = parseInt(date[0]);\n        var m = parseInt(date[1]);\n        var d = parseInt(date[2]);\n        var h = parseInt(time[0]);\n        var i = parseInt(time[1]);\n        obj.date = [ y, m, d, h, i, 0 ];\n        var val = obj.setLabel(newValue, obj.options.format);\n\n        if (oldValue != newValue) {\n            // Input value\n            if (el.tagName == 'INPUT') {\n                el.value = val;\n            }\n            // New value\n            obj.options.value = newValue;\n            // On change\n            if (typeof(obj.options.onchange) ==  'function') {\n                obj.options.onchange(el, newValue, oldValue);\n            }\n        }\n\n        obj.getDays();\n    }\n\n    obj.getValue = function() {\n        if (obj.date) {\n            if (obj.options.time) {\n                return two(obj.date[0]) + '-' + two(obj.date[1]) + '-' + two(obj.date[2]) + ' ' + two(obj.date[3]) + ':' + two(obj.date[4]) + ':' + two(0);\n            } else {\n                return two(obj.date[0]) + '-' + two(obj.date[1]) + '-' + two(obj.date[2]) + ' ' + two(0) + ':' + two(0) + ':' + two(0);\n            }\n        } else {\n            return \"\";\n        }\n    }\n\n    /**\n     *  Calendar\n     */\n    obj.update = function(element) {\n        if (element.classList.contains('jcalendar-disabled')) {\n            // Do nothing\n        } else {\n            obj.date[2] = element.innerText;\n\n            if (! obj.options.time) {\n                obj.close();\n            } else {\n                obj.date[3] = calendarSelectHour.value;\n                obj.date[4] = calendarSelectMin.value;\n            }\n\n            var elements = calendar.querySelector('.jcalendar-selected');\n            if (elements) {\n                elements.classList.remove('jcalendar-selected');\n            }\n            element.classList.add('jcalendar-selected');\n        }\n\n        // Update\n        updateActions();\n    }\n\n    /**\n     * Set to blank\n     */\n    obj.reset = function() {\n        // Close calendar\n        obj.close(false, '');\n    }\n\n    /**\n     * Get calendar days\n     */\n    obj.getDays = function() {\n        // Mode\n        obj.options.mode = 'days';\n\n        // Setting current values in case of NULLs\n        var date = new Date();\n\n        // Current selection\n        var year = obj.date && obj.date[0] ? obj.date[0] : parseInt(date.getFullYear());\n        var month = obj.date && obj.date[1] ? obj.date[1] : parseInt(date.getMonth()) + 1;\n        var day = obj.date && obj.date[2] ? obj.date[2] : parseInt(date.getDay());\n        var hour = obj.date && obj.date[3] ? obj.date[3] : parseInt(date.getHours());\n        var min = obj.date && obj.date[4] ? obj.date[4] : parseInt(date.getMinutes());\n\n        // Selection container\n        obj.date = [year, month, day, hour, min, 0 ];\n\n        // Update title\n        calendarLabelYear.innerHTML = year;\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\n\n        // Current month and Year\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\n        var currentDay = date.getDate();\n\n        // Number of days in the month\n        var date = new Date(year, month, 0, 0, 0);\n        var numberOfDays = date.getDate();\n\n        // First day\n        var date = new Date(year, month-1, 0, 0, 0);\n        var firstDay = date.getDay() + 1;\n\n        // Index value\n        var index = obj.options.startingDay || 0;\n\n        // First of day relative to the starting calendar weekday\n        firstDay = firstDay - index;\n\n        // Reset table\n        calendarBody.innerHTML = '';\n\n        // Weekdays Row\n        var row = document.createElement('tr');\n        row.setAttribute('align', 'center');\n        calendarBody.appendChild(row);\n\n        // Create weekdays row\n        for (var i = 0; i < 7; i++) {\n            var cell = document.createElement('td');\n            cell.classList.add('jcalendar-weekday')\n            cell.innerHTML = obj.options.weekdays_short[index];\n            row.appendChild(cell);\n            // Next week day\n            index++;\n            // Restart index\n            if (index > 6) {\n                index = 0;\n            }\n        }\n\n        // Index of days\n        var index = 0;\n        var d = 0;\n \n        // Calendar table\n        for (var j = 0; j < 5; j++) {\n            // Reset cells container\n            var row = document.createElement('tr');\n            row.setAttribute('align', 'center');\n            // Data control\n            var emptyRow = true;\n            // Create cells\n            for (var i = 0; i < 7; i++) {\n                // Create cell\n                var cell = document.createElement('td');\n                cell.classList.add('jcalendar-set-day');\n\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\n                    // Day cell\n                    d++;\n                    cell.innerHTML = d;\n\n                    // Selected\n                    if (d == day) {\n                        cell.classList.add('jcalendar-selected');\n                    }\n\n                    // Current selection day is today\n                    if (isCurrentMonthAndYear && currentDay == d) {\n                        cell.style.fontWeight = 'bold';\n                    }\n\n                    // Current selection day\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\n\n                    // Available ranges\n                    if (obj.options.validRange) {\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\n                            var test1 = true;\n                        } else {\n                            var test1 = false;\n                        }\n\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\n                            var test2 = true;\n                        } else {\n                            var test2 = false;\n                        }\n\n                        if (! (test1 && test2)) {\n                            cell.classList.add('jcalendar-disabled');\n                        }\n                    }\n\n                    // Control\n                    emptyRow = false;\n                }\n                // Day cell\n                row.appendChild(cell);\n                // Index\n                index++;\n            }\n\n            // Add cell to the calendar body\n            if (emptyRow == false) {\n                calendarBody.appendChild(row);\n            }\n        }\n\n        // Show time controls\n        if (obj.options.time) {\n            calendarControlsTime.style.display = '';\n        } else {\n            calendarControlsTime.style.display = 'none';\n        }\n\n        // Update\n        updateActions();\n    }\n\n    obj.getMonths = function() {\n        // Mode\n        obj.options.mode = 'months';\n\n        // Loading month labels\n        var months = obj.options.months;\n\n        // Update title\n        calendarLabelYear.innerHTML = obj.date[0];\n        calendarLabelMonth.innerHTML = '';\n\n        // Create months table\n        var html = '<td colspan=\"7\"><table width=\"100%\"><tr align=\"center\">';\n\n        for (i = 0; i < 12; i++) {\n            if ((i > 0) && (!(i % 4))) {\n                html += '</tr><tr align=\"center\">';\n            }\n\n            var month = parseInt(i) + 1;\n            html += '<td class=\"jcalendar-set-month\" data-value=\"' + month + '\">' + months[i] +'</td>';\n        }\n\n        html += '</tr></table></td>';\n\n        calendarBody.innerHTML = html;\n    }\n\n    obj.getYears = function() { \n        // Mode\n        obj.options.mode = 'years';\n\n        // Array of years\n        var y = [];\n        for (i = 0; i < 25; i++) {\n            y[i] = parseInt(obj.date[0]) + (i - 12);\n        }\n\n        // Assembling the year tables\n        var html = '<td colspan=\"7\"><table width=\"100%\"><tr align=\"center\">';\n\n        for (i = 0; i < 25; i++) {\n            if ((i > 0) && (!(i % 5))) {\n                html += '</tr><tr align=\"center\">';\n            }\n            html += '<td class=\"jcalendar-set-year\">'+ y[i] +'</td>';\n        }\n\n        html += '</tr></table></td>';\n\n        calendarBody.innerHTML = html;\n    }\n\n    obj.setLabel = function(value, format) {\n        return jSuites.calendar.getDateString(value, format);\n    }\n\n    obj.fromFormatted = function (value, format) {\n        return jSuites.calendar.extractDateFromString(value, format);\n    }\n\n    var mouseUpControls = function(e) {\n        var action = e.target.className;\n\n        // Object id\n        if (action == 'jcalendar-prev') {\n            obj.prev();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-next') {\n            obj.next();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-month') {\n            obj.getMonths();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-year') {\n            obj.getYears();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-set-year') {\n            obj.date[0] = e.target.innerText;\n            obj.getDays();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-set-month') {\n            obj.date[1] = parseInt(e.target.getAttribute('data-value'));\n            obj.getDays();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update') {\n            obj.close();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-close') {\n            obj.close();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-backdrop') {\n            obj.close(false, false);\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (action == 'jcalendar-reset') {\n            obj.reset();\n            e.stopPropagation();\n            e.preventDefault();\n        } else if (e.target.classList.contains('jcalendar-set-day')) {\n            if (e.target.innerText) {\n                obj.update(e.target);\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        }\n    }\n\n    var keyUpControls = function(e) {\n        if (e.target.value && e.target.value.length > 3) {\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\n            if (test) {\n                if (e.target.getAttribute('data-completed') == 'true') {\n                    obj.setValue(test);\n                }\n            }\n        }\n    }\n\n    // Handle events\n    el.addEventListener(\"keyup\", keyUpControls);\n\n    // Add global events\n    calendar.addEventListener(\"swipeleft\", function(e) {\n        jSuites.slideLeft(calendarTable, 0, function() {\n            obj.next();\n            jSuites.slideRight(calendarTable, 1);\n        });\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    calendar.addEventListener(\"swiperight\", function(e) {\n        jSuites.slideRight(calendarTable, 0, function() {\n            obj.prev();\n            jSuites.slideLeft(calendarTable, 1);\n        });\n        e.preventDefault();\n        e.stopPropagation();\n    });\n\n    if ('ontouchend' in document.documentElement === true) {\n        calendar.addEventListener(\"touchend\", mouseUpControls);\n\n        el.addEventListener(\"touchend\", function(e) {\n            obj.open();\n        });\n    } else {\n        calendar.addEventListener(\"mouseup\", mouseUpControls);\n\n        el.addEventListener(\"mouseup\", function(e) {\n            obj.open();\n        });\n    }\n\n    // Append element to the DOM\n    if (el.tagName == 'INPUT') {\n        el.parentNode.insertBefore(calendar, el.nextSibling);\n        // Add properties\n        el.setAttribute('autocomplete', 'off');\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\n\n        if (obj.options.readonly) {\n            el.setAttribute('readonly', 'readonly');\n        }\n        if (obj.options.placeholder) {\n            el.setAttribute('placeholder', obj.options.placeholder);\n        }\n        // Element\n        el.classList.add('jcalendar-input');\n        // Value\n        el.value = obj.setLabel(obj.getValue(), obj.options.format);\n    }\n\n    // Keep object available from the node\n    el.calendar = obj;\n\n    if (obj.options.opened == true) {\n        obj.open();\n    }\n\n    return obj;\n});\n\njSuites.calendar.prettify = function(d, texts) {\n    if (! texts) {\n        var texts = {\n            justNow: 'Just now',\n            xMinutesAgo: '{0}m ago',\n            xHoursAgo: '{0}h ago',\n            xDaysAgo: '{0}d ago',\n            xWeeksAgo: '{0}w ago',\n            xMonthsAgo: '{0} mon ago',\n            xYearsAgo: '{0}y ago',\n        }\n    }\n\n    var d1 = new Date();\n    var d2 = new Date(d);\n    var total = parseInt((d1 - d2) / 1000 / 60);\n\n    String.prototype.format = function(o) {\n        return this.replace('{0}', o);\n    }\n\n    if (total == 0) {\n        var text = texts.justNow;\n    } else if (total < 90) {\n        var text = texts.xMinutesAgo.format(total);\n    } else if (total < 1440) { // One day\n        var text = texts.xHoursAgo.format(Math.round(total/60));\n    } else if (total < 20160) { // 14 days\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\n    } else if (total < 43200) { // 30 days\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\n    } else if (total < 1036800) { // 24 months\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\n    } else { // 24 months+\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\n    }\n\n    return text;\n}\n\njSuites.calendar.prettifyAll = function() {\n    var elements = document.querySelectorAll('.prettydate');\n    for (var i = 0; i < elements.length; i++) {\n        if (elements[i].getAttribute('data-date')) {\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\n        } else {\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\n        }\n    }\n}\n\njSuites.calendar.now = function(date, dateOnly) {\n    if (! date) {\n        var date = new Date();\n    }\n    var y = date.getFullYear();\n    var m = date.getMonth() + 1;\n    var d = date.getDate();\n    var h = date.getHours();\n    var i = date.getMinutes();\n    var s = date.getSeconds();\n\n    // Two digits\n    var two = function(value) {\n        value = '' + value;\n        if (value.length == 1) {\n            value = '0' + value;\n        }\n        return value;\n    }\n\n    if (dateOnly == true) {\n        return two(y) + '-' + two(m) + '-' + two(d);\n    } else {\n        return two(y) + '-' + two(m) + '-' + two(d) + ' ' + two(h) + ':' + two(i) + ':' + two(s);\n    }\n}\n\n// Helper to extract date from a string\njSuites.calendar.extractDateFromString = function(date, format) {\n    var v1 = '' + date;\n    var v2 = format.replace(/[0-9]/g,'');\n\n    var test = 1;\n\n    // Get year\n    var y = v2.search(\"YYYY\");\n    y = v1.substr(y,4);\n    if (parseInt(y) != y) {\n        test = 0;\n    }\n\n    // Get month\n    var m = v2.search(\"MM\");\n    m = v1.substr(m,2);\n    if (parseInt(m) != m || d > 12) {\n        test = 0;\n    }\n\n    // Get day\n    var d = v2.search(\"DD\");\n    d = v1.substr(d,2);\n    if (parseInt(d) != d  || d > 31) {\n        test = 0;\n    }\n\n    // Get hour\n    var h = v2.search(\"HH\");\n    if (h >= 0) {\n        h = v1.substr(h,2);\n        if (! parseInt(h) || h > 23) {\n            h = '00';\n        }\n    } else {\n        h = '00';\n    }\n    \n    // Get minutes\n    var i = v2.search(\"MI\");\n    if (i >= 0) {\n        i = v1.substr(i,2);\n        if (! parseInt(i) || i > 59) {\n            i = '00';\n        }\n    } else {\n        i = '00';\n    }\n\n    // Get seconds\n    var s = v2.search(\"SS\");\n    if (s >= 0) {\n        s = v1.substr(s,2);\n        if (! parseInt(s) || s > 59) {\n            s = '00';\n        }\n    } else {\n        s = '00';\n    }\n\n    if (test == 1 && date.length == v2.length) {\n        // Update source\n        var data = y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\n\n        return data;\n    }\n\n    return '';\n}\n\n// Helper to convert date into string\njSuites.calendar.getDateString = function(value, format) {\n    // Default calendar\n    if (! format) {\n        var format = 'DD/MM/YYYY';\n    }\n\n    if (value) {\n        var d = ''+value;\n        d = d.split(' ');\n\n        var h = '';\n        var m = '';\n        var s = '';\n\n        if (d[1]) {\n            h = d[1].split(':');\n            m = h[1] ? h[1] : '00';\n            s = h[2] ? h[2] : '00';\n            h = h[0] ? h[0] : '00';\n        } else {\n            h = '00';\n            m = '00';\n            s = '00';\n        }\n\n        d = d[0].split('-');\n\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\n            var calendar = new Date(d[0], d[1]-1, d[2]);\n            var weekday = new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday');\n            var months = new Array('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec');\n\n            d[1] = (d[1].length < 2 ? '0' : '') + d[1];\n            d[2] = (d[2].length < 2 ? '0' : '') + d[2];\n            h = (h.length < 2 ? '0' : '') + h;\n            m = (m.length < 2 ? '0' : '') + m;\n            s = (s.length < 2 ? '0' : '') + s;\n\n            value = format;\n            value = value.replace('WD', weekday[calendar.getDay()]);\n            value = value.replace('DD', d[2]);\n            value = value.replace('MM', d[1]);\n            value = value.replace('YYYY', d[0]);\n            value = value.replace('YY', d[0].substring(2,4));\n            value = value.replace('MON', months[parseInt(d[1])-1].toUpperCase());\n\n            if (h) {\n                value = value.replace('HH24', h);\n            }\n\n            if (h > 12) {\n                value = value.replace('HH12', h - 12);\n                value = value.replace('HH', h);\n            } else {\n                value = value.replace('HH12', h);\n                value = value.replace('HH', h);\n            }\n\n            value = value.replace('MI', m);\n            value = value.replace('MM', m);\n            value = value.replace('SS', s);\n        } else {\n            value = '';\n        }\n    }\n\n    return value;\n}\n\njSuites.calendar.isOpen = function(e) {\n    if (jSuites.calendar.current) {\n        if (! e.target.className || e.target.className.indexOf('jcalendar') == -1) {\n            jSuites.calendar.current.close(false, false);\n        }\n    }\n}\n\nif ('ontouchstart' in document.documentElement === true) {\n    document.addEventListener(\"touchstart\", jSuites.calendar.isOpen);\n} else {\n    document.addEventListener(\"mousedown\", jSuites.calendar.isOpen);\n}\r\n\r\njSuites.color = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n    obj.values = [];\n\n    // Global container\n    if (! jSuites.color.current) {\n        jSuites.color.current = null;\n    }\n\n    /**\n     * @typedef {Object} defaults\n     * @property {(string|Array)} value - Initial value of the compontent\n     * @property {string} placeholder - The default instruction text on the element\n     * @property {requestCallback} onchange - Method to be execute after any changes on the element\n     * @property {requestCallback} onclose - Method to be execute when the element is closed\n     */\n    var defaults = {\n        placeholder: '',\n        value: null,\n        onclose: null,\n        onchange: null,\n        closeOnChange: true,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    var palette = {\n          \"red\": {\n            \"50\": \"#ffebee\",\n            \"100\": \"#ffcdd2\",\n            \"200\": \"#ef9a9a\",\n            \"300\": \"#e57373\",\n            \"400\": \"#ef5350\",\n            \"500\": \"#f44336\",\n            \"600\": \"#e53935\",\n            \"700\": \"#d32f2f\",\n            \"800\": \"#c62828\",\n            \"900\": \"#b71c1c\",\n          },\n          \"pink\": {\n            \"50\": \"#fce4ec\",\n            \"100\": \"#f8bbd0\",\n            \"200\": \"#f48fb1\",\n            \"300\": \"#f06292\",\n            \"400\": \"#ec407a\",\n            \"500\": \"#e91e63\",\n            \"600\": \"#d81b60\",\n            \"700\": \"#c2185b\",\n            \"800\": \"#ad1457\",\n            \"900\": \"#880e4f\",\n          },\n          \"purple\": {\n            \"50\": \"#f3e5f5\",\n            \"100\": \"#e1bee7\",\n            \"200\": \"#ce93d8\",\n            \"300\": \"#ba68c8\",\n            \"400\": \"#ab47bc\",\n            \"500\": \"#9c27b0\",\n            \"600\": \"#8e24aa\",\n            \"700\": \"#7b1fa2\",\n            \"800\": \"#6a1b9a\",\n            \"900\": \"#4a148c\",\n          },\n          \"indigo\": {\n            \"50\": \"#e8eaf6\",\n            \"100\": \"#c5cae9\",\n            \"200\": \"#9fa8da\",\n            \"300\": \"#7986cb\",\n            \"400\": \"#5c6bc0\",\n            \"500\": \"#3f51b5\",\n            \"600\": \"#3949ab\",\n            \"700\": \"#303f9f\",\n            \"800\": \"#283593\",\n            \"900\": \"#1a237e\",\n          },\n          \"blue\": {\n            \"50\": \"#e3f2fd\",\n            \"100\": \"#bbdefb\",\n            \"200\": \"#90caf9\",\n            \"300\": \"#64b5f6\",\n            \"400\": \"#42a5f5\",\n            \"500\": \"#2196f3\",\n            \"600\": \"#1e88e5\",\n            \"700\": \"#1976d2\",\n            \"800\": \"#1565c0\",\n            \"900\": \"#0d47a1\",\n          },\n          \"cyan\": {\n            \"50\": \"#e0f7fa\",\n            \"100\": \"#b2ebf2\",\n            \"200\": \"#80deea\",\n            \"300\": \"#4dd0e1\",\n            \"400\": \"#26c6da\",\n            \"500\": \"#00bcd4\",\n            \"600\": \"#00acc1\",\n            \"700\": \"#0097a7\",\n            \"800\": \"#00838f\",\n            \"900\": \"#006064\",\n          },\n          \"teal\": {\n            \"50\": \"#e0f2f1\",\n            \"100\": \"#b2dfdb\",\n            \"200\": \"#80cbc4\",\n            \"300\": \"#4db6ac\",\n            \"400\": \"#26a69a\",\n            \"500\": \"#009688\",\n            \"600\": \"#00897b\",\n            \"700\": \"#00796b\",\n            \"800\": \"#00695c\",\n            \"900\": \"#004d40\",\n          },\n          \"green\": {\n            \"50\": \"#e8f5e9\",\n            \"100\": \"#c8e6c9\",\n            \"200\": \"#a5d6a7\",\n            \"300\": \"#81c784\",\n            \"400\": \"#66bb6a\",\n            \"500\": \"#4caf50\",\n            \"600\": \"#43a047\",\n            \"700\": \"#388e3c\",\n            \"800\": \"#2e7d32\",\n            \"900\": \"#1b5e20\",\n          },\n          \"lightgreen\": {\n            \"50\": \"#f1f8e9\",\n            \"100\": \"#dcedc8\",\n            \"200\": \"#c5e1a5\",\n            \"300\": \"#aed581\",\n            \"400\": \"#9ccc65\",\n            \"500\": \"#8bc34a\",\n            \"600\": \"#7cb342\",\n            \"700\": \"#689f38\",\n            \"800\": \"#558b2f\",\n            \"900\": \"#33691e\",\n          },\n          \"lime\": {\n            \"50\": \"#f9fbe7\",\n            \"100\": \"#f0f4c3\",\n            \"200\": \"#e6ee9c\",\n            \"300\": \"#dce775\",\n            \"400\": \"#d4e157\",\n            \"500\": \"#cddc39\",\n            \"600\": \"#c0ca33\",\n            \"700\": \"#afb42b\",\n            \"800\": \"#9e9d24\",\n            \"900\": \"#827717\",\n          },\n          \"yellow\": {\n            \"50\": \"#fffde7\",\n            \"100\": \"#fff9c4\",\n            \"200\": \"#fff59d\",\n            \"300\": \"#fff176\",\n            \"400\": \"#ffee58\",\n            \"500\": \"#ffeb3b\",\n            \"600\": \"#fdd835\",\n            \"700\": \"#fbc02d\",\n            \"800\": \"#f9a825\",\n            \"900\": \"#f57f17\",\n          },\n          \"amber\": {\n            \"50\": \"#fff8e1\",\n            \"100\": \"#ffecb3\",\n            \"200\": \"#ffe082\",\n            \"300\": \"#ffd54f\",\n            \"400\": \"#ffca28\",\n            \"500\": \"#ffc107\",\n            \"600\": \"#ffb300\",\n            \"700\": \"#ffa000\",\n            \"800\": \"#ff8f00\",\n            \"900\": \"#ff6f00\",\n          },\n          \"orange\": {\n            \"50\": \"#fff3e0\",\n            \"100\": \"#ffe0b2\",\n            \"200\": \"#ffcc80\",\n            \"300\": \"#ffb74d\",\n            \"400\": \"#ffa726\",\n            \"500\": \"#ff9800\",\n            \"600\": \"#fb8c00\",\n            \"700\": \"#f57c00\",\n            \"800\": \"#ef6c00\",\n            \"900\": \"#e65100\",\n          },\n          \"deeporange\": {\n            \"50\": \"#fbe9e7\",\n            \"100\": \"#ffccbc\",\n            \"200\": \"#ffab91\",\n            \"300\": \"#ff8a65\",\n            \"400\": \"#ff7043\",\n            \"500\": \"#ff5722\",\n            \"600\": \"#f4511e\",\n            \"700\": \"#e64a19\",\n            \"800\": \"#d84315\",\n            \"900\": \"#bf360c\",\n          },\n          \"brown\": {\n            \"50\": \"#efebe9\",\n            \"100\": \"#d7ccc8\",\n            \"200\": \"#bcaaa4\",\n            \"300\": \"#a1887f\",\n            \"400\": \"#8d6e63\",\n            \"500\": \"#795548\",\n            \"600\": \"#6d4c41\",\n            \"700\": \"#5d4037\",\n            \"800\": \"#4e342e\",\n            \"900\": \"#3e2723\"\n          },\n          \"grey\": {\n            \"50\": \"#fafafa\",\n            \"100\": \"#f5f5f5\",\n            \"200\": \"#eeeeee\",\n            \"300\": \"#e0e0e0\",\n            \"400\": \"#bdbdbd\",\n            \"500\": \"#9e9e9e\",\n            \"600\": \"#757575\",\n            \"700\": \"#616161\",\n            \"800\": \"#424242\",\n            \"900\": \"#212121\"\n          },\n          \"bluegrey\": {\n            \"50\": \"#eceff1\",\n            \"100\": \"#cfd8dc\",\n            \"200\": \"#b0bec5\",\n            \"300\": \"#90a4ae\",\n            \"400\": \"#78909c\",\n            \"500\": \"#607d8b\",\n            \"600\": \"#546e7a\",\n            \"700\": \"#455a64\",\n            \"800\": \"#37474f\",\n            \"900\": \"#263238\"\n          }\n    };\n\n    var x = 0;\n    var y = 0;\n    var colors = [];\n\n    var col = Object.keys(palette);\n    var shade = Object.keys(palette[col[0]]);\n\n    for (var i = 0; i < col.length; i++) {\n        for (var j = 0; j < shade.length; j++) {\n            if (! colors[j]) {\n                colors[j] = [];\n            }\n            colors[j][i] = palette[col[i]][shade[j]];\n        }\n    };\n\n    // Value\n    if (obj.options.value) {\n        el.value = obj.options.value;\n    }\n\n    // Table container\n    var container = document.createElement('div');\n    container.className = 'jcolor';\n\n    // Table container\n    var backdrop = document.createElement('div');\n    backdrop.className = 'jcolor-backdrop';\n    container.appendChild(backdrop);\n\n    // Content\n    var content = document.createElement('div');\n    content.className = 'jcolor-content';\n\n    // Close button\n    var closeButton  = document.createElement('div');\n    closeButton.className = 'jcolor-close';\n    closeButton.innerHTML = 'Done';\n    closeButton.onclick = function() {\n        obj.close();\n    }\n    content.appendChild(closeButton);\n\n    // Table pallete\n    var table = document.createElement('table');\n    table.setAttribute('cellpadding', '7');\n    table.setAttribute('cellspacing', '0');\n\n    for (var i = 0; i < colors.length; i++) {\n        var tr = document.createElement('tr');\n        for (var j = 0; j < colors[i].length; j++) {\n            var td = document.createElement('td');\n            td.style.backgroundColor = colors[i][j];\n            td.setAttribute('data-value', colors[i][j]);\n            td.innerHTML = '';\n            tr.appendChild(td);\n\n            // Selected color\n            if (obj.options.value == colors[i][j]) {\n                td.classList.add('jcolor-selected');\n            }\n\n            // Possible values\n            obj.values[colors[i][j]] = td;\n        }\n        table.appendChild(tr);\n    }\n\n    /**\n     * Open color pallete\n     */\n    obj.open = function() {\n        if (jSuites.color.current) {\n            if (jSuites.color.current != obj) {\n                jSuites.color.current.close();\n            }\n        }\n\n        if (! jSuites.color.current) {\n            // Persist element\n            jSuites.color.current = obj;\n            // Show colorpicker\n            container.classList.add('jcolor-focus');\n\n            const rectContent = content.getBoundingClientRect();\n\n            if (jSuites.getWindowWidth() < 800) {\n                content.style.top = '';\n                content.classList.add('jcolor-fullscreen');\n                jSuites.slideBottom(content, 1);\n                backdrop.style.display = 'block';\n            } else {\n                if (content.classList.contains('jcolor-fullscreen')) {\n                    content.classList.remove('jcolor-fullscreen');\n                    backdrop.style.display = '';\n                }\n\n                const rect = el.getBoundingClientRect();\n\n                if (window.innerHeight < rect.bottom + rectContent.height) {\n                    content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\n                } else {\n                    content.style.top = '2px';\n                }\n            }\n\n            container.focus();\n        }\n    }\n\n    /**\n     * Close color pallete\n     */\n    obj.close = function(ignoreEvents) {\n        if (jSuites.color.current) {\n            jSuites.color.current = null;\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n            container.classList.remove('jcolor-focus');\n        }\n\n        // Make sure backdrop is hidden\n        backdrop.style.display = '';\n\n        return obj.options.value;\n    }\n\n    /**\n     * Set value\n     */\n    obj.setValue = function(color) {\n        if (color) {\n            el.value = color;\n            obj.options.value = color;\n        }\n\n        // Remove current selecded mark\n        var selected = container.querySelector('.jcolor-selected');\n        if (selected) {\n            selected.classList.remove('jcolor-selected');\n        }\n\n        // Mark cell as selected\n        obj.values[color].classList.add('jcolor-selected');\n\n        // Onchange\n        if (typeof(obj.options.onchange) == 'function') {\n            obj.options.onchange(el, color);\n        }\n\r\n        if (obj.options.closeOnChange == true) {\r\n            obj.close();\r\n        }\n    }\n\n    /**\n     * Get value\n     */\n    obj.getValue = function() {\n        return obj.options.value;\n    }\n\n    /**\n     * If element is focus open the picker\n     */\n    el.addEventListener(\"focus\", function(e) {\n        obj.open();\n    });\n\n    el.addEventListener(\"mousedown\", function(e) {\n        if (! jSuites.color.current) {\r\n            setTimeout(function() {\r\n        obj.open();\n                e.preventDefault();\r\n            }, 200);\r\n        }\n    });\n\n    // Select color\n    container.addEventListener(\"mouseup\", function(e) {\n        if (e.target.tagName == 'TD') {\n            jSuites.color.current.setValue(e.target.getAttribute('data-value'));\n\r\n            if (jSuites.color.current) {\n                jSuites.color.current.close();\n            }\n        }\n    });\n\n    // Close controller\n    document.addEventListener(\"mousedown\", function(e) {\n        if (jSuites.color.current) {\n            var element = jSuites.getElement(e.target, 'jcolor');\n            if (! element) {\n                jSuites.color.current.close();\n            }\n        }\n    });\n\n    // Possible to focus the container\n    container.setAttribute('tabindex', '900');\n\n    // Placeholder\n    if (obj.options.placeholder) {\n        el.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    // Append to the table\n    content.appendChild(table);\n    container.appendChild(content);\n\n    // Insert picker after the element\n    if (el.tagName == 'INPUT') {\n        el.parentNode.insertBefore(container, el.nextSibling);\n    } else {\n        el.appendChild(container);\n    }\n\n    // Keep object available from the node\n    el.color = obj;\n\n    return obj;\n});\n\r\n\r\njSuites.contextmenu = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        items: null,\n        onclick: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Class definition\n    el.classList.add('jcontextmenu');\n    // Focusable\n    el.setAttribute('tabindex', '900');\n\n    /**\n     * Open contextmenu\n     */\n    obj.open = function(e, items) {\n        if (items) {\n            // Update content\n            obj.options.items = items;\n            // Create items\n            obj.create(items);\n        }\n        // Coordinates\n        if (e.target) {\n            var x = e.clientX;\n            var y = e.clientY;\n        } else {\n            var x = e.x;\n            var y = e.y;\n        }\n\n        el.classList.add('jcontextmenu-focus');\n        el.focus();\n\n        const rect = el.getBoundingClientRect();\n\n        if (window.innerHeight < y + rect.height) {\n            el.style.top = (y - rect.height) + 'px';\n        } else {\n            el.style.top = y + 'px';\n        }\n\n        if (window.innerWidth < x + rect.width) {\n            if (x - rect.width > 0) {\n                el.style.left = (x - rect.width) + 'px';\n            } else {\n                el.style.left = '10px';\n            }\n        } else {\n            el.style.left = x + 'px';\n        }\n    }\n\n    /**\n     * Close menu\n     */\n    obj.close = function() {\n        if (el.classList.contains('jcontextmenu-focus')) {\n            el.classList.remove('jcontextmenu-focus');\n        }\n    }\n\n    /**\n     * Create items based on the declared objectd\n     * @param {object} items - List of object\n     */\n    obj.create = function(items) {\n        // Update content\n        el.innerHTML = '';\n\n        // Append items\n        for (var i = 0; i < items.length; i++) {\n            if (items[i].type && items[i].type == 'line') {\n                var itemContainer = document.createElement('hr');\n            } else {\n                var itemContainer = document.createElement('div');\n                var itemText = document.createElement('a');\n                itemText.innerHTML = items[i].title;\n\n                if (items[i].disabled) {\n                    itemContainer.className = 'jcontextmenu-disabled';\n                } else if (items[i].onclick) {\n                    itemContainer.method = items[i].onclick;\n                    itemContainer.addEventListener(\"mouseup\", function() {\n                        // Execute method\n                        this.method(this);\n                    });\n                }\n                itemContainer.appendChild(itemText);\n\n                if (items[i].shortcut) {\n                    var itemShortCut = document.createElement('span');\n                    itemShortCut.innerHTML = items[i].shortcut;\n                    itemContainer.appendChild(itemShortCut);\n                }\n            }\n\n            el.appendChild(itemContainer);\n        }\n    }\n\n    if (typeof(obj.options.onclick) == 'function') {\n        el.addEventListener('click', function(e) {\n            obj.options.onclick(obj);\n        });\n    }\n\n    el.addEventListener('blur', function(e) {\n        setTimeout(function() {\n            obj.close();\n        }, 120);\n    });\n\n    window.addEventListener(\"mousewheel\", function() {\n        obj.close();\n    });\n\n    // Create items\n    if (obj.options.items) {\n        obj.create(obj.options.items);\n    }\n\n    el.contextmenu = obj;\n\n    return obj;\n});\n\njSuites.contextmenu.getElement = function(element) {\n    var foundId = 0;\n\n    function path (element) {\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\n            foundId = element.getAttribute('aria-contextmenu-id')\n        } else {\n            if (element.parentNode) {\n                path(element.parentNode);\n            }\n        }\n    }\n\n    path(element);\n\n    return foundId;\n}\n\ndocument.addEventListener(\"contextmenu\", function(e) {\n    var id = jSuites.contextmenu.getElement(e.target);\n    if (id) {\n        var element = document.querySelector('#' + id);\n        if (! element) {\n            console.error('JSUITES: Contextmenu id not found');\n        } else {\n            element.contextmenu.open(e);\n            e.preventDefault();\n        }\n    }\n});\r\n\r\n/**\n * Dialog v1.0.1\n * Author: paul.hodel@gmail.com\n * https://github.com/paulhodel/jtools\n */\n \njSuites.dialog = (function() {\n    var obj = {};\n    obj.options = {};\n\n    var dialog = document.createElement('div');\n    dialog.setAttribute('tabindex', '901');\n    dialog.className = 'jdialog';\n    dialog.id = 'dialog';\n\n    var dialogHeader = document.createElement('div');\n    dialogHeader.className = 'jdialog-header';\n\n    var dialogTitle = document.createElement('div');\n    dialogTitle.className = 'jdialog-title';\n    dialogHeader.appendChild(dialogTitle);\n\n    var dialogMessage = document.createElement('div');\n    dialogMessage.className = 'jdialog-message';\n    dialogHeader.appendChild(dialogMessage);\n\n    var dialogFooter = document.createElement('div');\n    dialogFooter.className = 'jdialog-footer';\n\n    var dialogContainer = document.createElement('div');\n    dialogContainer.className = 'jdialog-container';\n    dialogContainer.appendChild(dialogHeader);\n    dialogContainer.appendChild(dialogFooter);\n\n    // Confirm\n    var dialogConfirm = document.createElement('div');\n    var dialogConfirmButton = document.createElement('input');\n    dialogConfirmButton.value = obj.options.confirmLabel;\n    dialogConfirmButton.type = 'button';\n    dialogConfirmButton.onclick = function() {\n        if (typeof(obj.options.onconfirm) == 'function') {\n            obj.options.onconfirm();\n        }\n        obj.close();\n    };\n    dialogConfirm.appendChild(dialogConfirmButton);\n    dialogFooter.appendChild(dialogConfirm);\n\n    // Cancel\n    var dialogCancel = document.createElement('div');\n    var dialogCancelButton = document.createElement('input');\n    dialogCancelButton.value = obj.options.cancelLabel;\n    dialogCancelButton.type = 'button';\n    dialogCancelButton.onclick = function() {\n        if (typeof(obj.options.oncancel) == 'function') {\n            obj.options.oncancel();\n        }\n        obj.close();\n    }\n    dialogCancel.appendChild(dialogCancelButton);\n    dialogFooter.appendChild(dialogCancel);\n\n    // Dialog\n    dialog.appendChild(dialogContainer);\n\n    obj.open = function(options) {\n        obj.options = options;\n\n        if (obj.options.title) {\n            dialogTitle.innerHTML = obj.options.title;\n        }\n\n        if (obj.options.message) {\n            dialogMessage.innerHTML = obj.options.message;\n        }\n\n        if (! obj.options.confirmLabel) {\n            obj.options.confirmLabel = 'OK';\n        }\n        dialogConfirmButton.value = obj.options.confirmLabel;\n\n        if (! obj.options.cancelLabel) {\n            obj.options.cancelLabel = 'Cancel';\n        }\n        dialogCancelButton.value = obj.options.cancelLabel;\n\n        if (obj.options.type == 'confirm') {\n            dialogCancelButton.parentNode.style.display = '';\n        } else {\n            dialogCancelButton.parentNode.style.display = 'none';\n        }\n\n        // Append element to the app\n        dialog.style.opacity = 100;\n\n        // Append to the page\n        if (jSuites.el) {\n            jSuites.el.appendChild(dialog);\n        } else {\n            document.body.appendChild(dialog);\n        }\n\n        // Focus\n        dialog.focus();\n\n        // Show\n        setTimeout(function() {\n            dialogContainer.style.opacity = 100;\n        }, 0);\n    };\n\n    obj.close = function() {\n        dialog.style.opacity = 0;\n        dialogContainer.style.opacity = 0;\n        setTimeout(function() {\n            dialog.remove();\n        }, 100);\n    };\n\n    return obj;\n})();\n\njSuites.confirm = (function(message, onconfirm) {\n    if (jSuites.getWindowWidth() < 800) {\n        jSuites.dialog.open({\n            type: 'confirm',\n            message: message,\n            title: 'Confirmation',\n            onconfirm: onconfirm,\n        });\n    } else {\n        if (confirm(message)) {\n            onconfirm();\n        }\n    }\n});\n\njSuites.alert = function(message) {\n    if (jSuites.getWindowWidth() < 800) {\n        jSuites.dialog.open({\n            title:'Alert',\n            message:message,\n        });\n    } else {\n        alert(message);\n    }\n}\n\r\n\r\njSuites.dropdown = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // If the element is a SELECT tag, create a configuration object\n    if (el.tagName == 'SELECT') {\n        var ret = jSuites.dropdown.extractFromDom(el, options);\n        el = ret.el;\n        options = ret.options;\n    }\n\n    // Default configuration\n    var defaults = {\n        url: null,\n        data: [],\n        multiple: false,\n        autocomplete: false,\n        type: null,\n        width: null,\n        opened: false,\n        value: null,\n        placeholder: '',\n        position: false,\n        onchange: null,\n        onload: null,\n        onopen: null,\n        onclose: null,\n        onblur: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Global container\n    if (! jSuites.dropdown.current) {\n        jSuites.dropdown.current = null;\n    }\n\n    // Containers\n    obj.items = [];\n    obj.groups = [];\n    obj.selected = [];\n\n    // Create dropdown\n    el.classList.add('jdropdown');\n \n    if (obj.options.type == 'searchbar') {\n        el.classList.add('jdropdown-searchbar');\n    } else if (obj.options.type == 'list') {\n        el.classList.add('jdropdown-list');\n    } else if (obj.options.type == 'picker') {\n        el.classList.add('jdropdown-picker');\n    } else {\n        if (jSuites.getWindowWidth() < 800) {\n            el.classList.add('jdropdown-picker');\n            obj.options.type = 'picker';\n        } else {\n            if (obj.options.width) {\n                el.style.width = obj.options.width;\n                el.style.minWidth = obj.options.width;\n            }\n            el.classList.add('jdropdown-default');\n            obj.options.type = 'default';\n        }\n    }\n\n    // Header container\n    var containerHeader = document.createElement('div');\n    containerHeader.className = 'jdropdown-container-header';\n\n    // Header\n    var header = document.createElement('input');\n    header.className = 'jdropdown-header';\n    if (typeof(obj.options.onblur) == 'function') {\n        header.onblur = function() {\n            obj.options.onblur(el);\n        }\n    }\n\n    // Container\n    var container = document.createElement('div');\n    container.className = 'jdropdown-container';\n\n    // Dropdown content\n    var content = document.createElement('div');\n    content.className = 'jdropdown-content';\n\n    // Close button\n    var closeButton  = document.createElement('div');\n    closeButton.className = 'jdropdown-close';\n    closeButton.innerHTML = 'Done';\n\n    // Create backdrop\n    var backdrop  = document.createElement('div');\n    backdrop.className = 'jdropdown-backdrop';\n\n    // Autocomplete\n    if (obj.options.autocomplete == true) {\n        el.setAttribute('data-autocomplete', true);\n\n        // Handler\n        var keyTimer = null;\n        header.addEventListener('keyup', function(e) {\n            if (keyTimer) {\n                clearTimeout(keyTimer);\n            }\n            keyTimer = setTimeout(function() {\n                obj.find(header.value);\n                keyTimer = null;\n            }, 500);\n\n            if (! el.classList.contains('jdropdown-focus')) {\n                if (e.which > 65) {\n                    obj.open();\n                }\n            }\n        });\n    } else {\n        header.setAttribute('readonly', 'readonly');\n    }\n\n    // Place holder\n    if (! obj.options.placeholder && el.getAttribute('placeholder')) {\n        obj.options.placeholder = el.getAttribute('placeholder');\n    }\n\n    if (obj.options.placeholder) {\n        header.setAttribute('placeholder', obj.options.placeholder);\n    }\n\n    // Append elements\n    containerHeader.appendChild(header);\n    if (obj.options.type == 'searchbar') {\n        containerHeader.appendChild(closeButton);\n    } else {\n        container.appendChild(closeButton);\n    }\n    container.appendChild(content);\n    el.appendChild(containerHeader);\n    el.appendChild(container);\n    el.appendChild(backdrop);\n\n    /**\n     * Init dropdown\n     */\n    obj.init = function() {\n        if (obj.options.url) {\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(data) {\n                    if (data) {\n                        // Set data\n                        obj.setData(data);\n                        // Set value\n                        if (obj.options.value != null) {\n                            obj.setValue(obj.options.value);\n                        }\n                        // Onload method\n                        if (typeof(obj.options.onload) == 'function') {\n                            obj.options.onload(el, obj, data);\n                        }\n                    }\n                }\n            });\n        } else {\n            // Set data\n            obj.setData();\n            // Set value\n            if (obj.options.value != null) {\n                obj.setValue(obj.options.value);\n            }\n            // Onload\n            if (typeof(obj.options.onload) == 'function') {\n                obj.options.onload(el, obj, data);\n            }\n        }\n\n        // Open dropdown\n        if (obj.options.opened == true) {\n            obj.open();\n        }\n    }\n\n    obj.getUrl = function() {\n        return obj.options.url;\n    }\n\n    obj.setUrl = function(url) {\n        obj.options.url = url;\n\n        jSuites.ajax({\n            url: obj.options.url,\n            method: 'GET',\n            dataType: 'json',\n            success: function(data) {\n                obj.setData(data);\n            }\n        });\n    }\n\n    /**\n     * Create a new item\n     */\n    obj.createItem = function(data) {\n        // Create item\n        var item = {};\n        item.element = document.createElement('div');\n        item.element.className = 'jdropdown-item';\n        item.value = data.id;\n        item.text = data.name;\n        item.textLowerCase = '' + data.name.toLowerCase();\n\n        // Image\n        if (data.image) {\n            var image = document.createElement('img');\n            image.className = 'jdropdown-image';\n            image.src = data.image;\n            if (! data.title) {\n               image.classList.add('jdropdown-image-small');\n            }\n            item.element.appendChild(image);\n        }\n\n        // Set content\n        var node = document.createElement('div');\n        node.className = 'jdropdown-description';\n        node.innerHTML = data.name;\n\n        // Title\n        if (data.title) {\n            var title = document.createElement('div');\n            title.className = 'jdropdown-title';\n            title.innerHTML = data.title;\n            node.appendChild(title);\n        }\n\n        // Add node to item\n        item.element.appendChild(node);\n\n        return item;\n    }\n\n    obj.setData = function(data) {\n        // Update data\n        if (data) {\n            obj.options.data = data;\n        }\n\n        // Data\n        var data = obj.options.data;\n\n        // Remove content from the DOM\n        container.removeChild(content);\n\n        // Make sure the content container is blank\n        content.innerHTML = '';\n\n        // Reset\n        obj.reset();\n\n        // Reset items\n        obj.items = [];\n\n        // Helpers\n        var items = [];\n        var groups = [];\n\n        // Create elements\n        if (data.length) {\n            // Prepare data\n            for (var i = 0; i < data.length; i++) {\n                // Compatibility\n                if (typeof(data[i]) != 'object') {\n                    // Correct format\n                    obj.options.data[i] = data[i] = { id: data[i], name: data[i] };\n                }\n\n                // Process groups\n                if (data[i].group) {\n                    if (! groups[data[i].group]) {\n                        groups[data[i].group] = [];\n                    }\n                    groups[data[i].group].push(i);\n                } else {\n                    items.push(i);\n                }\n            }\n\n            // Groups\n            var groupNames = Object.keys(groups);\n\n            // Append groups in case exists\n            if (groupNames.length > 0) {\n                for (var i = 0; i < groupNames.length; i++) {\n                    // Group container\n                    var group = document.createElement('div');\n                    group.className = 'jdropdown-group';\n                    // Group name\n                    var groupName = document.createElement('div');\n                    groupName.className = 'jdropdown-group-name';\n                    groupName.innerHTML = groupNames[i];\n                    // Group arrow\n                    var groupArrow = document.createElement('i');\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\n                    groupName.appendChild(groupArrow);\n                    // Group items\n                    var groupContent = document.createElement('div');\n                    groupContent.className = 'jdropdown-group-items';\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\n                        var item = obj.createItem(data[groups[groupNames[i]][j]]);\n                        groupContent.appendChild(item.element);\n                        // Items\n                        obj.items.push(item);\n                    }\n                    // Group itens\n                    group.appendChild(groupName);\n                    group.appendChild(groupArrow);\n                    group.appendChild(groupContent);\n                    content.appendChild(group);\n                }\n            }\n\n            if (items.length) {\n                for (var i = 0; i < items.length; i++) {\n                    var item = obj.createItem(data[items[i]]);\n                    obj.items.push(item);\n                    content.appendChild(item.element);\n                }\n            }\n\n            // Create the Indexes\n            for (var i = 0; i < obj.items.length; i++) {\n                obj.items[i].element.setAttribute('data-index', i);\n            }\n        }\n\n        // Re-insert the content to the container\n        container.appendChild(content);\n    }\n\n    obj.getText = function(asArray) {\n        // Result\n        var result = [];\n        // Append options\n        for (var i = 0; i < obj.selected.length; i++) {\n            if (obj.items[obj.selected[i]]) {\n                result.push(obj.items[obj.selected[i]].text);\n            }\n        }\n\n        if (asArray) {\n            return result;\n        } else {\n            return result.join('; ');\n        }\n    }\n\n    obj.getValue = function(asArray) {\n        // Result\n        var result = [];\n        // Append options\n        for (var i = 0; i < obj.selected.length; i++) {\n            if (obj.items[obj.selected[i]]) {\n                result.push(obj.items[obj.selected[i]].value);\n            }\n        }\n\n        if (asArray) {\n            return result;\n        } else {\n            return result.join(';');\n        }\n    }\n\n    obj.setValue = function(value) {\n        // Remove values\n        for (var i = 0; i < obj.selected.length; i++) {\n            obj.items[obj.selected[i]].element.classList.remove('jdropdown-selected')\n        } \n\n        // Reset selected\n        obj.selected = [];\n\n        // Set values\n        if (value != null) {\n            if (Array.isArray(value)) {\n                for (var i = 0; i < obj.items.length; i++) {\n                    for (var j = 0; j < value.length; j++) {\n                        if (obj.items[i].value == value[j]) {\n                            // Keep index of the selected item\n                            obj.selected.push(i);\n                            // Visual selection\n                            obj.items[i].element.classList.add('jdropdown-selected');\n                        }\n                    }\n                }\n            } else {\n                for (var i = 0; i < obj.items.length; i++) {\n                    if (obj.items[i].value == value) {\n                        // Keep index of the selected item\n                        obj.selected.push(i);\n                        // Visual selection\n                        obj.items[i].element.classList.add('jdropdown-selected');\n                    }\n                }\n            }\n        }\n\n        // Update labels\n        obj.updateLabel();\n    }\n\n    obj.selectIndex = function(index) {\n        // Only select those existing elements\n        if (obj.items && obj.items[index]) {\n            var index = index = parseInt(index);\n            // Current selection\n            var oldValue = obj.getValue();\n            var oldLabel = obj.getText();\n\n            // Remove cursor style\n            if (obj.currentIndex != null) {\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\n            }\n            // Set cursor style\n            obj.items[index].element.classList.add('jdropdown-cursor');\n\n            // Update cursor position\n            obj.currentIndex = index;\n\n            // Focus behaviour\n            if (! obj.options.multiple) {\n                // Unselect option\n                if (obj.items[index].element.classList.contains('jdropdown-selected')) {\n                    // Reset selected\n                    obj.resetSelected();\n                } else {\n                    // Reset selected\n                    obj.resetSelected();\n                    // Update selected item\n                    obj.items[index].element.classList.add('jdropdown-selected');\n                    // Add to the selected list\n                    obj.selected.push(index);\n                    // Close\n                    obj.close();\n                }\n            } else {\n                // Toggle option\n                if (obj.items[index].element.classList.contains('jdropdown-selected')) {\n                    obj.items[index].element.classList.remove('jdropdown-selected');\n                    // Remove from selected list\n                    var indexToRemove = obj.selected.indexOf(index);\n                    // Remove select\n                    obj.selected.splice(indexToRemove, 1);\n                } else {\n                    // Select element\n                    obj.items[index].element.classList.add('jdropdown-selected');\n                    // Add to the selected list\n                    obj.selected.push(index);\n                }\n\n                // Update labels for multiple dropdown\n                if (! obj.options.autocomplete) {\n                    obj.updateLabel();\n                }\n            }\n\n            // Current selection\n            var newValue = obj.getValue();\n            var newLabel = obj.getText();\n\n            // Events\n            if (typeof(obj.options.onchange) == 'function') {\n                obj.options.onchange(el, index, oldValue, newValue, oldLabel, newLabel);\n            }\n        }\n    }\n\n    obj.selectItem = function(item) {\n        if (jSuites.dropdown.current) {\n            var index = item.getAttribute('data-index');\n            if (index != null) {\n                obj.selectIndex(index);\n            }\n        }\n    }\n\n    obj.find = function(str) {\n        // Force lowercase\n        var str = str ? str.toLowerCase() : null;\n\n        // Append options\n        for (var i = 0; i < obj.items.length; i++) {\n            if (str == null || obj.items[i].textLowerCase.indexOf(str) != -1) {\n                obj.items[i].element.style.display = '';\n            } else {\n                if (obj.selected.indexOf(i) == -1) {\n                    obj.items[i].element.style.display = 'none';\n                } else {\n                    obj.items[i].element.style.display = '';\n                }\n            }\n        }\n\n        var numVisibleItems = function(items) {\n            var visible = 0;\n            for (var j = 0; j < items.length; j++) {\n                if (items[j].style.display != 'none') {\n                    visible++;\n                }\n            }\n            return visible;\n        }\n\n        // Hide groups\n        /*for (var i = 0; i < obj.groups.length; i++) {\n            if (numVisibleItems(obj.groups[i].querySelectorAll('.jdropdown-item'))) {\n                obj.groups[i].children[0].style.display = '';\n            } else {\n                obj.groups[i].children[0].style.display = 'none';\n            }\n        }*/\n    }\n\n    obj.updateLabel = function() {\n        // Update label\n        header.value = obj.getText();\n    }\n\n    obj.open = function() {\n        if (jSuites.dropdown.current != el) {\n            if (jSuites.dropdown.current) {\n                jSuites.dropdown.current.dropdown.close();\n            }\n            jSuites.dropdown.current = el;\n        }\n\n        // Focus\n        if (! el.classList.contains('jdropdown-focus')) {\n            // Add focus\n            el.classList.add('jdropdown-focus');\n\n            // Animation\n            if (jSuites.getWindowWidth() < 800) {\n                if (obj.options.type == null || obj.options.type == 'picker') {\n                    jSuites.slideBottom(container, 1);\n                }\n            }\n\n            // Filter\n            if (obj.options.autocomplete == true) {\n                // Redo search\n                obj.find();\n                // Clear search field\n                header.value = '';\n                header.focus();\n            }\n\n            // Set cursor for the first or first selected element\n            var cursor = (obj.selected && obj.selected[0]) ? obj.selected[0] : 0;\n            obj.updateCursor(cursor);\n\n            // Container Size\n            if (! obj.options.type || obj.options.type == 'default') {\n                const rect = el.getBoundingClientRect();\n                const rectContainer = container.getBoundingClientRect();\n\n                if (obj.options.position) {\n                    container.style.position = 'fixed';\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\n                        container.style.top = '';\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\n                    } else {\n                        container.style.top = rect.bottom + 'px';\n                        container.style.bottom = '';\n                    }\n                    container.style.left = rect.left + 'px';\n                } else {\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\n                        container.style.top = '';\n                        container.style.bottom = rect.height + 1 + 'px';\n                    } else {\n                        container.style.top = '';\n                        container.style.bottom = '';\n                    }\n                }\n\n                container.style.minWidth = rect.width + 'px';\n            }\n        }\n\n        // Events\n        if (typeof(obj.options.onopen) == 'function') {\n            obj.options.onopen(el);\n        }\n    }\n\n    obj.close = function(ignoreEvents) {\n        if (jSuites.dropdown.current) {\n            // Remove controller\n            jSuites.dropdown.current = null\n            // Remove cursor\n            obj.resetCursor();\n            // Update labels\n            obj.updateLabel();\n            // Events\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\n                obj.options.onclose(el);\n            }\n            // Blur\n            if (header.blur) {\n                header.blur();\n            }\n            // Remove focus\n            el.classList.remove('jdropdown-focus');\n        }\n\n        return obj.getValue();\n    }\n\n    /**\n     * Update position cursor\n     */\n    obj.updateCursor = function(index) {\n        // Set new cursor\n        if (obj.items && obj.items[index] && obj.items[index].element) {\n            // Reset cursor\n            obj.resetCursor();\n\n            // Set new cursor\n            obj.items[index].element.classList.add('jdropdown-cursor');\n\n            // Update position\n            obj.currentIndex = parseInt(index);\n    \n            // Update scroll to the cursor element\n            var container = content.scrollTop;\n            var element = obj.items[obj.currentIndex].element;\n            content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\n        }\n    }\n\n    /**\n     * Reset cursor\n     */\n    obj.resetCursor = function() {\n        // Remove current cursor\n        if (obj.currentIndex != null) {\n            // Remove visual cursor\n            if (obj.items && obj.items[obj.currentIndex]) {\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\n            }\n            // Reset cursor\n            obj.currentIndex = null;\n        }\n    }\n\n    /**\n     * Reset cursor\n     */\n    obj.resetSelected = function() {\n        // Unselected all\n        if (obj.selected) {\n            // Remove visual selection\n            for (var i = 0; i < obj.selected.length; i++) {\n                if (obj.items[obj.selected[i]]) {\n                    obj.items[obj.selected[i]].element.classList.remove('jdropdown-selected');\n                }\n            }\n            // Reset current selected items\n            obj.selected = [];\n        }\n    }\n\n    /**\n     * Reset cursor and selected items\n     */\n    obj.reset = function() {\n        // Reset cursor\n        obj.resetCursor();\n\n        // Reset selected\n        obj.resetSelected();\n\n        // Update labels\n        obj.updateLabel();\n    }\n\n    /**\n     * First visible item\n     */\n    obj.firstVisible = function() {\n        var newIndex = null;\n        for (var i = 0; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    /**\n     * Navigation\n     */\n    obj.first = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex - 1; i >= 0; i--) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.last = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex + 1; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.next = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex + 1; i < obj.items.length; i++) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    obj.prev = function() {\n        var newIndex = null;\n        for (var i = obj.currentIndex - 1; i >= 0; i--) {\n            if (obj.items[i].element.style.display != 'none') {\n                newIndex = i;\n                break;\n            }\n        }\n\n        if (newIndex == null) {\n            return false;\n        }\n\n        obj.updateCursor(newIndex);\n    }\n\n    if (! jSuites.dropdown.hasEvents) {\n        if ('ontouchsend' in document.documentElement === true) {\n            document.addEventListener('touchsend', jSuites.dropdown.mouseup);\n        } else {\n            document.addEventListener('mouseup', jSuites.dropdown.mouseup);\n        }\n        document.addEventListener('keydown', jSuites.dropdown.onkeydown);\n\n        jSuites.dropdown.hasEvents = true;\n    }\n\n    // Start dropdown\n    obj.init();\n\n    // Keep object available from the node\n    el.dropdown = obj;\n\n    return obj;\n});\n\njSuites.dropdown.hasEvents = false;\n\njSuites.dropdown.mouseup = function(e) {\n    var element = jSuites.getElement(e.target, 'jdropdown');\n    if (element) {\n        var dropdown = element.dropdown;\n        if (e.target.classList.contains('jdropdown-header')) {\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\n                dropdown.close();\n            } else {\n                dropdown.open();\n            }\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\n            var items = e.target.nextSibling.children;\n            if (e.target.nextSibling.style.display != 'none') {\n                for (var i = 0; i < items.length; i++) {\n                    if (items[i].style.display != 'none') {\n                        dropdown.selectItem(items[i]);\n                    }\n                }\n            }\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\n                e.target.classList.remove('jdropdown-group-arrow-down');\n                e.target.classList.add('jdropdown-group-arrow-up');\n                e.target.parentNode.nextSibling.style.display = 'none';\n            } else {\n                e.target.classList.remove('jdropdown-group-arrow-up');\n                e.target.classList.add('jdropdown-group-arrow-down');\n                e.target.parentNode.nextSibling.style.display = '';\n            }\n        } else if (e.target.classList.contains('jdropdown-item')) {\n            dropdown.selectItem(e.target);\n        } else if (e.target.classList.contains('jdropdown-image')) {\n            dropdown.selectIndex(e.target.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-description')) {\n            dropdown.selectIndex(e.target.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-title')) {\n            dropdown.selectIndex(e.target.parentNode.parentNode.getAttribute('data-index'));\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\n            // Close\n            dropdown.close();\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n    } else {\n        if (jSuites.dropdown.current) {\n            jSuites.dropdown.current.dropdown.close();\n        }\n    }\n}\n\n\n// Keydown controls\njSuites.dropdown.onkeydown = function(e) {\n    if (jSuites.dropdown.current) {\n        // Element\n        var element = jSuites.dropdown.current.dropdown;\n        // Index\n        var index = element.currentIndex;\n\n        if (e.shiftKey) {\n\n        } else {\n            if (e.which == 13 || e.which == 27 || e.which == 35 || e.which == 36 || e.which == 38 || e.which == 40) {\n                // Move cursor\n                if (e.which == 13) {\n                    element.selectIndex(index)\n                } else if (e.which == 38) {\n                    if (index == null) {\n                        element.firstVisible();\n                    } else if (index > 0) {\n                        element.prev();\n                    }\n                } else if (e.which == 40) {\n                    if (index == null) {\n                        element.firstVisible();\n                    } else if (index + 1 < element.options.data.length) {\n                        element.next();\n                    }\n                } else if (e.which == 36) {\n                    element.first();\n                } else if (e.which == 35) {\n                    element.last();\n                } else if (e.which == 27) {\n                    element.close();\n                }\n\n                e.stopPropagation();\n                e.preventDefault();\n            }\n        }\n    }\n}\n\njSuites.dropdown.extractFromDom = function(el, options) {\n    // Keep reference\n    var select = el;\n    if (! options) {\n        options = {};\n    }\n    // Prepare configuration\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\n        options.multiple = true;\n    }\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\n        options.placeholder = el.getAttribute('placeholder');\n    }\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\n        options.autocomplete = true;\n    }\n    if (! options || options.width == undefined) {\n        options.width = el.offsetWidth;\n    }\n    if (el.value && (! options || options.value == undefined)) {\n        options.value = el.value;\n    }\n    if (! options || options.data == undefined) {\n        options.data = [];\n        for (var j = 0; j < el.children.length; j++) {\n            if (el.children[j].tagName == 'OPTGROUP') {\n                for (var i = 0; i < el.children[j].children.length; i++) {\n                    options.data.push({\n                        id: el.children[j].children[i].value,\n                        name: el.children[j].children[i].innerHTML,\n                        group: el.children[j].getAttribute('label'),\n                    });\n                }\n            } else {\n                options.data.push({\n                    id: el.children[j].value,\n                    name: el.children[j].innerHTML,\n                });\n            }\n        }\n    }\n    if (! options || options.onchange == undefined) {\n        options.onchange = function(a,b,c,d) {\n            if (options.multiple == true) {\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\n                    select.options[b].setAttribute('selected', 'selected');\n                } else {\n                    select.options[b].removeAttribute('selected');\n                }\n            } else {\n                select.value = d;\n            }\n        }\n    }\n    // Create DIV\n    var div = document.createElement('div');\n    el.parentNode.insertBefore(div, el);\n    el.style.display = 'none';\n    el = div;\n\n    return { el:el, options:options };\n}\r\n\r\n/**\n * (c) jTools Text Editor\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Inline richtext editor\n */\n\njSuites.editor = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        // Initial HTML content\n        value: null,\n        // Initial snippet\n        snippet: null,\n        // Add toolbar\n        toolbar: null,\n        // Max height\n        maxHeight: null,\n        // Website parser is to read websites and images from cross domain\n        remoteParser: null,\n        // Key from youtube to read properties from URL\n        youtubeKey: null,\n        // User list\n        userSearch: null,\n        // Parse URL\n        parseURL: false,\n        // Accept drop files\n        dropZone: true,\n        dropAsAttachment: false,\n        acceptImages: true,\n        acceptFiles: false,\n        maxFileSize: 5000000, \n        // Border\n        border: true,\n        padding: true,\n        focus: false,\n        // Events\n        onclick: null,\n        onfocus: null,\n        onblur: null,\n        onload: null,\n        onenter: null,\n        onkeyup: null,\n        onkeydown: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Private controllers\n    var imageResize = 0;\n    var editorTimer = null;\n    var editorAction = null;\n\n    // Make sure element is empty\n    el.innerHTML = '';\n\n    // Prepare container\n    el.classList.add('jeditor-container');\n\n    // Padding\n    if (obj.options.padding == true) {\n        el.classList.add('jeditor-padding');\n    }\n\n    // Border\n    if (obj.options.border == false) {\n        el.style.border = '0px';\n    }\n\n    // Snippet\n    var snippet = document.createElement('div');\n    snippet.className = 'snippet';\n    snippet.setAttribute('contenteditable', false);\n\n    // Toolbar\n    var toolbar = document.createElement('div');\n    toolbar.className = 'jeditor-toolbar';\n\n    // Create editor\n    var editor = document.createElement('div');\n    editor.setAttribute('contenteditable', true);\n    editor.setAttribute('spellcheck', false);\n    editor.className = 'jeditor';\n\n    // Max height\n    if (obj.options.maxHeight) {\n        editor.style.overflowY = 'auto';\n        editor.style.maxHeight = obj.options.maxHeight;\n    }\n\n    // Set editor initial value\n    if (obj.options.value) {\n        var value = obj.options.value;\n    } else {\n        var value = el.innerHTML ? el.innerHTML : ''; \n    }\n\n    if (! value) {\n        var value = '<br>';\n    }\n\n    /**\n     * Extract images from a HTML string\n     */\n    var extractImageFromHtml = function(html) {\n        // Create temp element\n        var div = document.createElement('div');\n        div.innerHTML = html;\n\n        // Extract images\n        var img = div.querySelectorAll('img');\n\n        if (img.length) {\n            for (var i = 0; i < img.length; i++) {\n                obj.addImage(img[i].src);\n            }\n        }\n    }\n\n    /**\n     * Insert node at caret\n     */\n    var insertNodeAtCaret = function(newNode) {\n        var sel, range;\n\n        if (window.getSelection) {\n            sel = window.getSelection();\n            if (sel.rangeCount) {\n                range = sel.getRangeAt(0);\n                var selectedText = range.toString();\n                range.deleteContents();\n                range.insertNode(newNode); \n                // move the cursor after element\n                range.setStartAfter(newNode);\n                range.setEndAfter(newNode); \n                sel.removeAllRanges();\n                sel.addRange(range);\n            }\n        }\n    }\n\n    /**\n     * Append snippet or thumbs in the editor\n     * @Param object data\n     */\n    var appendElement = function(data) {\n        // Reset snippet\n        snippet.innerHTML = '';\n\n        if (data.image) {\n            var div = document.createElement('div');\n            div.className = 'snippet-image';\n            div.setAttribute('data-k', 'image');\n            snippet.appendChild(div);\n\n            var image = document.createElement('img');\n            image.src = data.image;\n            div.appendChild(image);\n        }\n\n        var div = document.createElement('div');\n        div.className = 'snippet-title';\n        div.setAttribute('data-k', 'title');\n        div.innerHTML = data.title;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-description';\n        div.setAttribute('data-k', 'description');\n        div.innerHTML = data.description;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-host';\n        div.setAttribute('data-k', 'host');\n        div.innerHTML = data.host;\n        snippet.appendChild(div);\n\n        var div = document.createElement('div');\n        div.className = 'snippet-url';\n        div.setAttribute('data-k', 'url');\n        div.innerHTML = data.url;\n        snippet.appendChild(div);\n\n        editor.appendChild(snippet);\n    }\n\n    var verifyEditor = function() {\n        clearTimeout(editorTimer);\n        editorTimer = setTimeout(function() {\n            var snippet = editor.querySelector('.snippet');\n            var thumbsContainer = el.querySelector('.jeditor-thumbs-container');\n\n            if (! snippet && ! thumbsContainer) {\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\n                var container = document.createElement('div');\n                container.innerHTML = html;\n                var thumbsContainer = container.querySelector('.jeditor-thumbs-container');\n                if (thumbsContainer) {\n                    thumbsContainer.remove();\n                }\n                var text = container.innerText; \n                var url = jSuites.editor.detectUrl(text);\n\n                if (url) {\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\n                        if (jSuites.editor.getDomain(url[0]) == window.location.hostname) {\n                            obj.importImage(url[0], '');\n                        } else {\n                            obj.importImage(obj.options.remoteParser + url[0], '');\n                        }\n                    } else {\n                        var id = jSuites.editor.youtubeParser(url[0]);\n\n                        if (id) {\n                            obj.getYoutube(id);\n                        } else {\n                            obj.getWebsite(url[0]);\n                        }\n                    }\n                }\n            }\n        }, 1000);\n    }\n\n    obj.parseContent = function() {\n        verifyEditor();\n    }\n\n    /**\n     * Get metadata from a youtube video\n     */\n    obj.getYoutube = function(id) {\n        if (! obj.options.youtubeKey) {\n            console.error('The youtubeKey is not defined');\n        } else {\n            jSuites.ajax({\n                url: 'https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&key=' + obj.options.youtubeKey + '&id=' + id,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    // Only valid elements to be appended\n                    if (result.items && result.items[0]) {\n                        var p = {\n                            title: '',\n                            description: '',\n                            image: '',\n                            host: 'www.youtube.com',\n                            url: 'https://www.youtube.com?watch=' + id,\n                        }\n                        if (result.items[0].snippet.title) {\n                            p.title = result.items[0].snippet.title;\n                        }\n                        if (result.items[0].snippet.description) {\n                            p.description = result.items[0].snippet.description;\n\n                            if (p.description.length > 150) {\n                                p.description = p.description.substr(0, 150) + '...';\n                            }\n                        }\n                        if (result.items[0].snippet.thumbnails.medium.url) {\n                            p.image = result.items[0].snippet.thumbnails.medium.url;\n                        }\n\n                        appendElement(p);\n                    }\n                }\n            });\n        }\n    }\n\n    /**\n     * Get meta information from a website\n     */\n    obj.getWebsite = function(url) {\n        if (! obj.options.remoteParser) {\n            console.log('The remoteParser is not defined');\n        } else {\n            jSuites.ajax({\n                url: obj.options.remoteParser + encodeURI(url.trim()),\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    var p = {\n                        title: '',\n                        description: '',\n                        image: '',\n                        host: url,\n                        url: url,\n                    }\n\n                    if (result.title) {\n                        p.title = result.title;\n                    }\n                    if (result.description) {\n                        p.description = result.description;\n                    }\n                    if (result.image) {\n                        p.image = result.image;\n                    } else if (result['og:image']) {\n                        p.image = result['og:image'];\n                    }\n                    if (result.host) {\n                        p.host = result.host;\n                    }\n                    if (result.url) {\n                        p.url = result.url;\n                    }\n\n                    appendElement(p);\n                }\n            });\n        }\n    }\n\n    /**\n     * Set editor value\n     */\n    obj.setData = function(html) {\n        editor.innerHTML = html;\n        cursor();\n    }\n\n    /**\n     * Get editor data\n     */\n    obj.getData = function(json) {\n        if (! json) {\n            var data = editor.innerHTML;\n        } else {\n            var data = {\n                content : '',\n            }\n\n            // Get tag users\n            var tagged = editor.querySelectorAll('.post-tag');\n            if (tagged.length) {\n                data.users = [];\n                for (var i = 0; i < tagged.length; i++) {\n                    var userId = tagged[i].getAttribute('data-user');\n                    if (userId) {\n                        data.users.push(userId);\n                    }\n                }\n                data.users = data.users.join(',');\n            }\n\n            if (snippet.innerHTML) {\n                var index = 0;\n                data.snippet = {};\n                for (var i = 0; i < snippet.children.length; i++) {\n                    // Get key from element\n                    var key = snippet.children[i].getAttribute('data-k');\n                    if (key) {\n                        if (key == 'image') {\n                            data.snippet.image = snippet.children[i].children[0].getAttribute('src');\n                        } else {\n                            data.snippet[key] = snippet.children[i].innerHTML;\n                        }\n                    }\n                }\n\n                snippet.innerHTML = '';\n                snippet.remove();\n            }\n\n            var text = editor.innerHTML;\n            text = text.replace(/<br>/g, \"\\n\");\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\n            data.content = text.trim();\n            data = JSON.stringify(data);\n        }\n\n        return data;\n    }\n\n    // Reset\n    obj.reset = function() {\n        editor.innerHTML = '';\n    }\n\n    obj.addPdf = function(data) {\n        if (data.result.substr(0,4) != 'data') {\n            console.error('Invalid source');\n        } else {\n            var canvas = document.createElement('canvas');\n            canvas.width = 60;\n            canvas.height = 60;\n\n            var img = new Image();\n            var ctx = canvas.getContext('2d');\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n            canvas.toBlob(function(blob) {\n                var newImage = document.createElement('img');\n                newImage.src = window.URL.createObjectURL(blob);\n                newImage.setAttribute('data-extension', 'pdf');\n                if (data.name) {\n                    newImage.setAttribute('data-name', data.name);\n                }\n                if (data.size) {\n                    newImage.setAttribute('data-size', data.size);\n                }\n                if (data.date) {\n                    newImage.setAttribute('data-date', data.date);\n                }\n                newImage.className = 'jfile pdf';\n\n                insertNodeAtCaret(newImage);\n                jSuites.files[newImage.src] = data.result.substr(data.result.indexOf(',') + 1);\n            });\n        }\n    }\n\n    obj.addImage = function(src, name, size, date) {\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\n            console.error('remoteParser not defined in your initialization');\n        } else {\n            // This is to process cross domain images\n            if (src.substr(0,4) == 'data') {\n                var extension = src.split(';')\n                extension = extension[0].split('/');\n                extension = extension[1];\n            } else {\n                var extension = src.substr(src.lastIndexOf('.') + 1);\n                // Work for cross browsers\n                src = obj.options.remoteParser + src;\n            }\n\n            var img = new Image();\n\n            img.onload = function onload() {\n                var canvas = document.createElement('canvas');\n                canvas.width = img.width;\n                canvas.height = img.height;\n\n                var ctx = canvas.getContext('2d');\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n                canvas.toBlob(function(blob) {\n                    var newImage = document.createElement('img');\n                    newImage.src = window.URL.createObjectURL(blob);\n                    newImage.setAttribute('tabindex', '900');\n                    newImage.setAttribute('data-extension', extension);\n                    if (name) {\n                        newImage.setAttribute('data-name', name);\n                    }\n                    if (size) {\n                        newImage.setAttribute('data-size', size);\n                    }\n                    if (date) {\n                        newImage.setAttribute('data-date', date);\n                    }\n                    newImage.className = 'jfile';\n                    var content = canvas.toDataURL();\n                    insertNodeAtCaret(newImage);\n\n                    jSuites.files[newImage.src] = content.substr(content.indexOf(',') + 1);\n                });\n            };\n\n            img.src = src;\n        }\n    }\n\n    obj.addFile = function(files) {\n        var reader = [];\n\n        for (var i = 0; i < files.length; i++) {\n            if (files[i].size > obj.options.maxFileSize) {\n                alert('The file is too big');\n            } else {\n                // Only PDF or Images\n                var type = files[i].type.split('/');\n\n                if (type[0] == 'image') {\n                    type = 1;\n                } else if (type[1] == 'pdf') {\n                    type = 2;\n                } else {\n                    type = 0;\n                }\n\n                if (type) {\n                    // Create file\n                    reader[i] = new FileReader();\n                    reader[i].index = i;\n                    reader[i].type = type;\n                    reader[i].name = files[i].name;\n                    reader[i].date = files[i].lastModified;\n                    reader[i].size = files[i].size;\n                    reader[i].addEventListener(\"load\", function (data) {\n                        // Get result\n                        if (data.target.type == 2) {\n                            if (obj.options.acceptFiles == true) {\n                                obj.addPdf(data.target);\n                            }\n                        } else {\n                            obj.addImage(data.target.result, data.target.name, data.total, data.target.lastModified);\n                        }\n                    }, false);\n\n                    reader[i].readAsDataURL(files[i])\n                } else {\n                    alert('The extension is not allowed');\n                }\n            }\n        }\n    }\n\n    // Destroy\n    obj.destroy = function() {\n        editor.removeEventListener('mouseup', editorMouseUp);\n        editor.removeEventListener('mousedown', editorMouseDown);\n        editor.removeEventListener('mousemove', editorMouseMove);\n        editor.removeEventListener('keyup', editorKeyUp);\n        editor.removeEventListener('keydown', editorKeyDown);\n        editor.removeEventListener('dragstart', editorDragStart);\n        editor.removeEventListener('dragenter', editorDragEnter);\n        editor.removeEventListener('dragover', editorDragOver);\n        editor.removeEventListener('drop', editorDrop);\n        editor.removeEventListener('paste', editorPaste);\n\n        if (typeof(obj.options.onblur) == 'function') {\n            editor.removeEventListener('blur', editorBlur);\n        }\n        if (typeof(obj.options.onfocus) == 'function') {\n            editor.removeEventListener('focus', editorFocus);\n        }\n\n        el.editor = null;\n        el.classList.remove('jeditor-container');\n\n        toolbar.remove();\n        snippet.remove();\n        editor.remove();\n    }\n\n    var isLetter = function (str) {\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\n        return str.match(regex) ? 1 : 0;\n    }\n\n    // Event handlers\n    var editorMouseUp = function(e) {\n        editorAction = false;\n    }\n\n    var editorMouseDown = function(e) {\n        var close = function(snippet) {\n            var rect = snippet.getBoundingClientRect();\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\n                snippet.innerHTML = '';\n                snippet.remove();\n            }\n        }\n\n        if (e.target.tagName == 'IMG') {\n            if (e.target.style.cursor) {\n                var rect = e.target.getBoundingClientRect();\n                editorAction = {\n                    e: e.target,\n                    x: e.clientX,\n                    y: e.clientY,\n                    w: rect.width,\n                    h: rect.height,\n                    d: e.target.style.cursor,\n                }\n\n                if (! e.target.style.width) {\n                    e.target.style.width = rect.width + 'px';\n                }\n\n                if (! e.target.style.height) {\n                    e.target.style.height = rect.height + 'px';\n                }\n\n                var s = window.getSelection();\n                if (s.rangeCount) {\n                    for (var i = 0; i < s.rangeCount; i++) {\n                        s.removeRange(s.getRangeAt(i));\n                    }\n                }\n            } else {\n                editorAction = true;\n            }\n        } else { \n            if (e.target.classList.contains('snippet')) {\n                close(e.target);\n            } else if (e.target.parentNode.classList.contains('snippet')) {\n                close(e.target.parentNode);\n            }\n\n            editorAction = true;\n        }\n    }\n\n    var editorMouseMove = function(e) {\n        if (e.target.tagName == 'IMG') {\n            if (e.target.getAttribute('tabindex')) {\n                var rect = e.target.getBoundingClientRect();\n                if (e.clientY - rect.top < 5) {\n                    if (rect.width - (e.clientX - rect.left) < 5) {\n                        e.target.style.cursor = 'ne-resize';\n                    } else if (e.clientX - rect.left < 5) {\n                        e.target.style.cursor = 'nw-resize';\n                    } else {\n                        e.target.style.cursor = 'n-resize';\n                    }\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\n                    if (rect.width - (e.clientX - rect.left) < 5) {\n                        e.target.style.cursor = 'se-resize';\n                    } else if (e.clientX - rect.left < 5) {\n                        e.target.style.cursor = 'sw-resize';\n                    } else {\n                        e.target.style.cursor = 's-resize';\n                    }\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\n                    e.target.style.cursor = 'e-resize';\n                } else if (e.clientX - rect.left < 5) {\n                    e.target.style.cursor = 'w-resize';\n                } else {\n                    e.target.style.cursor = '';\n                }\n            }\n        }\n\n        // Move\n        if (e.which == 1 && editorAction && editorAction.d) {\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\n                editorAction.e.style.width = (editorAction.w + (e.clientX - editorAction.x)) + 'px';\n\n                if (e.shiftKey) {\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\n                    editorAction.e.style.height = editorAction.h + newHeight + 'px';\n                } else {\n                    var newHeight =  null;\n                }\n            }\n\n            if (! newHeight) {\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\n                    if (! e.shiftKey) {\n                        editorAction.e.style.height = editorAction.h + (e.clientY - editorAction.y);\n                    }\n                }\n            }\n        }\n    }\n\n    var editorKeyUp = function(e) {\n        if (! editor.innerHTML) {\n            editor.innerHTML = '<div><br></div>';\n        }\n\n        if (typeof(obj.options.onkeyup) == 'function') { \n            obj.options.onkeyup(e, el);\n        }\n    }\n\n\n    var editorKeyDown = function(e) {\n        // Check for URL\n        if (obj.options.parseURL == true) {\n            verifyEditor();\n        }\n\n        // Closable\n        if (typeof(obj.options.onenter) == 'function' && e.which == 13) {\n            var data = obj.getData();\n            obj.options.onenter(obj, el, data, e);\n        }\n\n        if (typeof(obj.options.onkeydown) == 'function') { \n            obj.options.onkeydown(e, el);\n        }\n    }\n\n    var editorPaste = function(e) {\n        if (e.clipboardData || e.originalEvent.clipboardData) {\n            var html = (e.originalEvent || e).clipboardData.getData('text/html');\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\n            var file = (e.originalEvent || e).clipboardData.files\n        } else if (window.clipboardData) {\n            var html = window.clipboardData.getData('Html');\n            var text = window.clipboardData.getData('Text');\n            var file = window.clipboardData.files\n        }\n\n        if (file.length) {\n            // Paste a image from the clipboard\n            obj.addFile(file);\n        } else {\n            // Paste text\n            text = text.split('\\r\\n');\n            var str = '';\n            if (e.target.nodeName == 'DIV' && ! e.target.classList.contains('jeditor')) {\n                for (var i = 0; i < text.length; i++) {\n                    if (text[i]) {\n                        str += text[i] + \"<br>\\r\\n\";\n                    }\n                }\n            } else {\n                for (var i = 0; i < text.length; i++) {\n                    if (text[i]) {\n                        str += '<div>' + text[i] + '</div>';\n                    } else {\n                        str += '<div><br></div>';\n                    }\n                }\n            }\n            // Insert text\n            document.execCommand('insertHtml', false, str);\n\n            // Extra images from the paste\n            if (obj.options.acceptImages == true) {\n                extractImageFromHtml(html);\n            }\n        }\n\n        e.preventDefault();\n    }\n\n    var editorDragStart = function(e) {\n        if (editorAction && editorAction.e) {\n            e.preventDefault();\n        }\n    }\n\n    var editorDragEnter = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            el.classList.add('jeditor-dragging');\n        }\n    }\n\n    var editorDragOver = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            if (editorTimer) {\n                clearTimeout(editorTimer);\n            }\n\n            editorTimer = setTimeout(function() {\n                el.classList.remove('jeditor-dragging');\n            }, 100);\n        }\n    }\n\n    var editorDrop = function(e) {\n        if (editorAction || obj.options.dropZone == false) {\n            // Do nothing\n        } else {\n            // Position caret on the drop\n            var range = null;\n            if (document.caretRangeFromPoint) {\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\n            } else if (e.rangeParent) {\n                range=document.createRange();\n                range.setStart(e.rangeParent,e.rangeOffset);\n            }\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n            sel.anchorNode.parentNode.focus();\n\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\n            var file = (e.originalEvent || e).dataTransfer.files;\n    \n            if (file.length) {\n                obj.addFile(file);\n            } else if (text) {\n                extractImageFromHtml(html);\n            }\n\n            el.classList.remove('jeditor-dragging');\n            e.preventDefault();\n        }\n    }\n\n    var editorBlur = function() {\n        obj.options.onblur(obj, el, obj.getData());\n    }\n\n    var editorFocus = function() {\n        obj.options.onfocus(obj, el, obj.getData());\n    }\n\n    editor.addEventListener('mouseup', editorMouseUp);\n    editor.addEventListener('mousedown', editorMouseDown);\n    editor.addEventListener('mousemove', editorMouseMove);\n    editor.addEventListener('keyup', editorKeyUp);\n    editor.addEventListener('keydown', editorKeyDown);\n    editor.addEventListener('dragstart', editorDragStart);\n    editor.addEventListener('dragenter', editorDragEnter);\n    editor.addEventListener('dragover', editorDragOver);\n    editor.addEventListener('drop', editorDrop);\n    editor.addEventListener('paste', editorPaste);\n\n    // Blur\n    if (typeof(obj.options.onblur) == 'function') {\n        editor.addEventListener('blur', editorBlur);\n    }\n\n    // Focus\n    if (typeof(obj.options.onfocus) == 'function') {\n        editor.addEventListener('focus', editorFocus);\n    }\n\n    // Onload\n    if (typeof(obj.options.onload) == 'function') {\n        obj.options.onload(el, editor);\n    }\n\n    // Set value to the editor\n    editor.innerHTML = value;\n\n    // Append editor to the containre\n    el.appendChild(editor);\n\n    // Snippet\n    if (obj.options.snippet) {\n        appendElement(obj.options.snippet);\n    }\n\n    // Default toolbar\n    if (obj.options.toolbar == null) {\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\n    }\n\n    // Add toolbar\n    if (obj.options.toolbar) {\n        for (var i = 0; i < obj.options.toolbar.length; i++) {\n            if (obj.options.toolbar[i].icon) {\n                var item = document.createElement('div');\n                item.style.userSelect = 'none';\n                var itemIcon = document.createElement('i');\n                itemIcon.className = 'material-icons';\n                itemIcon.innerHTML = obj.options.toolbar[i].icon;\n                itemIcon.onclick = (function (a) {\n                    var b = a;\n                    return function () {\n                        obj.options.toolbar[b].onclick(el, obj, this)\n                    };\n                })(i);\n                item.appendChild(itemIcon);\n                toolbar.appendChild(item);\n            } else {\n                if (obj.options.toolbar[i].type == 'divisor') {\n                    var item = document.createElement('div');\n                    item.className = 'jeditor-toolbar-divisor';\n                    toolbar.appendChild(item);\n                } else if (obj.options.toolbar[i].type == 'button') {\n                    var item = document.createElement('div');\n                    item.classList.add('jeditor-toolbar-button');\n                    item.innerHTML = obj.options.toolbar[i].value;\n                    toolbar.appendChild(item);\n                }\n            }\n        }\n\n        el.appendChild(toolbar);\n    }\n\n    // Focus to the editor\n    if (obj.options.focus) {\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\n    }\n\n    el.editor = obj;\n\n    return obj;\n});\n\njSuites.editor.setCursor = function(element, first) {\n    element.focus();\n    document.execCommand('selectAll');\n    var sel = window.getSelection();\n    var range = sel.getRangeAt(0);\n    if (first == true) {\n        var node = range.startContainer;\n        var size = 0;\n    } else {\n        var node = range.endContainer;\n        var size = node.length;\n    }\n    range.setStart(node, size);\n    range.setEnd(node, size);\n    sel.removeAllRanges();\n    sel.addRange(range);\n}\n\njSuites.editor.getDomain = function(url) {\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\n}\n\njSuites.editor.detectUrl = function(text) {\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\n    var links = text.match(expression);\n\n    if (links) {\n        if (links[0].substr(0,3) == 'www') {\n            links[0] = 'http://' + links[0];\n        }\n    }\n\n    return links;\n}\n\njSuites.editor.youtubeParser = function(url) {\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\n    var match = url.match(regExp);\n\n    return (match && match[7].length == 11) ? match[7] : false;\n}\n\njSuites.editor.getDefaultToolbar = function() { \n    return [\n        {\n            icon:'undo',\n            onclick: function() {\n                document.execCommand('undo');\n            }\n        },\n        {\n            icon:'redo',\n            onclick: function() {\n                document.execCommand('redo');\n            }\n        },\n        {\n            type:'divisor'\n        },\n        {\n            icon:'format_bold',\n            onclick: function(a,b,c) {\n                document.execCommand('bold');\n\n                if (document.queryCommandState(\"bold\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_italic',\n            onclick: function(a,b,c) {\n                document.execCommand('italic');\n\n                if (document.queryCommandState(\"italic\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_underline',\n            onclick: function(a,b,c) {\n                document.execCommand('underline');\n\n                if (document.queryCommandState(\"underline\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            type:'divisor'\n        },\n        {\n            icon:'format_list_bulleted',\n            onclick: function(a,b,c) {\n                document.execCommand('insertUnorderedList');\n\n                if (document.queryCommandState(\"insertUnorderedList\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_list_numbered',\n            onclick: function(a,b,c) {\n                document.execCommand('insertOrderedList');\n\n                if (document.queryCommandState(\"insertOrderedList\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_indent_increase',\n            onclick: function(a,b,c) {\n                document.execCommand('indent', true, null);\n\n                if (document.queryCommandState(\"indent\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_indent_decrease',\n            onclick: function(a,b,c) {\n                document.execCommand('outdent');\n\n                if (document.queryCommandState(\"outdent\")) {\n                    c.classList.add('selected');\n                } else {\n                    c.classList.remove('selected');\n                }\n            }\n        }\n        /*{\n            type:'select',\n            items: ['Verdana','Arial','Courier New'],\n            onchange: function() {\n            }\n        },\n        {\n            type:'select',\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\n            onchange: function() {\n            }\n        },\n        {\n            icon:'format_align_left',\n            onclick: function() {\n                document.execCommand('JustifyLeft');\n\n                if (document.queryCommandState(\"JustifyLeft\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_center',\n            onclick: function() {\n                document.execCommand('justifyCenter');\n\n                if (document.queryCommandState(\"justifyCenter\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_right',\n            onclick: function() {\n                document.execCommand('justifyRight');\n\n                if (document.queryCommandState(\"justifyRight\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_align_justify',\n            onclick: function() {\n                document.execCommand('justifyFull');\n\n                if (document.queryCommandState(\"justifyFull\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        },\n        {\n            icon:'format_list_bulleted',\n            onclick: function() {\n                document.execCommand('insertUnorderedList');\n\n                if (document.queryCommandState(\"insertUnorderedList\")) {\n                    this.classList.add('selected');\n                } else {\n                    this.classList.remove('selected');\n                }\n            }\n        }*/\n    ];\n}\n\r\n\r\njSuites.image = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        minWidth: false,\r\n        onchange: null,\r\n        singleFile: true,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n            imageTooSmall:'The resolution is too low, try a image with a better resolution. width > 800px',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    // Add image\r\n    obj.addImage = function(file) {\r\n        if (! file.date) {\r\n            file.date = '';\r\n        }\r\n        var img = document.createElement('img');\r\n        img.setAttribute('data-date', file.lastmodified ? file.lastmodified : file.date);\r\n        img.setAttribute('data-name', file.name);\r\n        img.setAttribute('data-size', file.size);\r\n        img.setAttribute('data-small', file.small ? file.small : '');\r\n        img.setAttribute('data-cover', file.cover ? 1 : 0);\r\n        img.setAttribute('data-extension', file.extension);\r\n        img.setAttribute('src', file.file);\r\n        img.className = 'jfile';\r\n        img.style.width = '100%';\r\n\r\n        return img;\r\n    }\r\n\r\n    // Add image\r\n    obj.addImages = function(files) {\r\n        if (obj.options.singleFile == true) {\r\n            el.innerHTML = '';\r\n        }\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            el.appendChild(obj.addImage(files[i]));\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == 'image') {\r\n            if (obj.options.singleFile == true) {\r\n                el.innerHTML = '';\r\n            }\r\n\r\n            var imageFile = new FileReader();\r\n            imageFile.addEventListener(\"load\", function (v) {\r\n\r\n                var img = new Image();\r\n\r\n                img.onload = function onload() {\r\n                    var canvas = document.createElement('canvas');\r\n                    canvas.width = img.width;\r\n                    canvas.height = img.height;\r\n\r\n                    var ctx = canvas.getContext('2d');\r\n                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                    var data = {\r\n                        file: canvas.toDataURL(),\r\n                        extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                        name: file.name,\r\n                        size: file.size,\r\n                        lastmodified: file.lastModified,\r\n                    }\r\n                    var newImage = obj.addImage(data);\r\n                    el.appendChild(newImage);\r\n\r\n                    // Onchange\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange(newImage);\r\n                    }\r\n                };\r\n\r\n                img.src = v.srcElement.result;\r\n            });\r\n\r\n            imageFile.readAsDataURL(file);\r\n        } else {\r\n            alert(text.extentionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var data = {\r\n                        file: window.URL.createObjectURL(blob),\r\n                        extension: extension\r\n                    }\r\n                    var newImage = obj.addImage(data);\r\n                    el.appendChild(newImage);\r\n\r\n                    // Keep base64 ready to go\r\n                    var content = canvas.toDataURL();\r\n                    jSuites.files[data.file] = content.substr(content.indexOf(',') + 1);\r\n\r\n                    // Onchange\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange(newImage);\r\n                    }\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    var attachmentInput = document.createElement('input');\r\n    attachmentInput.type = 'file';\r\n    attachmentInput.setAttribute('accept', 'image/*');\r\n    attachmentInput.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(attachmentInput);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.singleFile == true) {\r\n                el.innerHTML = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n/**\n * (c) jLoading\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Page loading spin\n */\n\njSuites.loading = (function() {\n    var obj = {};\n\n    var loading = document.createElement('div');\n    loading.className = 'jloading';\n\n    obj.show = function() {\n        document.body.appendChild(loading);\n    };\n\n    obj.hide = function() {\n        document.body.removeChild(loading);\n    };\n\n    return obj;\n})();\r\n\r\n/**\n * (c) jLogin\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Login helper\n */\n\njSuites.login = (function(el, options) {\n    var obj = {};\n    obj.options = {};\n\n    // Default configuration\n    var defaults = {\n        url: window.location.href,\n        prepareRequest: null,\n        accessToken: null,\n        deviceToken: null,\n        facebookUrl: null,\n        facebookAuthentication: null,\n        maxHeight: null,\n        onload: null,\n        onsuccess: null,\n        onerror: null,\n        message: null,\n        logo: null,\n        newProfile: false,\n        newProfileUrl: false,\n        newProfileLogin: false,\n        fullscreen: false,\n        newPasswordValidation: null,\n    };\n\n    // Loop through our object\n    for (var property in defaults) {\n        if (options && options.hasOwnProperty(property)) {\n            obj.options[property] = options[property];\n        } else {\n            obj.options[property] = defaults[property];\n        }\n    }\n\n    // Message console container\n    if (! obj.options.message) {\n        var messageElement = document.querySelector('.message');\n        if (messageElement) {\n            obj.options.message = messageElement;\n        }\n    }\n\n    // Action\n    var action = null;\n\n    // Container\n    var container = document.createElement('form');\n    el.appendChild(container);\n\n    // Logo\n    var divLogo = document.createElement('div');\n    divLogo.className = 'jlogin-logo'\n    container.appendChild(divLogo);\n\n    if (obj.options.logo) {\n        var logo = document.createElement('img');\n        logo.src = obj.options.logo;\n        divLogo.appendChild(logo);\n    }\n\n    // Code\n    var labelCode = document.createElement('label');\n    labelCode.innerHTML = 'Please enter here the code received';\n    var inputCode = document.createElement('input');\n    inputCode.type = 'number';\n    inputCode.id = 'code';\n    inputCode.setAttribute('maxlength', 6);\n    var divCode = document.createElement('div');\n    divCode.appendChild(labelCode);\n    divCode.appendChild(inputCode);\n\n    // Hash\n    var inputHash = document.createElement('input');\n    inputHash.type = 'hidden';\n    inputHash.name = 'h';\n    var divHash = document.createElement('div');\n    divHash.appendChild(inputHash);\n\n    // Recovery\n    var inputRecovery = document.createElement('input');\n    inputRecovery.type = 'hidden';\n    inputRecovery.name = 'recovery';\n    inputRecovery.value = '1';\n    var divRecovery = document.createElement('div');\n    divRecovery.appendChild(inputRecovery);\n\n    // Login\n    var labelLogin = document.createElement('label');\n    labelLogin.innerHTML = 'Login';\n    var inputLogin = document.createElement('input');\n    inputLogin.type = 'text';\n    inputLogin.name = 'login';\n    inputLogin.setAttribute('autocomplete', 'off');\n    inputLogin.onkeyup = function() {\n        this.value = this.value.toLowerCase().replace(/[^a-zA-Z0-9_+]+/gi, '');\n    } \n    var divLogin = document.createElement('div');\n    divLogin.appendChild(labelLogin);\n    divLogin.appendChild(inputLogin);\n\n    // Name\n    var labelName = document.createElement('label');\n    labelName.innerHTML = 'Name';\n    var inputName = document.createElement('input');\n    inputName.type = 'text';\n    inputName.name = 'name';\n    var divName = document.createElement('div');\n    divName.appendChild(labelName);\n    divName.appendChild(inputName);\n\n    // Email\n    var labelUsername = document.createElement('label');\n    labelUsername.innerHTML = 'E-mail';\n    var inputUsername = document.createElement('input');\n    inputUsername.type = 'text';\n    inputUsername.name = 'username';\n    inputUsername.setAttribute('autocomplete', 'new-username');\n    var divUsername = document.createElement('div');\n    divUsername.appendChild(labelUsername);\n    divUsername.appendChild(inputUsername);\n\n    // Password\n    var labelPassword = document.createElement('label');\n    labelPassword.innerHTML = 'New password';\n    var inputPassword = document.createElement('input');\n    inputPassword.type = 'password';\n    inputPassword.name = 'password';\n    inputPassword.setAttribute('autocomplete', 'new-password');\n    var divPassword = document.createElement('div');\n    divPassword.appendChild(labelPassword);\n    divPassword.appendChild(inputPassword);\n    divPassword.onkeydown = function(e) {\n        if (e.keyCode == 13) {\n            obj.execute();\n        }\n    }\n\n    // Repeat password\n    var labelRepeatPassword = document.createElement('label');\n    labelRepeatPassword.innerHTML = 'Repeat the new password';\n    var inputRepeatPassword = document.createElement('input');\n    inputRepeatPassword.type = 'password';\n    inputRepeatPassword.name = 'password';\n    var divRepeatPassword = document.createElement('div');\n    divRepeatPassword.appendChild(labelRepeatPassword);\n    divRepeatPassword.appendChild(inputRepeatPassword);\n\n    // Remember checkbox\n    var labelRemember = document.createElement('label');\n    labelRemember.innerHTML = 'Remember me on this device';\n    var inputRemember = document.createElement('input');\n    inputRemember.type = 'checkbox';\n    inputRemember.name = 'remember';\n    inputRemember.value = '1';\n    labelRemember.appendChild(inputRemember);\n    var divRememberButton = document.createElement('div');\n    divRememberButton.className = 'rememberButton';\n    divRememberButton.appendChild(labelRemember);\n\n    // Login button\n    var actionButton = document.createElement('input');\n    actionButton.type = 'button';\n    actionButton.value = 'Log In';\n    actionButton.onclick = function() {\n        obj.execute();\n    }\n    var divActionButton = document.createElement('div');\n    divActionButton.appendChild(actionButton);\n\n    // Cancel button\n    var cancelButton = document.createElement('div');\n    cancelButton.innerHTML = 'Cancel';\n    cancelButton.className = 'cancelButton';\n    cancelButton.onclick = function() {\n        obj.requestAccess();\n    }\n    var divCancelButton = document.createElement('div');\n    divCancelButton.appendChild(cancelButton);\n\n    // Captcha\n    var labelCaptcha = document.createElement('label');\n    labelCaptcha.innerHTML = 'Please type here the code below';\n    var inputCaptcha = document.createElement('input');\n    inputCaptcha.type = 'text';\n    inputCaptcha.name = 'captcha';\n    var imageCaptcha = document.createElement('img');\n    var divCaptcha = document.createElement('div');\n    divCaptcha.className = 'jlogin-captcha';\n    divCaptcha.appendChild(labelCaptcha);\n    divCaptcha.appendChild(inputCaptcha);\n    divCaptcha.appendChild(imageCaptcha);\n\n    // Facebook\n    var facebookButton = document.createElement('div');\n    facebookButton.innerHTML = 'Login with Facebook';\n    facebookButton.className = 'facebookButton';\n    var divFacebookButton = document.createElement('div');\n    divFacebookButton.appendChild(facebookButton);\n    divFacebookButton.onclick = function() {\n        obj.requestLoginViaFacebook();\n    }\n    // Forgot password\n    var inputRequest = document.createElement('span');\n    inputRequest.innerHTML = 'Request a new password';\n    var divRequestButton = document.createElement('div');\n    divRequestButton.className = 'requestButton';\n    divRequestButton.appendChild(inputRequest);\n    divRequestButton.onclick = function() {\n        obj.requestNewPassword();\n    }\n    // Create a new Profile\n    var inputNewProfile = document.createElement('span');\n    inputNewProfile.innerHTML = 'Create a new profile';\n    var divNewProfileButton = document.createElement('div');\n    divNewProfileButton.className = 'newProfileButton';\n    divNewProfileButton.appendChild(inputNewProfile);\n    divNewProfileButton.onclick = function() {\n        obj.newProfile();\n    }\n\n    el.className = 'jlogin';\n\n    if (obj.options.fullscreen == true) {\n        el.classList.add('jlogin-fullscreen');\n    }\n\n    /** \n     * Show message\n     */\n    obj.showMessage = function(data) {\n        var message = (typeof(data) == 'object') ? data.message : data;\n\n        if (typeof(obj.options.showMessage) == 'function') {\n            obj.options.showMessage(data);\n        } else {\n            jSuites.alert(data);\n        }\n    }\n\n    /**\n     * New profile\n     */\n    obj.newProfile = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        if (obj.options.newProfileLogin) {\n            container.appendChild(divLogin);\n        }\n        container.appendChild(divName);\n        container.appendChild(divUsername);\n        container.appendChild(divActionButton);\n        if (obj.options.facebookAuthentication == true) {\n            container.appendChild(divFacebookButton);\n        }\n        container.appendChild(divCancelButton);\n\n        // Reset inputs\n        inputLogin.value = '';\n        inputUsername.value = '';\n        inputPassword.value = '';\n\n        // Button\n        actionButton.value = 'Create new profile';\n\n        // Action\n        action = 'newProfile';\n    }\n\n    /**\n     * Request the email with the recovery instructions\n     */\n    obj.requestNewPassword = function() {\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n            var captcha = true;\n        }\n\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divRecovery);\n        container.appendChild(divUsername);\n        if (captcha) {\n            container.appendChild(divCaptcha);\n        }\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Request a new password';\n        inputRecovery.value = 1;\n\n        // Action\n        action = 'requestNewPassword';\n    }\n\n    /**\n     * Confirm recovery code\n     */\n    obj.codeConfirmation = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divHash);\n        container.appendChild(divCode);\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Confirm code';\n        inputRecovery.value = 2;\n\n        // Action\n        action = 'codeConfirmation';\n    }\n\n    /**\n     * Update my password\n     */\n    obj.changeMyPassword = function(hash) {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divHash);\n        container.appendChild(divPassword);\n        container.appendChild(divRepeatPassword);\n        container.appendChild(divActionButton);\n        container.appendChild(divCancelButton);\n        actionButton.value = 'Change my password';\n        inputHash.value = hash;\n\n        // Action\n        action = 'changeMyPassword';\n    }\n\n    /**\n     * Request access default method\n     */\n    obj.requestAccess = function() {\n        container.innerHTML = '';\n        container.appendChild(divLogo);\n        container.appendChild(divUsername);\n        container.appendChild(divPassword);\n        container.appendChild(divActionButton);\n        if (obj.options.facebookAuthentication == true) {\n            container.appendChild(divFacebookButton);\n        }\n        container.appendChild(divRequestButton);\n        container.appendChild(divRememberButton);\n        container.appendChild(divRequestButton);\n        if (obj.options.newProfile == true) {\n            container.appendChild(divNewProfileButton);\n        }\n\n        // Button\n        actionButton.value = 'Login';\n\n        // Password\n        inputPassword.value = '';\n\n        // Email persistence\n        if (window.localStorage.getItem('username')) {\n            inputUsername.value = window.localStorage.getItem('username');\n            inputPassword.focus();\n        } else {\n            inputUsername.focus();\n        }\n\n        // Action\n        action = 'requestAccess';\n    }\n\n    /**\n     * Request login via facebook\n     */\n    obj.requestLoginViaFacebook = function() {\n        if (typeof(deviceNotificationToken) == 'undefined') {\n            FB.getLoginStatus(function(response) {\n                if (! response.status || response.status != 'connected') {\n                    FB.login(function(response) {\n                        if (response.authResponse) {\n                            obj.execute({ f:response.authResponse.accessToken });\n                        } else {\n                            obj.showMessage('Not authorized by facebook');\n                        }\n                    }, {scope: 'public_profile,email'});\n                } else {\n                    obj.execute({ f:response.authResponse.accessToken });\n                }\n            }, true);\n        } else {\n            jDestroy = function() {\n                fbLogin.removeEventListener('loadstart', jStart);\n                fbLogin.removeEventListener('loaderror', jError);\n                fbLogin.removeEventListener('exit', jExit);\n                fbLogin.close();\n                fbLogin = null;\n            }\n\n            jStart = function(event) {\n                var url = event.url;\n                if (url.indexOf(\"access_token\") >= 0) {\n                    setTimeout(function(){\n                        var u = url.match(/=(.*?)&/);\n                        if (u[1].length > 32) {\n                            obj.execute({ f:u[1] });\n                        }\n                        jDestroy();\n                   },500);\n                }\n\n                if (url.indexOf(\"error=access_denied\") >= 0) {\n                   setTimeout(jDestroy ,500);\n                   // Not authorized by facebook\n                   obj.showMessage('Not authorized by facebook');\n                }\n            }\n\n            jError = function(event) {\n                jDestroy();\n            }\n        \n            jExit = function(event) {\n                jDestroy();\n            }\n\n            fbLogin = window.open(obj.options.facebookUrl, \"_blank\", \"location=no,closebuttoncaption=Exit,disallowoverscroll=yes,toolbar=no\");\n            fbLogin.addEventListener('loadstart', jStart);\n            fbLogin.addEventListener('loaderror', jError);\n            fbLogin.addEventListener('exit', jExit);\n        }\n\n        // Action\n        action = 'requestLoginViaFacebook';\n    }\n\n    // Perform request\n    obj.execute = function(data) {\n        // New profile\n        if (action == 'newProfile') {\n            var pattern = new RegExp(/^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/);\n            if (! inputUsername.value || ! pattern.test(inputUsername.value)) {\n                var message = 'Invalid e-mail address'; \n            }\n\n            var pattern = new RegExp(/^[a-zA-Z0-9\\_\\-\\.\\s+]+$/);\n            if (! inputLogin.value || ! pattern.test(inputLogin.value)) {\n                var message = 'Invalid username, please use only characters and numbers';\n            }\n\n            if (message) {\n                obj.showMessage(message);\n                return false;\n            }\n        } else if (action == 'changeMyPassword') {\r\n            if (inputPassword.value.length < 3) {\r\n                var message = 'Password is too short';\r\n            } else  if (inputPassword.value != inputRepeatPassword.value) {\r\n                var message = 'Password should match';\r\n            } else {\r\n                if (typeof(obj.options.newPasswordValidation) == 'function') {\r\n                    var val = obj.options.newPasswordValidation(obj, inputPassword.value, inputPassword.value);\r\n                    if (val != undefined) {\r\n                        message = val;\r\n                    }\r\n                }\r\n            }\n\n            if (message) {\r\n                obj.showMessage(message);\r\n                return false;\r\n            }\r\n        }\n\n        // Keep email\n        if (inputUsername.value != '') {\n            window.localStorage.setItem('username', inputUsername.value);\n        }\n\n        // Captcha\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n            if (inputCaptcha.value == '') {\n                obj.showMessage('Please enter the captch code below');\n                return false;\n            }\n        }\n\n        // Url\n        var url = obj.options.url;\n\n        // Device token\n        if (obj.options.deviceToken) {\n            url += '?token=' + obj.options.deviceToken;\n        }\n\n        // Callback\n        var onsuccess = function(result) {\n            if (result) {\n                // Successfully response\n                if (result.success == 1) {\n                    // Recovery process\n                    if (action == 'requestNewPassword') {\n                        obj.codeConfirmation();\n                    } else if (action == 'codeConfirmation') {\n                        obj.requestAccess();\n                    } else if (action == 'newProfile') {\n                        obj.requestAccess();\n                        // New profile\n                        result.newProfile = true;\n                    }\n\n                    // Token\n                    if (result.token) {\n                        // Set token\n                        obj.options.accessToken = result.token;\n                        // Save token\n                        window.localStorage.setItem('Access-Token', result.token);\n                    }\n                }\n\n                // Show message\n                if (result.message) {\n                    // Show message\n                    obj.showMessage(result.message)\n                }\n\n                // Request captcha code\n                if (! result.data) {\n                    if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\n                        divCaptcha.remove();\n                    }\n                } else {\n                    container.insertBefore(divCaptcha, divActionButton);\n                    imageCaptcha.setAttribute('src', 'data:image/png;base64,' + result.data);\n                }\n\n                // Give time to user see the message\n                if (result.hash) {\n                    // Change password\n                    obj.changeMyPassword(result.hash);\n                } else if (result.url) {\n                    // App initialization\n                    if (result.success == 1) {\n                        if (typeof(obj.options.onsuccess) == 'function') {\n                            obj.options.onsuccess(result);\n                        } else {\n                            if (result.message) {\n                                setTimeout(function() { window.location.href = result.url; }, 2000);\n                            } else {\n                                window.location.href = result.url;\n                            }\n                        }\n                    } else {\n                        if (typeof(obj.options.onerror) == 'function') {\n                            obj.options.onerror(result);\n                        }\n                    }\n                }\n            }\n        }\n\n        // Password\n        if (! data) {\n            var data = jSuites.getFormElements(el);\n            // Encode passworfd\n            if (data.password) {\n                data.password = jSuites.login.sha512(data.password);\n            }\n            // Recovery code\n            if (Array.prototype.indexOf.call(container.children, divCode) >= 0 && inputCode.value) {\n                data.h = jSuites.login.sha512(inputCode.value);\n            }\n        }\n\n        // Loading\n        el.classList.add('jlogin-loading');\n\n        // Url\n        var url = (action == 'newProfile' && obj.options.newProfileUrl) ? obj.options.newProfileUrl : obj.options.url;\n\n        // Remote call\n        jSuites.ajax({\n            url: url,\n            method: 'POST',\n            dataType: 'json',\n            data: data,\n            success: function(result) {\n                // Remove loading\n                el.classList.remove('jlogin-loading');\n                // Callback\n                onsuccess(result);\n            },\n            error: function(result) {\n                // Error\n                el.classList.remove('jlogin-loading');\n\n                if (typeof(obj.options.onerror) == 'function') {\n                    obj.options.onerror(result);\n                }\n            }\n        });\n    }\n\n    var queryString = window.location.href.split('?');\r\n    if (queryString[1] && queryString[1].length == 130 && queryString[1].substr(0,2) == 'h=') {\r\n        obj.changeMyPassword(queryString[1].substr(2));\r\n    } else {\n        obj.requestAccess();\n    }\n\n    return obj;\n});\n\njSuites.login.sha512 = (function(str) {\n    function int64(msint_32, lsint_32) {\n        this.highOrder = msint_32;\n        this.lowOrder = lsint_32;\n    }\n\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\n\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\n\n    var W = new Array(64);\n    var a, b, c, d, e, f, g, h, i, j;\n    var T1, T2;\n    var charsize = 8;\n\n    function utf8_encode(str) {\n        return unescape(encodeURIComponent(str));\n    }\n\n    function str2binb(str) {\n        var bin = [];\n        var mask = (1 << charsize) - 1;\n        var len = str.length * charsize;\n    \n        for (var i = 0; i < len; i += charsize) {\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\n        }\n    \n        return bin;\n    }\n\n    function binb2hex(binarray) {\n        var hex_tab = \"0123456789abcdef\";\n        var str = \"\";\n        var length = binarray.length * 4;\n        var srcByte;\n\n        for (var i = 0; i < length; i += 1) {\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\n        }\n\n        return str;\n    }\n\n    function safe_add_2(x, y) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function safe_add_4(a, b, c, d) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function safe_add_5(a, b, c, d, e) {\n        var lsw, msw, lowOrder, highOrder;\n\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\n\n        return new int64(highOrder, lowOrder);\n    }\n\n    function maj(x, y, z) {\n        return new int64(\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\n        );\n    }\n\n    function ch(x, y, z) {\n        return new int64(\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\n        );\n    }\n\n    function rotr(x, n) {\n        if (n <= 32) {\n            return new int64(\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\n            );\n        } else {\n            return new int64(\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\n            );\n        }\n    }\n\n    function sigma0(x) {\n        var rotr28 = rotr(x, 28);\n        var rotr34 = rotr(x, 34);\n        var rotr39 = rotr(x, 39);\n\n        return new int64(\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\n        );\n    }\n\n    function sigma1(x) {\n        var rotr14 = rotr(x, 14);\n        var rotr18 = rotr(x, 18);\n        var rotr41 = rotr(x, 41);\n\n        return new int64(\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\n        );\n    }\n\n    function gamma0(x) {\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\n\n        return new int64(\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\n        );\n    }\n\n    function gamma1(x) {\n        var rotr19 = rotr(x, 19);\n        var rotr61 = rotr(x, 61);\n        var shr6 = shr(x, 6);\n\n        return new int64(\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\n        );\n    }\n\n    function shr(x, n) {\n        if (n <= 32) {\n            return new int64(\n                x.highOrder >>> n,\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\n            );\n        } else {\n            return new int64(\n                0,\n                x.highOrder << (32 - n)\n            );\n        }\n    }\n\n    var str = utf8_encode(str);\n    var strlen = str.length*charsize;\n    str = str2binb(str);\n\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\n\n    for (var i = 0; i < str.length; i += 32) {\n        a = H[0];\n        b = H[1];\n        c = H[2];\n        d = H[3];\n        e = H[4];\n        f = H[5];\n        g = H[6];\n        h = H[7];\n\n        for (var j = 0; j < 80; j++) {\n            if (j < 16) {\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\n            } else {\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\n            }\n\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\n            h = g;\n            g = f;\n            f = e;\n            e = safe_add_2(d, T1);\n            d = c;\n            c = b;\n            b = a;\n            a = safe_add_2(T1, T2);\n        }\n\n        H[0] = safe_add_2(a, H[0]);\n        H[1] = safe_add_2(b, H[1]);\n        H[2] = safe_add_2(c, H[2]);\n        H[3] = safe_add_2(d, H[3]);\n        H[4] = safe_add_2(e, H[4]);\n        H[5] = safe_add_2(f, H[5]);\n        H[6] = safe_add_2(g, H[6]);\n        H[7] = safe_add_2(h, H[7]);\n    }\n\n    var binarray = [];\n    for (var i = 0; i < H.length; i++) {\n        binarray.push(H[i].highOrder);\n        binarray.push(H[i].lowOrder);\n    }\n\n    return binb2hex(binarray);\n});\r\n\r\n/**\r\n * (c) jTools Input Mask\r\n * https://github.com/paulhodel/jtools\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Input mask\r\n */\r\n\r\njSuites.mask = (function() {\r\n    var obj = {};\r\n    var index = 0;\r\n    var values = []\r\n    var pieces = [];\r\n\r\n    obj.run = function(value, mask, decimal) {\r\n        if (value && mask) {\r\n            if (! decimal) {\r\n                decimal = '.';\r\n            }\r\n            if (value == Number(value)) {\r\n                var number = (''+value).split('.');\r\n                var value = number[0];\r\n                var valueDecimal = number[1];\r\n            } else {\r\n                value = '' + value;\r\n            }\r\n            index = 0;\r\n            values = [];\r\n            // Create mask token\r\n            obj.prepare(mask);\r\n            // Current value\r\n            var currentValue = value;\r\n            if (currentValue) {\r\n                // Checking current value\r\n                for (var i = 0; i < currentValue.length; i++) {\r\n                    if (currentValue[i] != null) {\r\n                        obj.process(currentValue[i]);\r\n                    }\r\n                }\r\n            }\r\n            if (valueDecimal) {\r\n                obj.process(decimal);\r\n                var currentValue = valueDecimal;\r\n                if (currentValue) {\r\n                    // Checking current value\r\n                    for (var i = 0; i < currentValue.length; i++) {\r\n                        if (currentValue[i] != null) {\r\n                            obj.process(currentValue[i]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Formatted value\r\n            return values.join('');\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n\r\n    obj.apply = function(e) {\r\n        if (e.target && ! e.target.getAttribute('readonly')) {\r\n            var mask = e.target.getAttribute('data-mask');\r\n            if (mask && e.keyCode > 46) {\r\n                index = 0;\r\n                values = [];\r\n                // Create mask token\r\n                obj.prepare(mask);\r\n                // Current value\r\n                if (e.target.selectionStart < e.target.selectionEnd) {\r\n                    var currentValue = e.target.value.substring(0, e.target.selectionStart); \r\n                } else {\r\n                    var currentValue = e.target.value;\r\n                }\r\n                if (currentValue) {\r\n                    // Checking current value\r\n                    for (var i = 0; i < currentValue.length; i++) {\r\n                        if (currentValue[i] != null) {\r\n                            obj.process(currentValue[i]);\r\n                        }\r\n                    }\r\n                }\r\n                // New input\r\n                obj.process(obj.fromKeyCode(e));\r\n                // Update value to the element\r\n                e.target.value = values.join('');\r\n                if (pieces.length == values.length && pieces[pieces.length-1].length == values[values.length-1].length) {\r\n                    e.target.setAttribute('data-completed', 'true');\r\n                } else {\r\n                    e.target.setAttribute('data-completed', 'false');\r\n                }\r\n                // Prevent default\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Process inputs and save to values\r\n     */\r\n    obj.process = function(input) {\r\n        do {\r\n            if (pieces[index] == 'mm') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 1 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 1 && values[index] < 2 && parseInt(input) < 3) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] == 0 && values[index] < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'dd') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 3 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 3 && parseInt(input) < 2) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 3 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'hh24') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 2 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 2 && parseInt(input) < 4) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 2 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'hh') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 1 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (values[index] == 1 && parseInt(input) < 3) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (values[index] < 1 && parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                    } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'mi' || pieces[index] == 'ss') {\r\n                if (values[index] == null || values[index] == '') {\r\n                    if (parseInt(input) > 5 && parseInt(input) < 10) {\r\n                        values[index] = '0' + input;\r\n                        index++;\r\n                        return true;\r\n                    } else if (parseInt(input) < 10) {\r\n                        values[index] = input;\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    if (parseInt(input) < 10) {\r\n                        values[index] += input;\r\n                        index++;\r\n                        return true;\r\n                     } else {\r\n                        return false\r\n                    }\r\n                }\r\n            } else if (pieces[index] == 'yy' || pieces[index] == 'yyyy') {\r\n                if (parseInt(input) < 10) {\r\n                    if (values[index] == null || values[index] == '') {\r\n                        values[index] = input;\r\n                    } else {\r\n                        values[index] += input;\r\n                    }\r\n                    \r\n                    if (values[index].length == pieces[index].length) {\r\n                        index++;\r\n                    }\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == '#' || pieces[index] == '#.##' || pieces[index] == '#,##' || pieces[index] == '# ##') {\r\n                if (input.match(/[0-9]/g)) {\r\n                    if (pieces[index] == '#.##') {\r\n                        var separator = '.';\r\n                    } else if (pieces[index] == '#,##') {\r\n                        var separator = ',';\r\n                    } else if (pieces[index] == '# ##') {\r\n                        var separator = ' ';\r\n                    } else {\r\n                        var separator = '';\r\n                    }\r\n                    if (values[index] == null || values[index] == '') {\r\n                        values[index] = input;\r\n                    } else {\r\n                        values[index] += input;\r\n                        if (separator) {\r\n                            values[index] = values[index].match(/[0-9]/g).join('');\r\n                            var t = [];\r\n                            var s = 0;\r\n                            for (var j = values[index].length - 1; j >= 0 ; j--) {\r\n                                t.push(values[index][j]);\r\n                                s++;\r\n                                if (! (s % 3)) {\r\n                                    t.push(separator);\r\n                                }\r\n                            }\r\n                            t = t.reverse();\r\n                            values[index] = t.join('');\r\n                            if (values[index].substr(0,1) == separator) {\r\n                                values[index] = values[index].substr(1);\r\n                            } \r\n                        }\r\n                    }\r\n                    return true;\r\n                } else {\r\n                    if (pieces[index] == '#.##' && input == '.') {\r\n                        // Do nothing\r\n                    } else if (pieces[index] == '#,##' && input == ',') {\r\n                        // Do nothing\r\n                    } else if (pieces[index] == '# ##' && input == ' ') {\r\n                        // Do nothing\r\n                    } else {\r\n                        if (values[index]) {\r\n                            index++;\r\n                            if (pieces[index]) {\r\n                                if (pieces[index] == input) {\r\n                                    values[index] = input;\r\n                                    return true;\r\n                                } else {\r\n                                    if (pieces[index] == '0' && pieces[index+1] == input) {\r\n                                        index++;\r\n                                        values[index] = input;\r\n                                        return true;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == '0') {\r\n                if (input.match(/[0-9]/g)) {\r\n                    values[index] = input;\r\n                    index++;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else if (pieces[index] == 'a') {\r\n                if (input.match(/[a-zA-Z]/g)) {\r\n                    values[index] = input;\r\n                    index++;\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (pieces[index] != null) {\r\n                    if (pieces[index] == '\\\\a') {\r\n                        var v = 'a';\r\n                    } else if (pieces[index] == '\\\\0') {\r\n                        var v = '0';\r\n                    } else if (pieces[index] == '[-]') {\r\n                        if (input == '-' || input == '+') {\r\n                            var v = input;\r\n                        } else {\r\n                            var v = ' ';\r\n                        }\r\n                    } else {\r\n                        var v = pieces[index];\r\n                    }\r\n                    values[index] = v;\r\n                    if (input == v) {\r\n                        index++;\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            index++;\r\n        } while (pieces[index]);\r\n    }\r\n\r\n    /**\r\n     * Create tokens for the mask\r\n     */\r\n    obj.prepare = function(mask) {\r\n        pieces = [];\r\n        for (var i = 0; i < mask.length; i++) {\r\n            if (mask[i].match(/[0-9]|[a-z]|\\\\/g)) {\r\n                if (mask[i] == 'y' && mask[i+1] == 'y' && mask[i+2] == 'y' && mask[i+3] == 'y') {\r\n                    pieces.push('yyyy');\r\n                    i += 3;\r\n                } else if (mask[i] == 'y' && mask[i+1] == 'y') {\r\n                    pieces.push('yy');\r\n                    i++;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm' && mask[i+2] == 'm' && mask[i+3] == 'm') {\r\n                    pieces.push('mmmm');\r\n                    i += 3;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm' && mask[i+2] == 'm') {\r\n                    pieces.push('mmm');\r\n                    i += 2;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'm') {\r\n                    pieces.push('mm');\r\n                    i++;\r\n                } else if (mask[i] == 'd' && mask[i+1] == 'd') {\r\n                    pieces.push('dd');\r\n                    i++;\r\n                } else if (mask[i] == 'h' && mask[i+1] == 'h' && mask[i+2] == '2' && mask[i+3] == '4') {\r\n                    pieces.push('hh24');\r\n                    i += 3;\r\n                } else if (mask[i] == 'h' && mask[i+1] == 'h') {\r\n                    pieces.push('hh');\r\n                    i++;\r\n                } else if (mask[i] == 'm' && mask[i+1] == 'i') {\r\n                    pieces.push('mi');\r\n                    i++;\r\n                } else if (mask[i] == 's' && mask[i+1] == 's') {\r\n                    pieces.push('ss');\r\n                    i++;\r\n                } else if (mask[i] == 'a' && mask[i+1] == 'm') {\r\n                    pieces.push('am');\r\n                    i++;\r\n                } else if (mask[i] == 'p' && mask[i+1] == 'm') {\r\n                    pieces.push('pm');\r\n                    i++;\r\n                } else if (mask[i] == '\\\\' && mask[i+1] == '0') {\r\n                    pieces.push('\\\\0');\r\n                    i++;\r\n                } else if (mask[i] == '\\\\' && mask[i+1] == 'a') {\r\n                    pieces.push('\\\\a');\r\n                    i++;\r\n                } else {\r\n                    pieces.push(mask[i]);\r\n                }\r\n            } else {\r\n                if (mask[i] == '#' && mask[i+1] == '.' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('#.##');\r\n                    i += 3;\r\n                } else if (mask[i] == '#' && mask[i+1] == ',' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('#,##');\r\n                    i += 3;\r\n                } else if (mask[i] == '#' && mask[i+1] == ' ' && mask[i+2] == '#' && mask[i+3] == '#') {\r\n                    pieces.push('# ##');\r\n                    i += 3;\r\n                } else if (mask[i] == '[' && mask[i+1] == '-' && mask[i+2] == ']') {\r\n                    pieces.push('[-]');\r\n                    i += 2;\r\n                } else {\r\n                    pieces.push(mask[i]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** \r\n     * Thanks for the collaboration\r\n     */\r\n    obj.fromKeyCode = function(e) {\r\n        var _to_ascii = {\r\n            '188': '44',\r\n            '109': '45',\r\n            '190': '46',\r\n            '191': '47',\r\n            '192': '96',\r\n            '220': '92',\r\n            '222': '39',\r\n            '221': '93',\r\n            '219': '91',\r\n            '173': '45',\r\n            '187': '61', //IE Key codes\r\n            '186': '59', //IE Key codes\r\n            '189': '45'  //IE Key codes\r\n        }\r\n\r\n        var shiftUps = {\r\n            \"96\": \"~\",\r\n            \"49\": \"!\",\r\n            \"50\": \"@\",\r\n            \"51\": \"#\",\r\n            \"52\": \"$\",\r\n            \"53\": \"%\",\r\n            \"54\": \"^\",\r\n            \"55\": \"&\",\r\n            \"56\": \"*\",\r\n            \"57\": \"(\",\r\n            \"48\": \")\",\r\n            \"45\": \"_\",\r\n            \"61\": \"+\",\r\n            \"91\": \"{\",\r\n            \"93\": \"}\",\r\n            \"92\": \"|\",\r\n            \"59\": \":\",\r\n            \"39\": \"\\\"\",\r\n            \"44\": \"<\",\r\n            \"46\": \">\",\r\n            \"47\": \"?\"\r\n        };\r\n\r\n        var c = e.which;\r\n\r\n        if (_to_ascii.hasOwnProperty(c)) {\r\n            c = _to_ascii[c];\r\n        }\r\n\r\n        if (!e.shiftKey && (c >= 65 && c <= 90)) {\r\n            c = String.fromCharCode(c + 32);\r\n        } else if (e.shiftKey && shiftUps.hasOwnProperty(c)) {\r\n            c = shiftUps[c];\r\n        } else if (96 <= c && c <= 105) {\r\n            c = String.fromCharCode(c - 48);\r\n        } else {\r\n            c = String.fromCharCode(c);\r\n        }\r\n\r\n        return c;\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mobile = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    if (jSuites.el) {\r\n        jSuites.el.addEventListener('mousedown', function(e) {\r\n            if (e.target.classList.contains('option-title')) {\r\n                if (e.target.classList.contains('selected')) {\r\n                    e.target.classList.remove('selected');\r\n                } else {\r\n                    e.target.classList.add('selected');\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.pages = (function() {\r\n    var container = null;\r\n    var current = null;\r\n\r\n    // Create a page\r\n    var createPage = function(options, callback) {\r\n        // Create page\r\n        var page = document.createElement('div');\r\n        page.classList.add('page');\r\n\r\n        // Always hidden\r\n        page.style.display = 'none';\r\n\r\n        // Keep options\r\n        page.options = options ? options : {};\r\n\r\n        if (! current) {\r\n            container.appendChild(page);\r\n        } else {\r\n            container.insertBefore(page, current.nextSibling);\r\n        }\r\n\r\n        jSuites.ajax({\r\n            url: page.options.url,\r\n            method: 'GET',\r\n            success: function(result) {\r\n                // Push to refresh controls\r\n                jSuites.refresh(page, page.options.onpush);\r\n\n                // Open page\r\n                page.innerHTML = result;\r\n                // Get javascript\r\n                var script = page.getElementsByTagName('script');\r\n                // Run possible inline scripts\r\n                for (var i = 0; i < script.length; i++) {\r\n                    // Get type\r\n                    var type = script[i].getAttribute('type');\r\n                    if (! type || type == 'text/javascript') {\r\n                        eval(script[i].innerHTML);\r\n                    }\r\n                }\r\n                // Set title\r\n                page.setTitle = function(text) {\r\n                    this.children[0].children[0].children[1].innerHTML = text;\r\n                }\r\n                // Show page\r\n                if (! page.options.closed) {\r\n                    showPage(page);\r\n                }\r\n                // Onload callback\r\n                if (typeof(page.options.onload) == 'function') {\r\n                    page.options.onload(page);\r\n                }\r\n                // Force callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(page);\r\n                }\r\n            }\r\n        });\r\n\r\n        return page;\r\n    }\r\n\r\n    var showPage = function(page, ignoreHistory, callback) {\r\n        if (current) {\r\n            if (current == page) {\r\n                current = page;\r\n            } else {\r\n                // Keep scroll in the top\r\n                window.scrollTo({ top: 0 });\r\n\r\n                // Show page\r\n                page.style.display = '';\r\n\r\n                var a = Array.prototype.indexOf.call(container.children, current);\r\n                var b = Array.prototype.indexOf.call(container.children, page);\r\n\r\n                // Leave\r\n                if (typeof(current.options.onleave) == 'function') {\r\n                    current.options.onleave(current, page, ignoreHistory);\r\n                }\r\n\r\n                jSuites.slideLeft(container, (a < b ? 0 : 1), function() {\r\n                    current.style.display = 'none';\r\n                    current = page;\r\n                });\r\n\r\n                // Enter\r\n                if (typeof(page.options.onenter) == 'function') {\r\n                    page.options.onenter(page, current, ignoreHistory);\r\n                }\r\n            }\r\n        } else {\r\n            // Show\r\n            page.style.display = '';\r\n\r\n            // Keep current\r\n            current = page;\r\n\r\n            // Enter\r\n            if (typeof(page.options.onenter) == 'function') {\r\n                page.options.onenter(page);\r\n            }\r\n        }\r\n\r\n        // Add history\r\n        if (! ignoreHistory) {\r\n            // Add history\r\n            window.history.pushState({ route: page.options.route }, page.options.title, page.options.route);\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(callback) == 'function') {\r\n            callback(page);\r\n        }\r\n    }\r\n\r\n    // Init method\r\n    var obj = function(route, mixed) {\r\n\r\n        // Create page container\r\n        if (! container) {\r\n            container = document.querySelector('.pages');\r\n            if (! container) {\r\n                container = document.createElement('div');\r\n                container.className = 'pages';\r\n            }\r\n\r\n            // Append container to the application\r\n            if (jSuites.el) {\r\n                jSuites.el.appendChild(container);\r\n            } else {\r\n                document.body.appendChild(container);\r\n            }\r\n        }\r\n\r\n        if (! obj.pages[route]) {\r\n            if (! route) {\r\n                alert('Error, no route provided');\r\n            } else {\r\n                if (typeof(mixed) == 'function') {\r\n                    var options = {};\r\n                    var callback = mixed;\r\n                } else {\r\n                    // Page options\r\n                    var options = mixed ? mixed : {};\r\n                }\r\n\r\n                // Closed\r\n                options.closed = mixed && mixed.closed ? 1 : 0;\r\n                // Keep Route\r\n                options.route = route;\r\n\r\n                // New page url\r\n                if (! options.url) {\r\n                    var routePath = route.split('#');\r\n                    options.url = jSuites.pages.path + routePath[0] + '.html';\r\n                }\r\n                // Title\r\n                if (! options.title) {\r\n                    options.title = 'Untitled';\r\n                }\r\n\r\n                // Create new page\r\n                obj.pages[route] = createPage(options, callback ? callback : null);\r\n            }\r\n        } else {\r\n            // Update config\r\n            if (mixed) {\r\n                // History\r\n                var ignoreHistory = 0;\r\n\r\n                if (typeof(mixed) == 'function') {\r\n                    var callback = mixed;\r\n                } else {\r\n                    if (typeof(mixed.onenter) == 'function') {\r\n                        obj.pages[route].options.onenter = mixed.onenter;\r\n                    }\r\n                    if (typeof(mixed.onleave) == 'function') {\r\n                        obj.pages[route].options.onleave = mixed.onleave;\r\n                    }\r\n\r\n                    // Ignore history\r\n                    ignoreHistory = mixed.ignoreHistory ? 1 : 0; \r\n                }\r\n            }\r\n\r\n            showPage(obj.pages[route], ignoreHistory, callback ? callback : null);\r\n        }\r\n    }\r\n\r\n    obj.pages = {};\r\n\r\n    // Get page\r\n    obj.get = function(route) {\r\n        if (obj.pages[route]) {\r\n            return obj.pages[route]; \r\n        }\r\n    }\r\n\r\n    obj.getContainer = function() {\r\n        return container;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        // Current is null\r\n        current = null;\r\n        // Destroy containers\r\n        obj.pages = {};\r\n        // Reset container\r\n        if (container) {\r\n            container.innerHTML = '';\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\n// Path\r\njSuites.pages.path = 'pages';\r\n\r\n// Panel\r\njSuites.panel = (function() {\r\n    // No initial panel declared\r\n    var panel = null;\r\n\r\n    var obj = function(route) {\r\n        if (! panel) {\r\n            obj.create(jSuites.pages.path + route + '.html');\r\n        }\r\n\r\n        // Show panel\r\n        panel.style.display = '';\r\n\r\n        // Add animation\r\n        if (panel.classList.contains('panel-left')) {\r\n            jSuites.slideLeft(panel, 1);\r\n        } else {\r\n            jSuites.slideRight(panel, 1);\r\n        }\r\n    }\r\n\r\n    obj.create = function(route) {\r\n        if (! panel) {\r\n            // Create element\r\n            panel = document.createElement('div');\r\n            panel.classList.add('panel');\r\n            panel.classList.add('panel-left');\r\n            panel.style.display = 'none';\r\n\r\n            // Bind to the app\r\n            if (jSuites.el) {\r\n                jSuites.el.appendChild(panel);\r\n            } else {\r\n                document.body.appendChild(panel);\r\n            }\r\n        }\r\n\r\n        // Remote content\r\n        if (route) {\r\n\t        var url = jSuites.pages.path + route + '.html';\r\n\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                success: function(result) {\r\n                    // Set content\r\n                    panel.innerHTML = result;\r\n                    // Get javascript\r\n                    var script = panel.getElementsByTagName('script');\r\n                    // Run possible inline scripts\r\n                    for (var i = 0; i < script.length; i++) {\r\n                        // Get type\r\n                        var type = script[i].getAttribute('type');\r\n                        if (! type || type == 'text/javascript') {\r\n                            eval(script[i].innerHTML);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (panel) {\r\n            // Animation\r\n            if (panel.classList.contains('panel-left')) {\r\n                jSuites.slideLeft(panel, 0, function() {\r\n                    panel.style.display = 'none';\r\n                });\r\n            } else {\r\n                jSuites.slideRight(panel, 0, function() {\r\n                    panel.style.display = 'none';\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.get = function() {\r\n        return panel;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        panel.remove();\r\n        panel = null;\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = options;\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            elements[i].classList.remove('selected');\r\n        }\r\n        element.classList.add('selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.slideBottom(toolbar, 0, function() {\r\n            toolbar.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        toolbar.style.display = '';\r\n        jSuites.slideBottom(toolbar, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return toolbar;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        toolbar = null;\r\n    }\r\n\r\n    var toolbar = document.createElement('div');\r\n    toolbar.classList.add('jtoolbar');\r\n    toolbar.onclick = function(e) {\r\n        var element = jSuites.getElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n    }\r\n\r\n    var toolbarContent = document.createElement('div');\r\n    toolbar.appendChild(toolbarContent);\r\n\r\n    for (var i = 0; i < options.items.length; i++) {\r\n        var toolbarItem = document.createElement('div');\r\n        toolbarItem.classList.add('jtoolbar-item');\r\n        if (options.items[i].route) {\r\n            toolbarItem.setAttribute('data-href', options.items[i].route);\r\n            jSuites.pages(options.items[i].route, {\r\n                closed: true,\r\n                onenter: function() {\r\n                    obj.selectItem(toolbarItem);\r\n                }\r\n            });\r\n        }\r\n\r\n        if (options.items[i].icon) {\r\n            var toolbarIcon = document.createElement('i');\r\n            toolbarIcon.classList.add('material-icons');\r\n            toolbarIcon.innerHTML = options.items[i].icon;\r\n            toolbarItem.appendChild(toolbarIcon);\r\n        }\r\n\r\n        var toolbarBadge = document.createElement('div');\r\n        toolbarBadge.classList.add('jbadge');\r\n        var toolbarBadgeContent = document.createElement('div');\r\n        toolbarBadgeContent.innerHTML = options.items[i].badge ? options.items[i].badge : '';\r\n        toolbarBadge.appendChild(toolbarBadgeContent);\r\n        toolbarItem.appendChild(toolbarBadge);\r\n\r\n        if (options.items[i].title) {\r\n            var toolbarTitle = document.createElement('span');\r\n            toolbarTitle.innerHTML = options.items[i].title;\r\n            toolbarItem.appendChild(toolbarTitle);\r\n        }\r\n\r\n        toolbarContent.appendChild(toolbarItem);\r\n    }\r\n\r\n    el.toolbar = obj;\r\n\r\n    el.appendChild(toolbar);\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.actionsheet = (function() {\r\n    var actionsheet = document.createElement('div');\r\n    actionsheet.className = 'jactionsheet';\r\n    actionsheet.style.display = 'none';\r\n\r\n    var actionContent = document.createElement('div');\r\n    actionContent.className = 'jactionsheet-content';\r\n    actionsheet.appendChild(actionContent);\r\n\r\n    var obj = function(options) {\r\n        if (options) {\r\n            obj.options = options;\r\n        }\r\n\r\n        // Reset container\r\n        actionContent.innerHTML = '';\r\n\r\n        // Create new elements\r\n        for (var i = 0; i < obj.options.length; i++) {\r\n            var actionGroup = document.createElement('div');\r\n            actionGroup.className = 'jactionsheet-group';\r\n\r\n            for (var j = 0; j < obj.options[i].length; j++) {\r\n                var v = obj.options[i][j];\r\n                var actionItem = document.createElement('div');\r\n                var actionInput = document.createElement('input');\r\n                actionInput.type = 'button';\r\n                actionInput.value = v.title;\r\n                if (v.className) {\r\n                    actionInput.className = v.className; \r\n                }\r\n                if (v.onclick) {\r\n                    actionInput.onclick = v.onclick; \r\n                }\r\n                if (v.action == 'cancel') {\r\n                    actionInput.style.color = 'red';\r\n                }\r\n                actionItem.appendChild(actionInput);\r\n                actionGroup.appendChild(actionItem);\r\n            }\r\n\r\n            actionContent.appendChild(actionGroup);\r\n        }\r\n\r\n        // Show\r\n        actionsheet.style.display = '';\r\n\r\n        // Append\r\n        jSuites.el.appendChild(actionsheet);\r\n\r\n        // Animation\r\n        jSuites.slideBottom(actionContent, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (actionsheet.style.display != 'none') {\r\n            // Remove any existing actionsheet\r\n            jSuites.slideBottom(actionContent, false, function() {\r\n                actionsheet.remove();\r\n                actionsheet.style.display = 'none';\r\n            });\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        obj.close();\r\n    }\r\n\r\n    actionsheet.addEventListener('mouseup', mouseUp);\r\n\r\n    obj.options = {};\r\n\r\n    return obj;\r\n})();\r\n\r\n/**\r\n * (c) jSuites modal\r\n * https://github.com/paulhodel/jsuites\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Modal\r\n */\r\n\r\njSuites.modal = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        onopen: null,\r\n        onclose: null,\r\n        closed: false,\r\n        width: null,\r\n        height: null,\r\n        title: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Title\r\n    if (! obj.options.title && el.getAttribute('title')) {\r\n        obj.options.title = el.getAttribute('title');\r\n    }\r\n\r\n    var temp = document.createElement('div');\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        temp.appendChild(el.children[i]);\r\n    }\r\n\r\n    obj.content = document.createElement('div');\r\n    obj.content.className = 'jmodal_content';\r\n    obj.content.innerHTML = el.innerHTML;\r\n\r\n    for (var i = 0; i < temp.children.length; i++) {\r\n        obj.content.appendChild(temp.children[i]);\r\n    }\r\n\r\n    obj.container = document.createElement('div');\r\n    obj.container.className = 'jmodal';\r\n    obj.container.appendChild(obj.content);\r\n\r\n    if (obj.options.width) {\r\n        obj.container.style.width = obj.options.width;\r\n    }\r\n    if (obj.options.height) {\r\n        obj.container.style.height = obj.options.height;\r\n    }\r\n    if (obj.options.title) {\r\n        obj.container.setAttribute('title', obj.options.title);\r\n    } else {\r\n        obj.container.classList.add('no-title');\r\n    }\r\n    el.innerHTML = '';\r\n    el.style.display = 'none';\r\n    el.appendChild(obj.container);\r\n\r\n    // Backdrop\r\n    var backdrop = document.createElement('div');\r\n    backdrop.className = 'jmodal_backdrop';\r\n    el.appendChild(backdrop);\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n        // Fullscreen\r\n        const rect = obj.container.getBoundingClientRect();\r\n        if (jSuites.getWindowWidth() < rect.width) {\r\n            obj.container.style.top = '';\r\n            obj.container.style.left = '';\r\n            obj.container.classList.add('jmodal_fullscreen');\r\n            jSuites.slideBottom(obj.container, 1);\r\n        } else {\r\n            backdrop.style.display = 'block';\r\n        }\r\n        // Current\r\n        jSuites.modal.current = obj;\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el, obj);\r\n        }\r\n    }\r\n\r\n    obj.resetPosition = function() {\r\n        obj.container.style.top = '';\r\n        obj.container.style.left = '';\r\n    }\r\n\r\n    obj.isOpen = function() {\r\n        return el.style.display != 'none' ? true : false;\r\n    }\r\n\r\n    obj.close = function() {\r\n        el.style.display = 'none';\r\n        // Backdrop\r\n        backdrop.style.display = '';\r\n        // Current\r\n        jSuites.modal.current = null;\r\n        // Remove fullscreen class\r\n        obj.container.classList.remove('jmodal_fullscreen');\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el, obj);\r\n        }\r\n    }\r\n\r\n    if (! jSuites.modal.hasEvents) {\r\n        jSuites.modal.current = obj;\r\n\r\n        if ('ontouchstart' in document.documentElement === true) {\r\n            document.addEventListener(\"touchstart\", jSuites.modal.mouseDownControls);\r\n        } else {\r\n            document.addEventListener('mousedown', jSuites.modal.mouseDownControls);\r\n            document.addEventListener('mousemove', jSuites.modal.mouseMoveControls);\r\n            document.addEventListener('mouseup', jSuites.modal.mouseUpControls);\r\n        }\r\n\r\n        document.addEventListener('keydown', jSuites.modal.keyDownControls);\r\n\r\n        jSuites.modal.hasEvents = true;\r\n    }\r\n\r\n    if (obj.options.url) {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            success: function(data) {\r\n                obj.content.innerHTML = data;\r\n\r\n                if (! obj.options.closed) {\r\n                    obj.open();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        if (! obj.options.closed) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    // Keep object available from the node\r\n    el.modal = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.modal.current = null;\r\njSuites.modal.position = null;\r\n\r\njSuites.modal.keyDownControls = function(e) {\r\n    if (e.which == 27) {\r\n        if (jSuites.modal.current) {\r\n            jSuites.modal.current.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseUpControls = function(e) {\r\n    if (jSuites.modal.current) {\r\n        jSuites.modal.current.container.style.cursor = 'auto';\r\n    }\r\n    jSuites.modal.position = null;\r\n}\r\n\r\njSuites.modal.mouseMoveControls = function(e) {\r\n    if (jSuites.modal.current && jSuites.modal.position) {\r\n        if (e.which == 1 || e.which == 3) {\r\n            var position = jSuites.modal.position;\r\n            jSuites.modal.current.container.style.top = (position[1] + (e.clientY - position[3]) + (position[5] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.left = (position[0] + (e.clientX - position[2]) + (position[4] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.cursor = 'move';\r\n        } else {\r\n            jSuites.modal.current.container.style.cursor = 'auto';\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseDownControls = function(e) {\r\n    jSuites.modal.position = [];\r\n\r\n    if (e.target.classList.contains('jmodal')) {\r\n        setTimeout(function() {\r\n            // Get target info\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                setTimeout(function() {\r\n                    jSuites.modal.current.close();\r\n                }, 100);\r\n            } else {\r\n                if (e.target.getAttribute('title') && (y - rect.top) < 50) {\r\n                    if (document.selection) {\r\n                        document.selection.empty();\r\n                    } else if ( window.getSelection ) {\r\n                        window.getSelection().removeAllRanges();\r\n                    }\r\n\r\n                    jSuites.modal.position = [\r\n                        rect.left,\r\n                        rect.top,\r\n                        e.clientX,\r\n                        e.clientY,\r\n                        rect.width,\r\n                        rect.height,\r\n                    ];\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.fadeIn(notification);\r\n        } else {\r\n            jSuites.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.fadeOut(notification, function() {\r\n                notification.parentNode.removeChild(notification);\r\n            });\r\n        } else {\r\n            jSuites.slideTop(notification, 0, function() {\r\n                notification.parentNode.removeChild(notification);\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        number: 5,\r\n        value: 0,\r\n        tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jrating');\r\n\r\n    // Add elements\r\n    for (var i = 0; i < obj.options.number; i++) {\r\n        var div = document.createElement('div');\r\n        div.setAttribute('data-index', (i + 1))\r\n        div.setAttribute('title', obj.options.tooltip[i])\r\n        el.appendChild(div);\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    if (obj.options.value) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < obj.options.value) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            }\r\n        }\r\n    }\r\n\r\n    // Events\r\n    el.addEventListener(\"click\", function(e) {\r\n        var index = e.target.getAttribute('data-index');\r\n        if (index != undefined) {\r\n            if (index == obj.options.value) {\r\n                obj.setValue(0);\r\n            } else {\r\n                obj.setValue(index);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"mouseover\", function(e) {\r\n        var index = e.target.getAttribute('data-index');\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-over');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"mouseout\", function(e) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            el.children[i].classList.remove('jrating-over');\r\n        }\r\n    });\r\n\r\n    el.rating = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n/**\r\n * (c) Image slider\r\n * https://github.com/paulhodel/jtools\r\n *\r\n * @author: Paul Hodel <paul.hodel@gmail.com>\r\n * @description: Image Slider\r\n */\r\n\r\njSuites.slider = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n    obj.currentImage = null;\r\n\r\n    if (options) {\r\n        obj.options = options;\r\n    }\r\n\r\n    // Items\r\n    obj.options.items = [];\r\n\r\n    if (! el.classList.contains('jslider')) {\r\n        el.classList.add('jslider');\r\n\r\n        // Create container\r\n        var container = document.createElement('div');\r\n        container.className = 'jslider-container';\r\n\r\n        // Move children inside\r\n        if (el.children.length > 0) {\r\n            // Keep children items\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                obj.options.items.push(el.children[i]);\r\n            }\r\n        }\r\n        if (obj.options.items.length > 0) {\r\n            for (var i = 0; i < obj.options.items.length; i++) {\r\n                obj.options.items[i].classList.add('jfile');\r\n                var index = obj.options.items[i].src.lastIndexOf('/');\r\n                if (index < 0) {\r\n                    obj.options.items[i].setAttribute('data-name', obj.options.items[i].src);\r\n                } else {\r\n                    obj.options.items[i].setAttribute('data-name', obj.options.items[i].src.substr(index + 1));\r\n                }\r\n                var index = obj.options.items[i].src.lastIndexOf('/');\r\n\r\n                container.appendChild(obj.options.items[i]);\r\n            }\r\n        }\r\n        el.appendChild(container);\r\n        // Add close buttom\r\n        var close = document.createElement('div');\r\n        close.className = 'jslider-close';\r\n        close.innerHTML = '';\r\n        close.onclick =  function() {\r\n            obj.close();\r\n        }\r\n        el.appendChild(close);\r\n    } else {\r\n        var container = el.querySelector('slider-container');\r\n    }\r\n\r\n    obj.show = function(target) {\r\n        if (! target) {\r\n            var target = container.children[0];\r\n        }\r\n\r\n        if (! container.classList.contains('jslider-preview')) {\r\n            container.classList.add('jslider-preview');\r\n            close.style.display = 'block';\r\n        }\r\n\r\n        // Hide all images\r\n        for (var i = 0; i < container.children.length; i++) {\r\n            container.children[i].style.display = 'none';\r\n        }\r\n\r\n        // Show clicked only\r\n        target.style.display = 'block';\r\n\r\n        // Is there any previous\r\n        if (target.previousSibling) {\r\n            container.classList.add('jslider-left');\r\n        } else {\r\n            container.classList.remove('jslider-left');\r\n        }\r\n\r\n        // Is there any next\r\n        if (target.nextSibling) {\r\n            container.classList.add('jslider-right');\r\n        } else {\r\n            container.classList.remove('jslider-right');\r\n        }\r\n\r\n        obj.currentImage = target;\r\n    }\r\n\r\n    obj.open = function() {\r\n        obj.show();\r\n\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        container.classList.remove('jslider-preview');\r\n        container.classList.remove('jslider-left');\r\n        container.classList.remove('jslider-right');\r\n\r\n        for (var i = 0; i < container.children.length; i++) {\r\n            container.children[i].style.display = '';\r\n        }\r\n\r\n        close.style.display = '';\r\n\r\n        obj.currentImage = null;\r\n\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        container.innerHTML = '';\r\n    }\r\n\r\n    obj.addFile = function(v, ignoreEvents) {\r\n        var img = document.createElement('img');\r\n        img.setAttribute('data-lastmodified', v.lastmodified);\r\n        img.setAttribute('data-name', v.name);\r\n        img.setAttribute('data-size', v.size);\r\n        img.setAttribute('data-extension', v.extension);\r\n        img.setAttribute('data-cover', v.cover);\r\n        img.setAttribute('src', v.file);\r\n        img.className = 'jfile';\r\n        container.appendChild(img);\r\n        obj.options.items.push(img);\r\n\r\n        // Onchange\r\n        if (! ignoreEvents) {\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, v);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.addFiles = function(files) {\r\n        for (var i = 0; i < files.length; i++) {\r\n            obj.addFile(files[i]);\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        if (obj.currentImage.nextSibling) {\r\n            obj.show(obj.currentImage.nextSibling);\r\n        }\r\n    }\r\n    \r\n    obj.prev = function() {\r\n        if (obj.currentImage.previousSibling) {\r\n            obj.show(obj.currentImage.previousSibling);\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return jSuites.getFiles(container);\r\n    }\r\n\r\n    // Append data\r\n    if (obj.options.data && obj.options.data.length) {\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i]) {\r\n                obj.addFile(obj.options.data[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Allow insert\r\n    if (obj.options.allowAttachment) {\r\n        var attachmentInput = document.createElement('input');\r\n        attachmentInput.type = 'file';\r\n        attachmentInput.className = 'slider-attachment';\r\n        attachmentInput.setAttribute('accept', 'image/*');\r\n        attachmentInput.style.display = 'none';\r\n        attachmentInput.onchange = function() {\r\n            var reader = [];\r\n\r\n            for (var i = 0; i < this.files.length; i++) {\r\n                var type = this.files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    var extension = this.files[i].name;\r\n                    extension = extension.split('.');\r\n                    extension = extension[extension.length-1];\r\n\r\n                    var file = {\r\n                        size: this.files[i].size,\r\n                        name: this.files[i].name,\r\n                        extension: extension,\r\n                        cover: 0,\r\n                        lastmodified: this.files[i].lastModified,\r\n                    }\r\n\r\n                    reader[i] = new FileReader();\r\n                    reader[i].addEventListener(\"load\", function (e) {\r\n                        file.file = e.target.result;\r\n                        obj.addFile(file);\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(this.files[i]);\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            };\r\n        }\r\n\r\n        var attachmentIcon = document.createElement('i');\r\n        attachmentIcon.innerHTML = 'attachment';\r\n        attachmentIcon.className = 'jslider-attach material-icons';\r\n        attachmentIcon.onclick = function() {\r\n            jSuites.click(attachmentInput);\r\n        }\r\n\r\n        el.appendChild(attachmentInput);\r\n        el.appendChild(attachmentIcon);\r\n    }\r\n\r\n    // Push to refresh\r\n    var longTouchTimer = null;\r\n\r\n    var mouseDown = function(e) {\r\n        if (e.target.tagName == 'IMG') {\r\n            // Remove\r\n            var targetImage = e.target;\r\n            longTouchTimer = setTimeout(function() {\r\n                if (e.target.src.substr(0,4) == 'data') {\r\n                    e.target.remove();\r\n                } else {\r\n                    if (e.target.classList.contains('jremove')) {\r\n                        e.target.classList.remove('jremove');\r\n                    } else {\r\n                        e.target.classList.add('jremove');\r\n                    }\r\n                }\r\n\r\n                // Onchange\r\n                if (typeof(obj.options.onchange) == 'function') {\r\n                    obj.options.onchange(el, e.target);\r\n                }\r\n            }, 1000);\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        if (longTouchTimer) {\r\n            clearTimeout(longTouchTimer);\r\n        }\r\n\r\n        // Open slider\r\n        if (e.target.tagName == 'IMG') {\r\n            if (! e.target.classList.contains('jremove')) {\r\n                obj.show(e.target);\r\n            }\r\n        } else {\r\n            // Arrow controls\r\n            if (e.target.clientWidth - e.offsetX < 40) {\r\n                // Show next image\r\n                obj.next();\r\n            } else if (e.offsetX < 40) {\r\n                // Show previous image\r\n                obj.prev();\r\n            }\r\n        }\r\n    }\r\n\r\n    container.addEventListener('mousedown', mouseDown);\r\n    container.addEventListener('touchstart', mouseDown);\r\n    container.addEventListener('mouseup', mouseUp);\r\n    container.addEventListener('touchend', mouseUp);\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n\r\n    el.slider = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n/**\n * (c) jTools v1.0.1 - Element sorting\n * https://github.com/paulhodel/jtools\n *\n * @author: Paul Hodel <paul.hodel@gmail.com>\n * @description: Element drag and drop sorting\n */\n\njSuites.sorting = (function(el, options) {\n    el.classList.add('jsorting');\n\n    el.addEventListener('dragstart', function(e) {\n        e.target.classList.add('dragging');\n    });\n\n    el.addEventListener('dragover', function(e) {\n        e.preventDefault();\n\n        if (e.target.clientHeight / 2 > e.offsetY) {\n            e.path[0].style.borderTop = '1px dotted #ccc';\n            e.path[0].style.borderBottom = '';\n        } else {\n            e.path[0].style.borderTop = '';\n            e.path[0].style.borderBottom = '1px dotted #ccc';\n        }\n    });\n\n    el.addEventListener('dragleave', function(e) {\n        e.path[0].style.borderTop = '';\n        e.path[0].style.borderBottom = '';\n    });\n\n    el.addEventListener('dragend', function(e) {\n        e.path[1].querySelector('.dragging').classList.remove('dragging');\n    });\n\n    el.addEventListener('drop', function(e) {\n        var element = e.path[1].querySelector('.dragging');\n\n        if (e.target.clientHeight / 2 > e.offsetY) {\n            e.path[1].insertBefore(element, e.path[0]);\n        } else {\n            e.path[1].insertBefore(element, e.path[0].nextSibling);\n        }\n\n        e.path[0].style.borderTop = '';\n        e.path[0].style.borderBottom = '';\n    });\n\n    for (var i = 0; i < el.children.length; i++) {\n        el.children[i].setAttribute('draggable', 'true');\n    };\n\n    return el;\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: null,\r\n        allowCreate: false,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        animation: false,\r\n        create: null,\r\n        autoName: false,\r\n        prefixName: '',\r\n        hideHeaders: false,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    if (obj.options.animation == true) {\r\n        // Border\r\n        var border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        el.appendChild(border);\r\n\r\n        var setBorder = function(index) {\r\n            var rect = headers.children[index].getBoundingClientRect();\r\n            var rectContent = content.children[index].getBoundingClientRect();\r\n            border.style.width = rect.width + 'px';\r\n            border.style.left = (rect.left - rectContent.left) + 'px';\r\n            border.style.top = rect.height + 'px';\r\n        }\r\n    }\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        for (var i = 0; i < headers.children.length; i++) {\r\n            headers.children[i].classList.remove('jtabs-selected');\r\n            if (content.children[i]) {\r\n                content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        headers.children[index].classList.add('jtabs-selected');\r\n        if (content.children[index]) {\r\n            content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (headers.children.length < 2 && obj.options.allowCreate == false)) {\r\n            headers.style.display = 'none';\r\n        } else {\r\n            headers.style.display = '';\r\n            // Set border\r\n            if (obj.options.animation == true) {\r\n                setTimeout(function() {\r\n                    setBorder(index);\r\n                }, 100);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n    }\r\n\r\n    obj.create = function(title, div) {\r\n        if (typeof(obj.options.create) == 'function') {\r\n            obj.options.create();\r\n        } else {\r\n            obj.appendElement(title, div);\r\n\r\n            if (typeof(obj.options.oncreate) == 'function') {\r\n                obj.options.oncreate(el, div)\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, div) {\r\n        if (! title) {\r\n            if (obj.options.autoName == true) {\r\n                var title = obj.options.prefixName;\r\n                title += ' ' + (parseInt(content.children.length) + 1);\r\n            } else {\r\n                var title = prompt('Title?', '');\r\n            }\r\n        }\r\n\r\n        if (title) {\r\n            // Add headers\r\n            var header = document.createElement('div');\r\n            header.innerHTML = title;\r\n            if (obj.options.allowCreate) {\r\n                headers.insertBefore(header, headers.lastChild);\r\n            } else {\r\n                headers.appendChild(header);\r\n            }\r\n\r\n            // Add content\r\n            if (! div) {\r\n                var div = document.createElement('div');\r\n            }\r\n            content.appendChild(div);\r\n\r\n            // Open new tab\r\n            obj.selectIndex(header);\r\n        }\r\n    }\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Make sure the component is blank\r\n        el.innerHTML = '';\r\n        var headers = document.createElement('div');\r\n        var content = document.createElement('div');\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n        el.appendChild(headers);\r\n        el.appendChild(content);\r\n\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            var headersItem = document.createElement('div');\r\n            headers.appendChild(headersItem);\r\n            var contentItem = document.createElement('div');\r\n            content.appendChild(contentItem);\r\n\r\n            headersItem.innerHTML = obj.options.data[i].title;\r\n            if (obj.options.data[i].content) {\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            } else if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    success: function(result) {\r\n                        contentItem.innerHTML = result;\r\n                    },\r\n                    complete: function() {\r\n                        if (typeof(obj.options.onload) == 'function') {\r\n                            obj.options.onload(el);\r\n\r\n                            obj.open(0);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    } else if (el.children[0] && el.children[1]) {\r\n        // Create from existing elements\r\n        var headers = el.children[0];\r\n        var content = el.children[1];\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n    } else {\r\n        el.innerHTML = '';\r\n        var headers = document.createElement('div');\r\n        var content = document.createElement('div');\r\n        headers.classList.add('jtabs-headers');\r\n        content.classList.add('jtabs-content');\r\n        el.appendChild(headers);\r\n        el.appendChild(content);\r\n    }\r\n\r\n    // New\r\n    if (obj.options.allowCreate == true) {\r\n        var add = document.createElement('i');\r\n        add.className = 'jtabs-add';\r\n        headers.appendChild(add);\r\n    }\r\n\r\n    // Events\r\n    headers.addEventListener(\"click\", function(e) {\r\n        if (e.target.tagName == 'DIV') {\r\n            obj.selectIndex(e.target);\r\n        } else {\r\n            obj.create();\r\n        }\r\n    });\r\n\r\n    if (headers.children.length) {\r\n        obj.open(0);\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tags = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    /**\r\n     * @typedef {Object} defaults\r\n     * @property {(string|Array)} value - Initial value of the compontent\r\n     * @property {number} limit - Max number of tags inside the element\r\n     * @property {string} search - The URL for suggestions\r\n     * @property {string} placeholder - The default instruction text on the element\r\n     * @property {validation} validation - Method to validate the tags\r\n     * @property {requestCallback} onbeforechange - Method to be execute before any changes on the element\r\n     * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n     * @property {requestCallback} onfocus - Method to be execute when on focus\r\n     * @property {requestCallback} onblur - Method to be execute when on blur\r\n     * @property {requestCallback} onload - Method to be execute when the element is loaded\r\n     */\r\n    var defaults = {\r\n        value: null,\r\n        limit: null,\r\n        limitMessage: 'The limit of entries is: ',\r\n        search: null,\r\n        placeholder: null,\r\n        validation: null,\r\n        onbeforechange: null,\r\n        onchange: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        colors: null,\r\n    };\r\n\r\n    // Loop through though the default configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Search helpers\r\n    var searchContainer = null;\r\n    var searchTerms = null;\r\n    var searchIndex = 0;\r\n    var searchTimer = 0;\r\n\r\n    /**\r\n     * Add a new tag to the element\r\n     * @param {(?string|Array)} value - The value of the new element\r\n     */\r\n    obj.add = function(value, focus) {\r\n        if (typeof(obj.options.onbeforechange) == 'function') {\r\n            var v = obj.options.onbeforechange(el, obj, value);\r\n            if (v != null) {\r\n                value = v;\r\n            }\r\n        }\r\n\r\n        // Close search\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n        }\r\n\r\n        if (obj.options.limit > 0 && el.children.length >= obj.options.limit) {\r\n            alert(obj.options.limitMessage + ' ' + obj.options.limit);\r\n        } else {\r\n            // Get node\r\n            var node = getSelectionStart();\r\n\r\n            // Mix argument string or array\r\n            if (! value || typeof(value) == 'string') {\r\n                var div = document.createElement('div');\r\n                div.innerHTML = value ? value : '<br>';\r\n                if (node && node.parentNode.classList.contains('jtags')) {\r\n                    el.insertBefore(div, node.nextSibling);\r\n                } else {\r\n                    el.appendChild(div);\r\n                }\r\n            } else {\r\n                if (node && node.parentNode.classList.contains('jtags')) {\r\n                    if (! node.innerText.replace(\"\\n\", \"\")) {\r\n                        el.removeChild(node);\r\n                    }\r\n                }\r\n\r\n                for (var i = 0; i <= value.length; i++) {\r\n                    if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                        var div = document.createElement('div');\r\n                        div.innerHTML = value[i] ? value[i] : '<br>';\r\n                        el.appendChild(div);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Place caret\r\n            if (focus) {\r\n                setTimeout(function() {\r\n                    caret(div);\r\n                }, 0);\r\n            }\r\n\r\n            // Filter\r\n            filter();\r\n\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj, value ? value : '');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get all tags in the element\r\n     * @return {Array} data - All tags as an array\r\n     */\r\n    obj.getData = function() {\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            var value = obj.getValue(i);\r\n            if (value) {\r\n                var id = el.children[i].getAttribute('data-id');\r\n                if (! id) {\r\n                    id = value;\r\n                }\r\n                data.push({ id: id, value: value });\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Get the value of one tag. Null for all tags\r\n     * @param {?number} index - Tag index number. Null for all tags.\r\n     * @return {string} value - All tags separated by comma\r\n     */\r\n    obj.getValue = function(index) {\r\n        var value = null;\r\n\r\n        if (index != null) {\r\n            // Get one individual value\r\n            value = el.children[index].innerText.replace(\"\\n\", \"\");\r\n        } else {\r\n            // Get all\r\n            var data = [];\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                value = el.children[i].innerText.replace(\"\\n\", \"\");\r\n                if (value) {\r\n                    data.push(obj.getValue(i));\r\n                }\r\n            }\r\n            value = data.join(',');\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the element based on a string separeted by (,|;|\\r\\n)\r\n     * @param {string} value - A string with the tags\r\n     */\r\n    obj.setValue = function(text) {\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            // Tags\r\n            var data = extractTags(text);\r\n            // Add tags to the element\r\n            obj.add(data);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        el.innerHTML = '<div><br></div>';\r\n    }\r\n\r\n    /**\r\n     * Verify if all tags in the element are valid\r\n     * @return {boolean}\r\n     */\r\n    obj.isValid = function() {\r\n        var test = 0;\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (el.children[i].classList.contains('jtags_error')) {\r\n                test++;\r\n            }\r\n        }\r\n        return test == 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Add one element from the suggestions to the element\r\n     * @param {object} item - Node element in the suggestions container\r\n     */ \r\n    obj.selectIndex = function(item) {\r\n        // Reset terms\r\n        searchTerms = '';\r\n        var node = getSelectionStart();\r\n        // Append text to the caret\r\n        node.innerText = item.children[1].innerText;\r\n        // Set node id\r\n        if (item.children[1].getAttribute('data-id')) {\r\n            node.setAttribute('data-id', item.children[1].getAttribute('data-id'));\r\n        }\r\n        // Close container\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n            searchContainer.innerHTML = '';\r\n        }\r\n        // Remove any error\r\n        node.classList.remove('jtags_error');\r\n        // Add new item\r\n        obj.add();\r\n    }\r\n\r\n    /**\r\n     * Search for suggestions\r\n     * @param {object} node - Target node for any suggestions\r\n     */\r\n    obj.search = function(node) {\r\n        // Create and append search container to the DOM\r\n        if (! searchContainer) {\r\n            var div = document.createElement('div');\r\n            div.style.position = 'relative';\r\n            el.parentNode.insertBefore(div, el.nextSibling);\r\n\r\n            // Create container\r\n            searchContainer = document.createElement('div');\r\n            searchContainer.classList.add('jtags_search');\r\n            div.appendChild(searchContainer);\r\n        }\r\n\r\n        // Search for\r\n        var terms = node.anchorNode.nodeValue;\r\n\r\n        // Search\r\n        if (node.anchorNode.nodeValue && terms != searchTerms) {\r\n            // Terms\r\n            searchTerms = node.anchorNode.nodeValue;\r\n            // Reset index\r\n            searchIndex = 0;\r\n            // Get remove results\r\n            jSuites.ajax({\r\n                url: obj.options.search + searchTerms,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    // Reset container\r\n                    searchContainer.innerHTML = '';\r\n\r\n                    // Print results\r\n                    if (! data.length) {\r\n                        // Show container\r\n                        searchContainer.style.display = '';\r\n                    } else {\r\n                        // Show container\r\n                        searchContainer.style.display = 'block';\r\n\r\n                        // Show items\r\n                        var len = data.length < 11 ? data.length : 10;\r\n                        for (var i = 0; i < len; i++) {\r\n                            var div = document.createElement('div');\r\n                            if (i == 0) {\r\n                                div.classList.add('selected');\r\n                            }\r\n                            var img = document.createElement('img');\r\n                            if (data[i].image) {\r\n                                img.src = data[i].image;\r\n                            } else {\r\n                                img.style.display = 'none';\r\n                            }\r\n                            div.appendChild(img);\r\n\r\n                            var item = document.createElement('div');\r\n                            item.setAttribute('data-id', data[i].id);\r\n                            item.innerHTML = data[i].name;\r\n                            div.onclick = function() {\r\n                                // Add item\r\n                                obj.selectIndex(this);\r\n                            }\r\n                            div.appendChild(item);\r\n                            // Append item to the container\r\n                            searchContainer.appendChild(div);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    // Destroy tags element\r\n    obj.destroy = function() {\r\n        // Bind events\r\n        el.removeEventListener('mouseup', tagsMouseUp);\r\n        el.removeEventListener('keydown', tagsKeyDown);\r\n        el.removeEventListener('keyup', tagsKeyUp);\r\n        el.removeEventListener('paste', tagsPaste);\r\n        el.removeEventListener('focus', tagsFocus);\r\n        el.removeEventListener('blur', tagsBlur);\r\n        // Remove element\r\n        el.parentNode.removeChild(el);\r\n    }\r\n\r\n    var getRandomColor = function(index) {\r\n        var rand = function(min, max) {\r\n            return min + Math.random() * (max - min);\r\n        }\r\n        return 'hsl(' + rand(1, 360) + ',' + rand(40, 70) + '%,' + rand(65, 72) + '%)';\r\n    }\r\n\r\n    /**\r\n     * Filter tags\r\n     */\r\n    var filter = function() {\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.children[i].classList.remove('jtags_label');\r\n            } else {\r\n                el.children[i].classList.add('jtags_label');\r\n\r\n                // Validation in place\r\n                if (typeof(obj.options.validation) == 'function') {\r\n                    if (obj.getValue(i)) {\r\n                        if (! obj.options.validation(el.children[i], el.children[i].innerText, el.children[i].getAttribute('data-id'))) {\r\n                            el.children[i].classList.add('jtags_error');\r\n                        } else {\r\n                            el.children[i].classList.remove('jtags_error');\r\n                        }\r\n                    } else {\r\n                        el.children[i].classList.remove('jtags_error');\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Place caret in the element node\r\n     */\r\n    var caret = function(e) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        range.setStart(e, e.innerText.length);\r\n        range.collapse(true);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    /**\r\n     * Selection\r\n     */\r\n    var getSelectionStart = function() {\r\n        var node = document.getSelection().anchorNode;\r\n        if (node) {\r\n            return (node.nodeType == 3 ? node.parentNode : node);\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract tags from a string\r\n     * @param {string} text - Raw string\r\n     * @return {Array} data - Array with extracted tags\r\n     */\r\n    var extractTags = function(text) {\r\n        /** @type {Array} */\r\n        var data = [];\r\n\r\n        /** @type {string} */\r\n        var word = '';\r\n\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (text[i] == ',' || text[i] == ';' || text[i] == '\\r\\n') {\r\n                    if (word) {\r\n                        data.push(word);\r\n                        word = '';\r\n                    }\r\n                } else {\r\n                    word += text[i];\r\n                }\r\n            }\r\n\r\n            if (word) {\r\n                data.push(word);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /** @type {number} */\r\n    var anchorOffset = 0;\r\n\r\n    /**\r\n     * Processing event keydown on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyDown = function(e) {\r\n        // Anchoroffset\r\n        anchorOffset = window.getSelection().anchorOffset;\r\n\r\n        // Verify content\r\n        if (! el.children.length) {\r\n            var div = document.createElement('div');\r\n            div.innerHTML = '<br>';\r\n            el.appendChild(div);\r\n        }\r\n        // Comma\r\n        if (e.which == 9 || e.which == 186 || e.which == 188) {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1) {\r\n                if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                    obj.add('', true);\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 13) {\r\n            // Enter\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                obj.selectIndex(searchContainer.children[searchIndex]);\r\n            } else {\r\n                var n = window.getSelection().anchorOffset;\r\n                if (n > 1) {\r\n                    if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                        obj.add('', true);\r\n                    }\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 38) {\r\n            // Up\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                searchContainer.children[searchIndex].classList.remove('selected');\r\n                if (searchIndex > 0) {\r\n                    searchIndex--;\r\n                }\r\n                searchContainer.children[searchIndex].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 40) {\r\n            // Down\r\n            if (searchContainer && searchContainer.style.display != '') {\r\n                searchContainer.children[searchIndex].classList.remove('selected');\r\n                if (searchIndex < 9) {\r\n                    searchIndex++;\r\n                }\r\n                searchContainer.children[searchIndex].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event keyup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyUp = function(e) {\r\n        if (e.which == 39) {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1 && n == anchorOffset) {\r\n                obj.add();\r\n            }\r\n        } else if (e.which == 13 || e.which == 38 || e.which == 40) {\r\n            e.preventDefault();\r\n        } else {\r\n            if (searchTimer) {\r\n                clearTimeout(searchTimer);\r\n            }\r\n\r\n            searchTimer = setTimeout(function() {\r\n                // Current node\r\n                var node = window.getSelection();\r\n                // Search\r\n                if (obj.options.search) {\r\n                    obj.search(node);\r\n                }\r\n                searchTimer = null;\r\n            }, 300);\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Processing event paste on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsPaste =  function(e) {\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n        } else if (window.clipboardData) {\r\n            var html = window.clipboardData.getData('Html');\r\n            var text = window.clipboardData.getData('Text');\r\n        }\r\n\r\n        obj.setValue(text);\r\n        e.preventDefault();\r\n    }\r\n\r\n    /**\r\n     * Processing event mouseup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsMouseUp = function(e) {\r\n        if (e.target.parentNode && e.target.parentNode.classList.contains('jtags')) {\r\n            if (e.target.classList.contains('jtags_label') || e.target.classList.contains('jtags_error')) {\r\n                const rect = e.target.getBoundingClientRect();\r\n                if (rect.width - (e.clientX - rect.left) < 16) {\r\n                    el.removeChild(e.target);\r\n                    el.focus();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (searchContainer) {\r\n            searchContainer.style.display = '';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event focus on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsFocus = function(e) {\r\n        if (! el.children.length || obj.getValue(el.children.length - 1)) {\r\n            if (! obj.options.limit || el.children.length < obj.options.limit) {\r\n                var div = document.createElement('div');\r\n                div.innerHTML = '<br>';\r\n                el.appendChild(div);\r\n            }\r\n        }\r\n\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, obj.getValue());\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event blur on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsBlur = function(e) {\r\n        if (searchContainer) {\r\n            setTimeout(function() {\r\n                searchContainer.style.display = '';\r\n            }, 200);\r\n        }\r\n\r\n        for (var i = 0; i < el.children.length - 1; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.removeChild(el.children[i]);\r\n            }\r\n        }\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, obj.getValue());\r\n        }\r\n    }\r\n\r\n    // Bind events\r\n    el.addEventListener('mouseup', tagsMouseUp);\r\n    el.addEventListener('keydown', tagsKeyDown);\r\n    el.addEventListener('keyup', tagsKeyUp);\r\n    el.addEventListener('paste', tagsPaste);\r\n    el.addEventListener('focus', tagsFocus);\r\n    el.addEventListener('blur', tagsBlur);\r\n\r\n    // Prepare container\r\n    el.classList.add('jtags');\r\n    el.setAttribute('contenteditable', true);\r\n    el.setAttribute('spellcheck', false);\r\n\r\n    if (obj.options.placeholder) {\r\n        el.placeholder = obj.options.placeholder;\r\n    }\r\n\r\n    // Make sure element is empty\r\n    if (obj.options.value) {\r\n        obj.setValue(obj.options.value);\r\n    } else {\r\n        el.innerHTML = '<div><br></div>';\r\n    }\r\n\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj);\r\n    }\r\n\r\n    el.tags = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tracker = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        message: 'Are you sure? There are unsaved information in your form',\r\n        ignore: false,\r\n        currentHash: null,\r\n        submitButton:null,\r\n        onload: null,\r\n        onbeforesave: null,\r\n        onsave: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    obj.setUrl = function(url) {\r\n        obj.options.url = url;\r\n    }\r\n\r\n    obj.load = function() {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                var elements = el.querySelectorAll(\"input, select, textarea\");\r\n \r\n                for (var i = 0; i < elements.length; i++) {\r\n                    var name = elements[i].getAttribute('name');\r\n                    if (data[name]) {\r\n                        elements[i].value = data[name];\r\n                    }\r\n                }\r\n\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    obj.save = function() {\r\n        var test = obj.validate();\r\n\r\n        if (test) {\r\n            jSuites.alert(test);\r\n        } else {\r\n            var data = obj.getElements(true);\r\n\r\n            if (typeof(obj.options.onbeforesave) == 'function') {\r\n                var data = obj.options.onbeforesave(el, data);\r\n\r\n                if (data === false) {\r\n                    console.log('Onbeforesave returned false');\r\n                    return; \r\n                }\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: data,\r\n                success: function(result) {\r\n                    jSuites.alert(result.message);\r\n\r\n                    if (typeof(obj.options.onsave) == 'function') {\r\n                        var data = obj.options.onsave(el, result);\r\n                    }\r\n\r\n                    obj.reset();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.validateElement = function(element) {\r\n        var emailChecker = function(data) {\r\n            var pattern = new RegExp(/^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/);\r\n            return pattern.test(data) ? true : false; \r\n        }\r\n\r\n        var passwordChecker = function(data) {\r\n            return (data.length > 5) ? true : false;\r\n        }\r\n\r\n        var addError = function(element) {\r\n            // Add error in the element\r\n            element.classList.add('error');\r\n            // Submit button\r\n            if (obj.options.submitButton) {\r\n                obj.options.submitButton.setAttribute('disabled', true);\r\n            }\r\n            // Return error message\r\n            return element.getAttribute('data-error') || 'There is an error in the form';\r\n        }\r\n\r\n        var delError = function(element) {\r\n            var error = false;\r\n            // Remove class from this element\r\n            element.classList.remove('error');\r\n            // Get elements in the form\r\n            var elements = el.querySelectorAll(\"input, select, textarea\");\r\n            // Run all elements \r\n            for (var i = 0; i < elements.length; i++) {\r\n                if (elements[i].getAttribute('data-validation')) {\r\n                    if (elements[i].classList.contains('error')) {\r\n                        error = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (obj.options.submitButton) {\r\n                if (error) {\r\n                    obj.options.submitButton.setAttribute('disabled', true);\r\n                } else {\r\n                    obj.options.submitButton.removeAttribute('disabled');\r\n                }\r\n            }\r\n        }\r\n\r\n        // Blank\r\n        var test = '';\r\n        if (! element.value) {\r\n            test = addError(element);\r\n        } else if (element.getAttribute('data-email') && ! emailChecker(element.value)) {\r\n            test = addError(element);\r\n        } else if (element.getAttribute('data-password') && ! emailChecker(element.value)) {\r\n            test = addError(element);\r\n        } else {\r\n            if (element.classList.contains('error')) {\r\n                delError(element);\r\n            }\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    // Run form validation\r\n    obj.validate = function() {\r\n        var test = '';\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                if (test) {\r\n                    test += \"<br>\\r\\n\";\r\n                }\r\n                test += obj.validateElement(elements[i]);\r\n            }\r\n        }\r\n        return test;\r\n    }\r\n\r\n    // Check the form\r\n    obj.getError = function() {\r\n        // Validation\r\n        return obj.validation() ? true : false;\r\n    }\r\n\r\n    // Return the form hash\r\n    obj.setHash = function() {\r\n        return obj.getHash(obj.getElements());\r\n    }\r\n\r\n    // Get the form hash\r\n    obj.getHash = function(str) {\r\n        var hash = 0, i, chr;\r\n\r\n        if (str.length === 0) {\r\n            return hash;\r\n        } else {\r\n            for (i = 0; i < str.length; i++) {\r\n              chr = str.charCodeAt(i);\r\n              hash = ((hash << 5) - hash) + chr;\r\n              hash |= 0;\r\n            }\r\n        }\r\n\r\n        return hash;\r\n    }\r\n\r\n    // Is there any change in the form since start tracking?\r\n    obj.isChanged = function() {\r\n        var hash = obj.setHash();\r\n        return (obj.options.currentHash != hash);\r\n    }\r\n\r\n    // Restart tracking\r\n    obj.resetTracker = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    obj.reset = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    // Ignore flag\r\n    obj.setIgnore = function(ignoreFlag) {\r\n        obj.options.ignore = ignoreFlag ? true : false;\r\n    }\r\n\r\n    // Get form elements\r\n    obj.getElements = function(asArray) {\r\n        var data = {};\r\n        var elements = el.querySelectorAll(\"input, select, textarea\");\r\n\r\n        for (var i = 0; i < elements.length; i++) {\r\n            var element = elements[i];\r\n            var name = element.name;\r\n            var value = element.value;\r\n\r\n            if (name) {\r\n                data[name] = value;\r\n            }\r\n        }\r\n\r\n        return asArray == true ? data : JSON.stringify(data);\r\n    }\r\n\r\n    // Start tracking in one second\r\n    setTimeout(function() {\r\n        obj.options.currentHash = obj.setHash();\r\n    }, 1000);\r\n\r\n    // Alert\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        if (obj.isChanged() && obj.options.ignore == false) {\r\n            var confirmationMessage =  obj.options.message? obj.options.message : \"\\o/\";\r\n\r\n            if (confirmationMessage) {\r\n                if (typeof e == 'undefined') {\r\n                    e = window.event;\r\n                }\r\n\r\n                if (e) {\r\n                    e.returnValue = confirmationMessage;\r\n                }\r\n\r\n                return confirmationMessage;\r\n            } else {\r\n                return void(0);\r\n            }\r\n        }\r\n    });\r\n\r\n    // Validations\r\n    el.addEventListener(\"keyup\", function(e) {\r\n        if (e.target.getAttribute('data-validation')) {\r\n            obj.validateElement(e.target);\r\n        }\r\n    });\r\n\r\n    el.tracker = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","'use strict';\nvar regexpFlags = require('./regexp-flags');\nvar stickyHelpers = require('./regexp-sticky-helpers');\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y || stickyHelpers.BROKEN_CARET;\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n    var sticky = UNSUPPORTED_Y && re.sticky;\n    var flags = regexpFlags.call(re);\n    var source = re.source;\n    var charsAdded = 0;\n    var strCopy = str;\n\n    if (sticky) {\n      flags = flags.replace('y', '');\n      if (flags.indexOf('g') === -1) {\n        flags += 'g';\n      }\n\n      strCopy = String(str).slice(re.lastIndex);\n      // Support anchored sticky behavior.\n      if (re.lastIndex > 0 && (!re.multiline || re.multiline && str[re.lastIndex - 1] !== '\\n')) {\n        source = '(?: ' + source + ')';\n        strCopy = ' ' + strCopy;\n        charsAdded++;\n      }\n      // ^(? + rx + ) is needed, in combination with some str slicing, to\n      // simulate the 'y' flag.\n      reCopy = new RegExp('^(?:' + source + ')', flags);\n    }\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + source + '$(?!\\\\s)', flags);\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = nativeExec.call(sticky ? reCopy : re, strCopy);\n\n    if (sticky) {\n      if (match) {\n        match.input = match.input.slice(charsAdded);\n        match[0] = match[0].slice(charsAdded);\n        match.index = re.lastIndex;\n        re.lastIndex += match[0].length;\n      } else re.lastIndex = 0;\n    } else if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","'use strict';\n\nvar fails = require('./fails');\n\n// babel-minify transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError,\n// so we use an intermediate function.\nfunction RE(s, f) {\n  return RegExp(s, f);\n}\n\nexports.UNSUPPORTED_Y = fails(function () {\n  // babel-minify transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError\n  var re = RE('a', 'y');\n  re.lastIndex = 2;\n  return re.exec('abcd') != null;\n});\n\nexports.BROKEN_CARET = fails(function () {\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687\n  var re = RE('^r', 'gy');\n  re.lastIndex = 2;\n  return re.exec('str') != null;\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar exec = require('../internals/regexp-exec');\n\n$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {\n  exec: exec\n});\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.github.io/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"navbar\"}},[_c('nav',{staticClass:\"navbar expand-md default-nav bg-warning\"},[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"brand\"},[_c('router-link',{attrs:{\"to\":\"/\"}},[_c('a',[_vm._v(\"Excel generator\")])])],1),_c('div',{staticClass:\"menu-box\",attrs:{\"id\":\"mainNav2\"}},[_c('ul',{staticClass:\"menu mx-auto\"},[_c('router-link',{attrs:{\"to\":\"/verHojas\"}},[_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\"},[_vm._v(\"Ver Hojas excel\")])])]),_c('router-link',{attrs:{\"to\":\"/nueva\"}},[_c('li',{staticClass:\"nav-item\"},[_c('a',{staticClass:\"nav-link\"},[_vm._v(\"Crear nueva hoja excel\")])])])],1)])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\n  <div id=\"navbar\">\n\n\n              <nav class=\"navbar expand-md default-nav bg-warning\">\n                <div class=\"container\">\n\n                  <div class=\"brand\">\n                    <router-link to=\"/\">\n                      <a>Excel generator</a>\n                    </router-link>\n                  </div>\n\n                  <div class=\"menu-box\" id=\"mainNav2\">\n\n                    <ul class=\"menu mx-auto\">\n                      <router-link to=\"/verHojas\">\n                        <li class=\"nav-item\"><a class=\"nav-link\">Ver Hojas excel</a></li>\n                      </router-link>\n                      <router-link to=\"/nueva\">\n                        <li class=\"nav-item\"><a class=\"nav-link\">Crear nueva hoja excel</a></li>\n                      </router-link>\n                    </ul>\n\n                  </div>\n\n                </div>\n              </nav>\n\n    \n  </div>\n\n</template>\n\n<script>\n\n\n  \nexport default {\n  name: 'Navbar',\n\tdata(){\n    return{\n\n    }\n\t},\n\tmounted: function () {\n\n\n\n\t},\n\tmethods: {\n\n\t},\n\n\n}\n</script>\n\n\n<style>\n\n.brand{\n  margin-top: 10px;\n  margin-bottom: 12px;\n}\n\n\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Navbar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Navbar.vue?vue&type=template&id=c5472486&\"\nimport script from \"./Navbar.vue?vue&type=script&lang=js&\"\nexport * from \"./Navbar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Navbar.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\n// TODO: Remove from `core-js@4` since it's moved to entry points\nrequire('../modules/es.regexp.exec');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar regexpExec = require('../internals/regexp-exec');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar SPECIES = wellKnownSymbol('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\nvar REPLACE = wellKnownSymbol('replace');\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\n// Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n// Weex JS has frozen built-in prototypes, so use try / catch wrapper\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';\n});\n\nmodule.exports = function (KEY, length, exec, sham) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n\n    if (KEY === 'split') {\n      // We can't use real regex here since it causes deoptimization\n      // and serious performance degradation in V8\n      // https://github.com/zloirock/core-js/issues/306\n      re = {};\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n      re.flags = '';\n      re[SYMBOL] = /./[SYMBOL];\n    }\n\n    re.exec = function () { execCalled = true; return null; };\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !(\n      REPLACE_SUPPORTS_NAMED_GROUPS &&\n      REPLACE_KEEPS_$0 &&\n      !REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE\n    )) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      if (regexp.exec === regexpExec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n        }\n        return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n      }\n      return { done: false };\n    }, {\n      REPLACE_KEEPS_$0: REPLACE_KEEPS_$0,\n      REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE: REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE\n    });\n    var stringMethod = methods[0];\n    var regexMethod = methods[1];\n\n    redefine(String.prototype, KEY, stringMethod);\n    redefine(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return regexMethod.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return regexMethod.call(string, this); }\n    );\n  }\n\n  if (sham) createNonEnumerableProperty(RegExp.prototype[SYMBOL], 'sham', true);\n};\n"],"sourceRoot":""}